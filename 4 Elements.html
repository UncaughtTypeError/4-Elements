<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>4 Elements</title>
        <script src="https://code.jquery.com/jquery-3.1.0.js"></script>
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    </head>
    <body>
        <div class="wrapper">
            <div class="alert-component"><!-- epheremal altert and notice display --></div>
            <div class="overview-component">
                <div class="overview-deck-details"></div>
                <div class="overview-win-indicator">
                    <div class="overview-player-win">0</div>
                    <div class="npc-player-win">0</div>
                </div>
                <div class="overview-phase-indicator">
                    <div class="overview-current-phase overview-display-phase"></div>
                </div>
            </div>
            <div class="turnCard-component">
                <div class="turnCard-bg-lines"><div><div></div></div></div>
                <div class="turnCard-match"></div>
                <div class="turnCard-selection"></div>
            </div>
            <div class="phaseGuide-component">
                <div class="phaseGuide inactive-phaseGuide">
                    <div class="phaseGuide-current-phase"></div>
                    <div class="phaseGuide-instruction"></div>
                </div>
            </div>
            <div class="field-component">
                <div class="field" data-field="ai-field">
                    <div class="preview-pane-component">
                        <div class="preview-pane-aperture">
                            <div class="preview-pane-dismiss"><i class="fas fa-times"></i></div>
                            <div class="preview-pane-card"></div>
                        </div>
                        <div class="preview-pane-aperture">
                            <div class="preview-pane-stats"></div>
                        </div>
                    </div>
                    <div class="deck-component">
                        <div class="victory-indicator">
                            <div class="victory-aperture"></div>
                            <div class="victory-aperture"></div>
                            <div class="victory-aperture"></div>
                        </div>
                        <div class="player-hand">
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                        </div>
                        <div class="dorment">
                            <div class="turn-indicator"></div>
                            <div class="stack-counter">
                                <span></span>
                                <div class="stack-circuit"></div>
                            </div>
                            <div class="standby-pile"></div>
                            <div class="dead-pile"></div>
                        </div>
                    </div>
                </div>
                <div class="battle-field-component">
                    <div class="battle-field-background">
                        <div class="background-panel-left background-panel">
                            <div class="panel-corner"></div>
                            <div class="panel-corner"></div>
                        </div>
                        <div class="background-panel-right background-panel">
                            <div class="panel-corner"></div>
                            <div class="panel-corner"></div>
                        </div>
                    </div>
                    <div class="resource-field-component" data-resource-field="player-field">
                        <div class="resource resource-pyro">
                            <i class="fas fa-burn"></i>
                            <div class="resource-aperture"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-added-value"></div>
                        </div>
                        <div class="resource resource-terra">
                            <i class="fas fa-leaf"></i>
                            <div class="resource-aperture"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-added-value"></div>
                        </div>
                        <div class="resource resource-aero">
                            <i class="fas fa-cloud"></i>
                            <div class="resource-aperture"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-added-value"></div>
                        </div>
                        <div class="resource resource-hydro">
                            <i class="fas fa-tint"></i>
                            <div class="resource-aperture"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-added-value"></div>
                        </div>
                    </div>
                    <div class="battle-field" data-battle-field="player-field">
                        <div class="hitpoint-component">
                            <div class="hitpoint-percentile"></div>
                            <div class="hitpoint-indicator">
                                <div class="hitpoint-circuit"></div>
                                <div class="hitpoint-meter safe">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                                <div class="hitpoint-meter caution">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                                <div class="hitpoint-meter risk">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                            </div>
                        </div>
                        <div class="in-play"></div>
                        <div class="support-card-component">
                            <div class="support-card-circuit"></div>
                        </div>
                    </div>
                    <div class="battle-field" data-battle-field="ai-field">
                        <div class="support-card-component">
                            <div class="support-card-circuit"></div>
                        </div>
                        <div class="in-play"></div>
                        <div class="hitpoint-component">
                            <div class="hitpoint-percentile"></div>
                            <div class="hitpoint-indicator">
                                <div class="hitpoint-circuit"></div>
                                <div class="hitpoint-meter safe">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                                <div class="hitpoint-meter caution">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                                <div class="hitpoint-meter risk">
                                    <div></div>
                                    <div></div>
                                    <div></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="resource-field-component" data-resource-field="ai-field">
                        <div class="resource resource-hydro">
                            <div class="resource-added-value"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-aperture"></div>
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="resource resource-aero">
                            <div class="resource-added-value"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-aperture"></div>
                            <i class="fas fa-cloud"></i>
                        </div>
                        <div class="resource resource-terra">
                            <div class="resource-added-value"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-aperture"></div>
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="resource resource-pyro">
                            <div class="resource-added-value"></div>
                            <div class="resource-counter" data-pool-wealth="0">0</div>
                            <div class="resource-aperture"></div>
                            <i class="fas fa-burn"></i>
                        </div>
                    </div>
                </div>
                <div class="field" data-field="player-field">
                    <div class="deck-component">
                        <div class="victory-indicator">
                            <div class="victory-aperture"></div>
                            <div class="victory-aperture"></div>
                            <div class="victory-aperture"></div>
                        </div>
                        <div class="player-hand">
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                            <div class="card-aperture open"></div>
                        </div>
                        <div class="dorment">
                            <div class="dead-pile"></div>
                            <div class="standby-pile"></div>
                            <div class="stack-counter">
                                <span></span>
                                <div class="stack-circuit"></div>
                            </div>
                            <div class="turn-indicator"></div>
                        </div>
                    </div>
                    <div class="preview-pane-component">
                        <div class="preview-pane-aperture">
                            <div class="preview-pane-dismiss"><i class="fas fa-times"></i></div>
                            <div class="preview-pane-card"></div>
                        </div>
                        <div class="preview-pane-aperture">
                            <div class="preview-pane-stats"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            /*
            **
            ** Phases & Notifications
            **
            */

            // Phases
            var currentPhase                = 'turnSelectionPhase', // define the current phase for reference sake
            	formerPhase,										// store previous phase for reference sake
                turnSelectionPhase          = true,                 // determine turn order
                drawPhase                   = false,                // draw cards for hand
                casterSelectionPhase        = false,                // select caster card and place into active play
                resourcePoolingPhase        = false,                // add to resource pool to accrue spending points for support cards and levelling
                baseSwitchingPhase          = false,                // switch elemental base type if possible (pyro, hydro, terra, aero)
                supportSelectionPhase       = false,                // select support card and place into active play
                supportLevellingPhase		= false,                // caster support levelling if possible (proficient, adept, elite, peerless)
                levellingPhase              = false,                // caster levelling if possible (proficient, adept, elite, peerless)
                handConfirmationPhase       = false,                // prompt player to confirm or discard drawn hand
                casterConfirmationPhase     = false,                // prompt player to confirm or reject caster selection
                resourceConfirmationPhase   = false,                // prompt player to confirm or reject resource selection
                supportConfirmationPhase   	= false,                // prompt player to confirm or reject support selection
                handBrowsingPhase           = false,                // allow player to browse hand
                previewSelectionPhase       = false,                // allow player to preview card
            // Notices
                invalidDrawNotice           = false,                // notify player of invalid draw (where no caster type cards are found)
                phaseGuideNotice            = false,                // notify player of current phase and provide instruction
            // Other
                activeDialogueBox           = false;                // indicate an active dialogue box

            /*
            **
            ** Globals
            **
            */
            var KeyDismissal,
                iterationDelay,
                iterationCount,
                remainingIterations;

            /*
            **
            ** Constants
            **
            */
                const   cardBack    =   `<div class="cardBack">
                                            <div class="card-motivs">
                                                <i class="fas fa-burn"></i>
                                                <i class="fas fa-leaf"></i>
                                                <i class="fas fa-cloud"></i>
                                                <i class="fas fa-tint"></i>
                                            </div>
                                            <div class="card-logo">Elemental</div>
                                        </div>`,
                        dialogueBox =   `<div class="dialogueBox inactive-dialogueBox" style="z-index: 0;">
                                            <div class="dialogueBox-component">
                                                <div class="dialogueBox-head">
                                                    <div class="dialogueBox-maximize dialogueBox-control"><i class="far fa-window-maximize"></i></div>
                                                    <div class="dialogueBox-minimize dialogueBox-control"><i class="far fa-window-minimize"></i></div>
                                                    <div class="dialogueBox-dismiss dialogueBox-control"><i class="fas fa-times"></i></div>
                                                </div>
                                                <div class="dialogueBox-body"></div>
                                                <div class="dialogueBox-backgraound">
                                                    <div class="card-motivs">
                                                        <i class="fas fa-burn"></i>
                                                        <i class="fas fa-leaf"></i>
                                                        <i class="fas fa-cloud"></i>
                                                        <i class="fas fa-tint"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dialogueBox-backdrop"></div>
                                        </div>`;

            /*
            **
            ** Phase Guide & Indication
            **
            */
            var guideInstruction;

            // Phase guide update
            function updatePhaseGuide(guideInstruction,phaseInstance) {

                if(!phaseGuideNotice) {

                    // Separate string by every capital letter
                    let currentPhaseIndicator = currentPhase.split(/(?=[A-Z])/);

                    // Set current phase
                    jQuery('.phaseGuide-current-phase').html(currentPhaseIndicator.join(' '));

                    // Set phase instruction
                    jQuery('.phaseGuide-instruction').append(guideInstruction);

                    jQuery('.phaseGuide').removeClass('inactive-phaseGuide').addClass('active-phaseGuide');

                    phaseGuideNotice = true;

                } else if(phaseGuideNotice) { // if the phase guide already exists, clear it, dismiss it, delay it, then call it again

                    phaseGuideNotice = false;

                    jQuery('.phaseGuide').removeClass('active-phaseGuide').addClass('inactive-phaseGuide');
                    jQuery('.phaseGuide-instruction').empty();

                    setTimeout(function(){

                        if(phaseInstance == currentPhase) { // check if current phase is still the same phase at instance of initialisation

                            // Separate string by every capital letter
                            let currentPhaseIndicator = currentPhase.split(/(?=[A-Z])/);

                            // Set current phase
                            jQuery('.phaseGuide-current-phase').html(currentPhaseIndicator.join(' '));

                            // Set phase instruction
                            jQuery('.phaseGuide-instruction').append(guideInstruction);

                            jQuery('.phaseGuide').removeClass('inactive-phaseGuide').addClass('active-phaseGuide');

                            phaseGuideNotice = true;

                        }

                    },1000);

                }

            }

            // Phase guide dismissal
            function dismissPhaseGuide() {

                phaseGuideNotice = false;

                jQuery('.phaseGuide').removeClass('active-phaseGuide').addClass('inactive-phaseGuide');
                jQuery('.phaseGuide-instruction').empty();

            }

            // Phase indicator update
            function updatePhaseIndicator() {

                // Separate string by every capital letter
                let currentPhaseIndicator = currentPhase.split(/(?=[A-Z])/);

                // Switch current phase
                jQuery('.overview-display-phase').clone().addClass('overview-conceal-phase').appendTo('.overview-phase-indicator');
                jQuery('.overview-current-phase').not('.overview-conceal-phase').removeClass('overview-display-phase').addClass('overview-former-phase');
                jQuery('.overview-conceal-phase').html(currentPhaseIndicator.join(' '));

                // Set current phase
                setTimeout(function(){
                    jQuery('.overview-conceal-phase').removeClass('overview-conceal-phase').addClass('overview-display-phase');
                    jQuery('.overview-former-phase').remove();
                },200);

            }

            // Update phase indicator on initialization
            updatePhaseIndicator();

            /*
            **
            ** Dialogue Box Logic
            **
            */
            var dialogueBoxContent;

            // Insert Dialogue Box into DOM if not already present 
            if (jQuery('.dialogueBox').length <= 0) {
                jQuery(dialogueBox).prependTo('.wrapper');
            }

            // Call/Dismiss Dialogue Box
            function toggleDialogueBox(windowControl,allowKeyDismissal) {

                // Remove dialogue box note
                jQuery('.dialogueBox-note').remove();

                if (jQuery('.dialogueBox').hasClass('active-dialogueBox')) { // hide the dialogue box

                    jQuery('.dialogueBox').toggleClass('active-dialogueBox inactive-dialogueBox');
                    setTimeout(function(){
                        jQuery('.dialogueBox').removeClass('minimized-dialogueBox maximized-dialogueBox');
                        jQuery('.dialogueBox-minimize, .dialogueBox-maximize').hide();
                    },200);

                    activeDialogueBox = false; // define the dialogue box state
                    dialogueBoxContent = null; // reset the dialogue box content storage variable
                    KeyDismissal = false; // disable dialogue box key dismissal

                    // allow time for the closing animations to complete
                    setTimeout(function(){
                        jQuery('.dialogueBox').css('z-index','0');
                        jQuery('.dialogueBox-body').empty(); // empty the body of the dialogue box in preparation for future use
                    },500);

                    // run callback function based on the current phase
                    if (turnSelectionPhase) {
                        endTurnSelectPhase();
                    } else if (invalidDrawNotice) {
                        dismissInvalidDrawNotice(); // dismiss invalid draw notice
                    }

                } else if (jQuery('.dialogueBox').hasClass('inactive-dialogueBox')) { // display the dialogue box

                    if(windowControl) { // determine if window control is required
                        jQuery('.dialogueBox-minimize').show();
                        jQuery('.dialogueBox').addClass('maximized-dialogueBox');
                    } else if(!windowControl) {
                        jQuery('.dialogueBox').removeClass('maximized-dialogueBox');
                        jQuery('.dialogueBox-minimize').hide();
                    }

                    if(dialogueBoxContent != null) { // only display the dialogue box if content has been defined

                        jQuery('.dialogueBox').toggleClass('active-dialogueBox inactive-dialogueBox');

                        activeDialogueBox = true;

                        jQuery('.dialogueBox').css('z-index','99');

                        // Listen for keydown events to dismiss active dialogue box
                        KeyDismissal = false;

                        setTimeout(function(){ // allow time for dialogue box to display

                            if(allowKeyDismissal) {
                                KeyDismissal = true;
                                keyDialogueBoxDismissal();
                            }

                        },500);

                    }

                }

            }

            function displayDialogueBoxNote() {

                var dialogueBoxOffset,
                    dialogueBoxTop,
                    dialogueBoxLeft;

                // Allow time for dialogue box to dock before displaying note
                setTimeout(function(){

                    // Retrieve co-ordinates and dimensions of docked dialogue box
                    dialogueBoxOffset = jQuery('.dialogueBox-component').offset(),
                    dialogueBoxTop = dialogueBoxOffset.top - jQuery(window).scrollTop(),
                    dialogueBoxLeft = dialogueBoxOffset.left;

                    jQuery('.dialogueBox-note').css({'top':dialogueBoxTop,'left':dialogueBoxLeft});

                    jQuery('.dialogueBox-note').addClass('dialogueBox-note-active');

                },500);

            }

            // Minimize/Maximize Dialogue Box
            function toggleDockDialogueBox() {

                // Remove dialogue box note
                jQuery('.dialogueBox-note').remove();

                if(!jQuery('.dialogueBox-note').length) {

                    var dialogueBoxNote = '<div class="dialogueBox-note"><span></span><i class="fas fa-info-circle"></i></div>';

                    jQuery('.dialogueBox').prepend(dialogueBoxNote);

                }

                if (jQuery('.dialogueBox').hasClass('maximized-dialogueBox')) { // dock the dialogue box

                    jQuery('.dialogueBox').removeClass('maximized-dialogueBox').addClass('minimized-dialogueBox');
                    jQuery('.dialogueBox-maximize').show();
                    jQuery('.dialogueBox-minimize').hide();

                    // Position and display dialogue box note
                    displayDialogueBoxNote();

                    // Current phase progression condition
                    switch (currentPhase) {
                        case 'handConfirmationPhase' :
                            handConfirmationPhase = false;
                            handBrowsingPhase = true;
                            formerPhase = 'handConfirmationPhase';
                            currentPhase = 'handBrowsingPhase';

                            // Update and display phase guide
                            guideInstruction = 'Browse hand and preview cards.<br><small>Placing a valid caster card into play will approve the draw.</small>';
                            updatePhaseGuide(guideInstruction,currentPhase);

                            // Set dialogue box note
                            jQuery('.dialogueBox-note span').text('Maximise: Accept Hand / Reject Hand');

                            // Update phase indicator
                            updatePhaseIndicator();

                        break;
                        default:
                            currentPhase = '';
                    }

                } else if (jQuery('.dialogueBox').hasClass('minimized-dialogueBox')) { // undock the dialogue box

                    jQuery('.dialogueBox').removeClass('minimized-dialogueBox').addClass('maximized-dialogueBox');
                    jQuery('.dialogueBox-minimize').show();
                    jQuery('.dialogueBox-maximize').hide();

                    // Position and display dialogue box note
                    displayDialogueBoxNote();

                    // Current phase progression condition
                    switch (currentPhase) {
                        case 'handBrowsingPhase' :
                            handBrowsingPhase = false;
                            handConfirmationPhase = true;
                            formerPhase = 'handBrowsingPhase';
                            currentPhase = 'handConfirmationPhase';

                            // Default dialogue box note
                            jQuery('.dialogueBox-note span').text('Minimize: Browse Hand');

                            // Update phase indicator
                            updatePhaseIndicator();

                        break;
                        case 'previewSelectionPhase' :
                            previewSelectionPhase = false;
                            handConfirmationPhase = true;
                            formerPhase = 'previewSelectionPhase';
                            currentPhase = 'handConfirmationPhase';

                            // Default dialogue box note
                            jQuery('.dialogueBox-note span').text('Minimize: Browse Hand');

                            // Dismiss preview pane
                            if(jQuery(previewPane).hasClass('inView')) {
                                jQuery(previewPane).removeClass('inView');
                            }

                            // Update phase indicator
                            updatePhaseIndicator();

                        break;
                        default:
                            currentPhase = '';
                    }

                }

            }

            // toggle dock with mouse
            jQuery('.wrapper').on('click', '.dialogueBox-minimize, .dialogueBox-maximize', function(){

                toggleDockDialogueBox();

            });

            // dismiss with keys
            function keyDialogueBoxDismissal() {

                jQuery(document).on('keydown',function(e) {

                    if (activeDialogueBox && KeyDismissal) {

                        dialogueBoxContent = null; // reset the dialogue box content storage variable

                        var key = e.key;

                        switch(key) {

                            case 'Escape':
                                toggleDialogueBox(false,false);
                            break;

                            case 'Enter':
                                toggleDialogueBox(false,false);
                            break;

                        }
                        
                        KeyDismissal = false; // disable dialogue box key dismissal

                    }

                });

            }

            // dismiss with mouse
            jQuery('.wrapper').on('click', '.dialogueBox-backdrop, .dialogueBox-dismiss', function(){

                if(currentPhase == 'handConfirmationPhase') {

                    // end hand confirmation phase, proceed to next phase (caster select phase or resource pool phase)
                    toggleDialogueBox(false,false);

                    handConfirmationPhase = false; // end hand confirmation phase

                    // determine if caster needs to be selected or is already present
                    let casterInPlay = jQuery('.in-play').find('.activeCaster').length;

                    if(casterInPlay == 0) { // no caster in play

                        casterSelectionPhase = true; // start caster selection phase and allow UI key navigation
                        formerPhase = 'handConfirmationPhase';
                        currentPhase = 'casterSelectionPhase';

                        // Update phase indicator
                        updatePhaseIndicator();

                        // Update and display phase guide
                        guideInstruction = 'Place a valid caster card in play';
                        updatePhaseGuide(guideInstruction,currentPhase);

                        // Unmark valid selection options
                        unmarkValidSelections();

                        // Mark valid selection options
                        markValidSelections('caster-card-type');

                        // Nerf ranking higher than neophyte (proficient 1/2, adept 1/3, elite 1/4, peerless 1/5)
                        setTimeout(function(){
                            forceNerf();
                        },500);

                    } else {

                        resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                        formerPhase = 'handConfirmationPhase';
                        currentPhase = 'resourcePoolingPhase';

                        // Update phase indicator
                        updatePhaseIndicator();

                        // Update and display phase guide
                        guideInstruction = 'Allocate a valid caster card for resource pooling';
                        updatePhaseGuide(guideInstruction,currentPhase);

                        // Unmark valid selection options
                        unmarkValidSelections();

                        // Mark valid selection options
                        markValidSelections('caster-card-type');

                        // Display resource value tags
                        displayResourceValueTags();

                    }

                } else if(currentPhase == 'casterConfirmationPhase') { 

                    toggleDialogueBox(false,false);

                    casterConfirmationPhase = false; // disallow UI key navigation
                    resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                    formerPhase = 'casterConfirmationPhase';
                    currentPhase = 'resourcePoolingPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                    // Update and display phase guide
                    guideInstruction = 'Allocate a valid caster card for resource pooling';
                    updatePhaseGuide(guideInstruction,currentPhase);

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // Mark valid selection options
                    markValidSelections('caster-card-type');

                    // Display resource value tags
                    displayResourceValueTags();

                } else if(currentPhase == 'resourceConfirmationPhase') { 

                    toggleDialogueBox(false,false);

                    resourceConfirmationPhase = false; // disallow UI key navigation
                    /*resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                    formerPhase = 'resourceConfirmationPhase';
                    currentPhase = 'resourcePoolingPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                    // Update and display phase guide
                    guideInstruction = 'Allocate a valid caster card for resource pooling';
                    updatePhaseGuide(guideInstruction,currentPhase);

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // Mark valid selection options
                    markValidSelections('caster-card-type');*/

                } else {
                    toggleDialogueBox(false,false);
                }

            });

            // Confirm with mouse
            jQuery('.dialogueBox').on('click','.btn-confirm',function(){

                if(handConfirmationPhase) {

                    var handPermanence = jQuery(this).attr('data-confirm');

                    determineHandConfirmation(playerHand,handPermanence); // handle confirmation response

                } else if(casterConfirmationPhase) {

                    var confirmCaster = jQuery(this).attr('data-confirm');

                    determineCasterConfirmation(confirmCaster);

                } else if(resourceConfirmationPhase) {

                    var confirmResource = jQuery(this).attr('data-confirm');

                    determineResourceConfirmation(confirmResource);

                }

            });
            jQuery('.dialogueBox').on('mouseover','.btn-confirm',function() {

                jQuery('.btn-confirm').removeClass('focus');
                jQuery(this).addClass('focus');

            });

            // Confirm with keys
            function keyConfirmation() {

                if(handConfirmationPhase) {

                    var handPermanence = jQuery('.btn-confirm.focus').attr('data-confirm');

                    determineHandConfirmation(playerHand,handPermanence); // handle confirmation response

                } else if(casterConfirmationPhase) {

                    var confirmCaster = jQuery('.btn-confirm.focus').attr('data-confirm');

                    determineCasterConfirmation(confirmCaster);

                } else if(resourceConfirmationPhase) {

                    var confirmResource = jQuery('.btn-confirm.focus').attr('data-confirm');

                    determineResourceConfirmation(confirmResource);

                }

            }

            /*
            **
            ** Building Decks
            **
            */
            // An ES6 / ECMAScript 2015 shuffling function based on the Durstenfeld shuffle
            // https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
            function shuffleDeck(deckArray) {

                for (let i = deckArray.length - 1; i > 0; i--) {

                    const j = Math.floor(Math.random() * (i + 1));
                    [deckArray[i], deckArray[j]] = [deckArray[j], deckArray[i]]; // eslint-disable-line no-param-reassign

                }
                //console.log(deckArray);

            }

            // Assign and generate deck
            var useStandbyDeck = true,
                player_standbyDeck,
                player_deckName;
            if (useStandbyDeck) {
                player_standbyDeck = [...Array(60).keys()]; // build array consisting of 60 unit values
                player_deckName = 'Auto-generated Deck';
            }
            shuffleDeck(player_standbyDeck);
            console.log(player_standbyDeck);

            // Set deck name
            jQuery('.overview-deck-details').text(player_deckName);

            /*
            **
            ** Deck Management
            **
            */
            // check if any cards remain in standby deck
            // Returns: Boolean
            function checkForRemainingCardsInDeck(playerHand,deck) {

                if(typeof deck != "undefined" && deck != null && deck.length != null && deck.length > 0) {
                    return true;
                } else {
                    // empty standby deck
                    console.log('no remaining cards in deck');
                    jQuery(playerHand).find('.standby-pile').children().remove(); // remove any lingering standby card templates
                    return false;
                }

            }

            // Randomly generate the base power
            function generateCardPower() {

                // Generate a random number bewteen 25 and 100
                var cardForce = Math.floor(Math.random()*(100-25+1)+25);

                if(cardForce > 70 && cardForce < 80) {
                    //console.log(cardForce);
                    for (let i = 0; i < 3; i++) {
                        cardForce = Math.floor(Math.random()*(100-25+1)+25);
                        //console.log('adjusted',cardForce);
                        if (cardForce < 70) {
                            i = 3;
                        }
                    }
                } else if(cardForce > 80 && cardForce < 90) {
                    //console.log(cardForce);
                    for (let i = 0; i < 5; i++) {
                        cardForce = Math.floor(Math.random()*(100-25+1)+25);
                        //console.log('adjusted',cardForce);
                        if (cardForce < 80) {
                            i = 5;
                        }
                    }
                } else if(cardForce > 90) {
                    //console.log(cardForce);
                    for (let i = 0; i < 10; i++) {
                        cardForce = Math.floor(Math.random()*(100-25+1)+25);
                        //console.log('adjusted',cardForce);
                        if (cardForce < 90) {
                            i = 10;
                        }
                    }
                }

                return cardForce;

            }

            // Randomly generate card type
            function generateCardType() {

                // Generate a random number between 1 and 10
                var cardType = Math.floor(Math.random()*(10+1)); // 1 -> 9 = caster card, 10 = support card

                if(cardType == 10) {
                    //console.log(cardType);
                    //console.log('Support Card');
                } else {
                    //console.log(cardType);
                    //console.log('Caster Card');
                }

                return cardType;

            }

            // Randomly generate card support effect
            function generateCardSupport() {

                var supportBuff  = Math.floor(Math.random()*(10-1+1)+1), // 1 -> 5 = health boost, 6 -> 10 = attack boost
                    supportNerf  = Math.floor(Math.random()*(10-1+1)+1), // 1 -> 5 = health nerf, 6 -> 10 = attack nerf
                    supportType  = Math.floor(Math.random()*(30-1+1)+1), // 1 -> 5 = buff type, 6 -> 10 = nerf type, 11 -> 15 = battle effect type, 16 -> 20 = strategic effect type, 21 -> 30 = levelling type 
                    supportBuild = 'placeholder',
                    supportDesc,
                    supportTitle,
                    supportEfficacy,
                    supportDuration,
                    supportCost,
                    supportDiscipline,
                    supportID,
                    returnedSupportCard;

                 // TEMP : To be detemined by specific card   
                 supportEfficacy = Math.floor(Math.random()*(100-25+1)+25); // 25 -> 69 = neophyte, 70 -> 79 = proficient, 80 -> 89 = adept, 90 -> 99 = elite, 100 = peerless
                 supportDuration = Math.floor(Math.random()*(10-1+1)+1); // 1 -> 8 = epheremal, 9 -> 10 = perennial

                 supportDuration = supportDuration <= 8 ? 'epheremal' : 'perennial';

                if(supportType > 0 && supportType <= 5) { // Buff type support

                    if(supportBuff > 0 && supportBuff <= 5) {

                        supportDesc = "Used during Support Phase. <br>Reduce opponent's attack power by 10"; 
                        supportType = "Buff";

                        supportBuild = `<div class="card-support-motiv support-buff-effect" data-support-duration="${supportDuration}">
                                            <i class="fas fa-shield-alt"></i>
                                            <i class="fas fa-angle-double-up"></i>
                                        </div>
                                        <div class="support-description">
                                            ${supportDesc}
                                        </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;            

                    } else if(supportBuff > 5 && supportBuff <= 10) {   

                        supportDesc = "Used during Support Phase. <br>Boost own attack power by 10"; 
                        supportType = "Buff";

                        supportBuild = `<div class="card-support-motiv support-buff-effect" data-support-duration="${supportDuration}">
                                            <i class="fas fa-crosshairs"></i>
                                            <i class="fas fa-angle-double-up"></i>
                                        </div>
                                        <div class="support-description">
                                            ${supportDesc}
                                        </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;       

                    }


                } else if(supportType > 5 && supportType <= 10) { // Nerf type support

                    if(supportNerf > 0 && supportNerf <= 5) {

                        supportDesc = "Used during Support Phase. <br>Boost own attack power by 10"; 
                        supportType = "Nerf";

                        supportBuild = `<div class="card-support-motiv support-nerf-effect" data-support-duration="${supportDuration}">
                                            <i class="fas fa-shield-alt"></i>
                                            <i class="fas fa-angle-double-down"></i>
                                        </div>
                                        <div class="support-description">
                                            ${supportDesc}
                                        </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;            

                    } else if(supportNerf > 5 && supportNerf <= 10) {

                        supportDesc = "Used during Support Phase. <br>Reduce opponent's attack power by 10"; 
                        supportType = "Nerf";

                        supportBuild = `<div class="card-support-motiv support-nerf-effect" data-support-duration="${supportDuration}">
                                            <i class="fas fa-crosshairs"></i>
                                            <i class="fas fa-angle-double-down"></i>
                                        </div>
                                        <div class="support-description">
                                            ${supportDesc}
                                        </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;             

                    }


                } else if(supportType > 10 && supportType <= 15) { // Battle effect type support

                    supportDesc = "Used during Support Phase. <br>This is a battle effect type support card <br>Hydro: Freeze (paralysis), <br>Terra: Toxic (poisoning), <br>Pyro: Scorch (burning), <br>Aero: Shock (paralysis)"; 
                    supportType = "Battle";

                    supportBuild = `<div class="card-support-motiv support-battle-effect" data-support-duration="${supportDuration}">
                                        <i class="far fa-hand-rock"></i>
                                    </div>
                                    <div class="support-description">
                                        ${supportDesc}
                                    </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;


                } else if(supportType > 15 && supportType <= 20) { // Strategic effect type support

                    supportDesc = "Used during Support Phase. <br>This is a strategy effect type support card <br>Hydro: Tidal Force (Flush Deck), <br>Terra: Tectonic Shift (Bury Support), <br>Pyro: Scorched Earth (Burn Resources), <br>Aero: Gale Force (Sweep Away Hand)";
                    supportType = "Strategic";

                    supportBuild = `<div class="card-support-motiv support-strategic-effect" data-support-duration="${supportDuration}">
                                        <i class="far fa-hand-paper"></i>
                                    </div>
                                    <div class="support-description">
                                        ${supportDesc}
                                    </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>`;   

                } else if(supportType > 20 && supportType <= 30) { // Levelling type support

                	// Return a randomly generated support card
                	returnedSupportCard = returnLevellingSupportCard();

                    supportDesc = returnedSupportCard.description;
                    supportTitle = returnedSupportCard.appellation;
                    supportType = "Levelling";
                    supportRank = returnedSupportCard.rank;
                    supportEfficacy = returnedSupportCard.efficacy;
                    supportCost = returnedSupportCard.cost;
                    supportDiscipline = returnedSupportCard.discipline;
                    supportID = returnedSupportCard.specification;

                    supportBuild = `<div class="card-support-motiv support-levelling-effect">
                                        <i class="fas fa-level-up-alt"></i>
                                        <i class="fas fa-level-down-alt"></i>
                                    </div>
                                    <div class="support-title">${supportTitle}</div>
                                    <div class="support-description">
                                        ${supportDesc}
                                    </div>
                                    <div class="support-efficacy">${supportEfficacy}</div>
                                    <div class="support-type">${supportType}</div>
                                    <div class="support-attributes" 
                                    	data-type="${supportType}"
                                    	data-appellation="${supportTitle}"
                                    	data-rank="${supportRank}"
                                    	data-efficacy="${supportEfficacy}"
                                    	data-cost="${supportCost}" 
                                    	data-discipline="${supportDiscipline}" 
                                    	data-id="${supportID}">
                                    </div>`;  

                }

                return supportBuild;

            }

            // Support card constructor
            function supportCard(specification, appellation, description, cost, ranking, efficacy, discipline) {
            	this.specification 	= specification; 	// the ID associated with the function to invoke
            	this.appellation 	= appellation; 		// the name of the support card
            	this.description 	= description;		// the description of the support card
            	this.cost 			= cost;				// the resource cost of the support card
            	this.ranking 		= ranking;			// the ranking of the support card
            	this.efficacy 		= efficacy;			// the efficacy of the support card will determine tier designation
            	this.discipline 	= discipline;		// the discipline of the support card if applicable
            }

            // Randomly return Levelling Support card
            function returnLevellingSupportCard() {

            	var levellingRandomizer = Math.floor(Math.random()*(8-1+1)+1),
            		levellingCard,
            		supportDescription;

            	switch(levellingRandomizer) {
            		// 1 = Level Acceleration
            		case 1 : 
            			supportDescription = "Advance a Caster's rank by one tier at no levelling cost. <br><br>Usage: Levelling Phase. <br><br>Requirement: Must share same discipline. <br><br>Exception: Not possible in deviant states.";
            			return levellingCard = new supportCard(100, 'Level Acceleration', supportDescription, 1, 'neophyte', 25);
            		break;
            		// 2 = Level Retrograde
            		case 2 : 
            			supportDescription = "Revert a Caster's rank to its previous tier. <br><br>Usage: Levelling Phase.";
            			return levellingCard = new supportCard(101, 'Level Retrograde', supportDescription, 3, 'proficient', 70);
            		break;
            		// 3 = Level Circumvention
            		case 3 : 
            			supportDescription = "Bypass following tier and advance a Caster's rank x2 levels up. <br><br>Usage: Levelling Phase. <br><br>Requirement: Must share same discipline. Levelling cost must be settled. <br><br>Exception: Not possible in deviant states.";
            			return levellingCard = new supportCard(102, 'Level Circumvention', supportDescription, 4, 'adept', 80);
            		break;
            		// 4 = Level Exchange
            		case 4 : 
            			supportDescription = "Exchange Caster with any other Caster of the same rank regardless of discipline. <br><br>Usage: Levelling Phase. <br><br>Requirement: Levelling cost must be settled.";
            			return levellingCard = new supportCard(103, 'Level Exchange', supportDescription, 2, 'neophyte', 25);
            		break;
            		// 5 = Level Speciality Indifference
            		case 5 : 
            			supportDescription = "Advance a Caster's rank by one tier regardless of discipline. <br><br>Usage: Levelling Phase. <br><br>Requirement: Levelling cost must be settled.";
            			return levellingCard = new supportCard(104, 'Level Speciality Indifference', supportDescription, 2, 'proficient', 70);
            		break;
            		// 6 = Level Relegation
            		case 6 : 
            			supportDescription = "Revert an opponent's Caster's rank by one tier. <br><br>Usage: Levelling Phase.";
            			return levellingCard = new supportCard(105, 'Level Relegation', supportDescription, 5, 'elite', 90);
            		break;
            		// 7 = Negligible Designation
            		case 7 : 
            			supportDescription = "Revert an opponent's Caster's rank back to the first tier. <br><br>Usage: Levelling Phase.";
            			return levellingCard = new supportCard(106, 'Negligible Designation', supportDescription, 7, 'peerless', 100);
            		break;
            		// 8 = Negligible Succession
            		case 8 : 
            			supportDescription = "Advance or regress a Caster's rank to any tier and discipline at no levelling cost. <br><br>Usage: Levelling Phase.";
            			return levellingCard = new supportCard(107, 'Negligible Succession', supportDescription, 7, 'peerless', 100);
            		break;
            	}

            }

            // Reveal card and assign rank determined by base power
            function revealDrawnCard(drawnCard, clonedCard, cardData) {

                setTimeout(function(){

                    jQuery(drawnCard).addClass('flippedCard'); // flip the modified card in the standby deck

                    setTimeout(function(){

                    jQuery(drawnCard).add(clonedCard).find('.cardBack').remove(); // remove the back
                    jQuery(drawnCard).remove(); // remove the modified card in the standby deck

                        if (useStandbyDeck) {

                            // Determine card type
                            let cardType = generateCardType();

                            if(cardType <= 9) { // caster type card

                                // Build card and define attributes
                                let elArray         = ['terra','aero','hydro','pyro'],
                                    cardDiscipline  = elArray[Math.floor(Math.random() * elArray.length)], // retrieve random value from array
                                    cardForce       = generateCardPower(),
                                    cardType        = 'Caster',
                                    cardBody        =   `<div class="cardFront">
                                                            <div class="card-marker">Valid</div>
                                                            <div class="card-number">${cardData}</div>
                                                            <div class="card-discipline">${cardDiscipline}</div>
                                                            <div class="card-resource-currency"></div>
                                                            <div class="card-elemental-motif"></div>
                                                            <div class="card-force-indicator">
                                                                <svg viewBox="0 0 32 32">
                                                                  <circle r="16" cx="16" cy="16" style="stroke-dasharray: ${cardForce} 100;"></circle>
                                                                </svg>
                                                                <div class="elite-force-indicator"></div>
                                                                <div class="adept-force-indicator"></div>
                                                                <div class="proficient-force-indicator"></div>
                                                            </div>
                                                            <div class="card-force">${cardForce}</div>
                                                            <div class="card-type">${cardType}</div>
                                                            <div class="card-ranking"></div>
                                                            <div class="card-levelling-cost"></div>
                                                        </div>`;
                                jQuery(clonedCard).prepend(cardBody).removeClass('ghostCard');

                                // Define card type
                                jQuery(clonedCard).find('.cardFront').addClass('caster-card-type');

                                // Determine card ranking
                                if(cardForce == 100) {

                                    jQuery(clonedCard).find('.cardFront').addClass('peerless-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>');

                                    // Update Levelling Cost
                                    jQuery(clonedCard).find('.card-levelling-cost').prepend(
                                            `<div class="levelling-cost" data-levelling-cost="20">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                            </div>`
                                        );

                                    // Update Resource Currency
                                    jQuery(clonedCard).attr('data-resource-currency','0');

                                } else if(cardForce >= 90 && cardForce != 100) {

                                    jQuery(clonedCard).find('.cardFront').addClass('elite-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>');

                                    // Update Levelling Cost
                                    jQuery(clonedCard).find('.card-levelling-cost').prepend(
                                            `<div class="levelling-cost" data-levelling-cost="10">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                    // Update Resource Currency
                                    jQuery(clonedCard).attr('data-resource-currency','1');
                                    jQuery(clonedCard).find('.card-resource-currency').prepend('<i class="fas fa-circle"></i>');

                                } else if(cardForce >= 80 && cardForce < 90) {

                                    jQuery(clonedCard).find('.cardFront').addClass('adept-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i><i class="fas fa-star"></i>');

                                    // Update Levelling Cost
                                    jQuery(clonedCard).find('.card-levelling-cost').prepend(
                                            `<div class="levelling-cost" data-levelling-cost="5">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                    // Update Resource Currency
                                    jQuery(clonedCard).attr('data-resource-currency','2');
                                    jQuery(clonedCard).find('.card-resource-currency').prepend('<i class="fas fa-circle"></i><i class="fas fa-circle"></i>');

                                } else if(cardForce >= 70 && cardForce < 80) {

                                    jQuery(clonedCard).find('.cardFront').addClass('proficient-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i>');

                                    // Update Levelling Cost
                                    jQuery(clonedCard).find('.card-levelling-cost').prepend(
                                            `<div class="levelling-cost" data-levelling-cost="3">
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                    // Update Resource Currency
                                    jQuery(clonedCard).attr('data-resource-currency','3');
                                    jQuery(clonedCard).find('.card-resource-currency').prepend('<i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i>');

                                } else if(cardForce >= 25 && cardForce < 70) {

                                    jQuery(clonedCard).find('.cardFront').addClass('neophyte-ranking');

                                    // Update Resource Currency
                                    if(cardForce >= 45 && cardForce < 70) {

                                        jQuery(clonedCard).attr('data-resource-currency','4');
                                        jQuery(clonedCard).find('.card-resource-currency').prepend('<i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i>');

                                    } else if(cardForce >= 25 && cardForce < 45) {

                                        jQuery(clonedCard).attr('data-resource-currency','5');
                                        jQuery(clonedCard).find('.card-resource-currency').prepend('<i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i><i class="fas fa-circle"></i>');

                                    }

                                }

                                // Determine discipline type
                                if(cardDiscipline == 'terra') {

                                    jQuery(clonedCard).find('.cardFront').addClass('terra-motiv');
                                    jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-leaf"></i>');

                                } else if(cardDiscipline == 'aero') {

                                    jQuery(clonedCard).find('.cardFront').addClass('aero-motiv');
                                    jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-cloud"></i>');

                                } else if(cardDiscipline == 'hydro') {

                                    jQuery(clonedCard).find('.cardFront').addClass('hydro-motiv');
                                    jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-tint"></i>');

                                } else if(cardDiscipline == 'pyro') {

                                    jQuery(clonedCard).find('.cardFront').addClass('pyro-motiv');
                                    jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-burn"></i>');

                                }

                            } else if(cardType == 10) { // support type card

                                // Build card and define attributes
                                let elArray         = ['terra','aero','hydro','pyro'],
                                    cardDiscipline  = elArray[Math.floor(Math.random() * elArray.length)], // retrieve random value from array
                                    cardSupport     = generateCardSupport(),
                                    cardType        = 'Support',
                                    cardBody        =   `<div class="cardFront">
                                                            <div class="card-marker">Valid</div>
                                                            <div class="card-number">${cardData}</div>
                                                            <div class="card-discipline"></div>
                                                            <div class="card-elemental-motif"></div>
                                                            <div class="card-support">${cardSupport}</div>
                                                            <div class="card-type">${cardType}</div>
                                                            <div class="card-ranking"></div>
                                                            <div class="card-resource-cost"></div>
                                                        </div>`,
                                    cardEfficacy,
                                    cardSupportType,
                                    cardSupportDuration;

                                jQuery(clonedCard).prepend(cardBody).removeClass('ghostCard');

                                // Further define card attributes
                                cardEfficacy    	= jQuery(cardBody).find('.support-efficacy').text(),
                                cardSupportType 	= jQuery(cardBody).find('.support-type').text();
                                cardSupportDuration = jQuery(cardBody).find('.card-support-motiv').attr('data-support-duration');

                                // Define card type
                                jQuery(clonedCard).find('.cardFront').addClass('support-card-type');
                                if(jQuery(cardBody).find('.support-levelling-effect').length) {
	                                jQuery(clonedCard).find('.cardFront').addClass('levelling-card-type');
	                            }

                                // Determine card efficacy
                                if(cardEfficacy == 100) {

                                    jQuery(clonedCard).find('.cardFront').addClass('peerless-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>');
                                    // TEMP : To be detemined by specific card
                                    jQuery(clonedCard).find('.card-resource-cost').prepend(
                                            `<div class="resource-cost" data-resource-cost="5">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                            </div>`
                                        );

                                } else if(cardEfficacy >= 90 && cardEfficacy != 100) {

                                    jQuery(clonedCard).find('.cardFront').addClass('elite-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>');
                                    // TEMP : To be detemined by specific card
                                    jQuery(clonedCard).find('.card-resource-cost').prepend(
                                            `<div class="resource-cost" data-resource-cost="4">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                } else if(cardEfficacy >= 80 && cardEfficacy < 90) {

                                    jQuery(clonedCard).find('.cardFront').addClass('adept-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i><i class="fas fa-star"></i>');
                                    // TEMP : To be detemined by specific card
                                    jQuery(clonedCard).find('.card-resource-cost').prepend(
                                            `<div class="resource-cost" data-resource-cost="3">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                } else if(cardEfficacy >= 70 && cardEfficacy < 80) {

                                    jQuery(clonedCard).find('.cardFront').addClass('proficient-ranking');
                                    jQuery(clonedCard).find('.card-ranking').prepend('<i class="fas fa-star"></i>');
                                    // TEMP : To be detemined by specific card
                                    jQuery(clonedCard).find('.card-resource-cost').prepend(
                                            `<div class="resource-cost" data-resource-cost="2">
                                                <i class="fas fa-circle"></i>
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                } else if(cardEfficacy >= 15 && cardEfficacy < 70) {

                                    jQuery(clonedCard).find('.cardFront').addClass('neophyte-ranking');
                                    // TEMP : To be detemined by specific card
                                    jQuery(clonedCard).find('.card-resource-cost').prepend(
                                            `<div class="resource-cost" data-resource-cost="1">
                                                <i class="fas fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                                <i class="far fa-circle"></i>
                                            </div>`
                                        );

                                }

                                // Determine support card type
                                if(cardSupportType == 'Battle' || cardSupportType == 'Strategic') { // apply disciplines to strategic or battle type support cards

                                    // Determine discipline type
                                    if(cardDiscipline == 'terra') {

                                        jQuery(clonedCard).find('.cardFront').addClass('terra-motiv');
                                        jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-leaf"></i>');
                                        jQuery(clonedCard).find('.card-discipline').prepend(cardDiscipline);

                                    } else if(cardDiscipline == 'aero') {

                                        jQuery(clonedCard).find('.cardFront').addClass('aero-motiv');
                                        jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-cloud"></i>');
                                        jQuery(clonedCard).find('.card-discipline').prepend(cardDiscipline);

                                    } else if(cardDiscipline == 'hydro') {

                                        jQuery(clonedCard).find('.cardFront').addClass('hydro-motiv');
                                        jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-tint"></i>');
                                        jQuery(clonedCard).find('.card-discipline').prepend(cardDiscipline);

                                    } else if(cardDiscipline == 'pyro') {

                                        jQuery(clonedCard).find('.cardFront').addClass('pyro-motiv');
                                        jQuery(clonedCard).find('.card-elemental-motif').prepend('<i class="fas fa-burn"></i>');
                                        jQuery(clonedCard).find('.card-discipline').prepend(cardDiscipline);

                                    }

                                }

                                // Determine support duration
                                if(cardSupportDuration == 'epheremal') { 

                                	jQuery('<div class="card-support-duration"><i class="fas fa-exchange-alt"></i></div>').insertAfter(jQuery(clonedCard).find('.cardFront .card-discipline'));

                                } else if(cardSupportDuration == 'perennial') { 

                                	jQuery('<div class="card-support-duration"><i class="fas fa-redo"></i></div>').insertAfter(jQuery(clonedCard).find('.cardFront .card-discipline'));

                                }

                            }

                        }

                    }, 250);

                }, 500);

            }

            /*
            **
            ** Draw Phase
            **
            */
            var playerHand, // prepare reference variable
            	fieldInContext,
                cardsInStandbyDeck;

            function beginDrawPhase() {

                if (drawPhase) {

                    if(playerTurn) {

                        // player start
                        playerHand = jQuery('[data-field="player-field"]');
                        fieldInContext = jQuery(playerHand).attr('data-field');
                        drawCards(playerHand);

                    } else if(!playerTurn) {

                        // AI turn
                        playerHand = jQuery('[data-field="ai-field"]');
                        fieldInContext = jQuery(playerHand).attr('data-field');
                        drawCards(playerHand);

                    }

                }

            }

            // Notify of invalid draw then redraw
            function invalidDraw(playerHand) {

                invalidDrawNotice = true; // allow key selection

                dialogueBoxContent =    `<div class="invalid-draw-notice">
                                            Invalid Draw
                                            <div class="invalid-draw-notice-detail">
                                                No valid caster cards detected.
                                            </div>
                                        </div>`;

                if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                    jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                }

                // call dialogue box
                toggleDialogueBox(false,true);

                setTimeout(function(){ // auto dismiss after delay

                    // is the turn selection phase still active?
                    if (invalidDrawNotice) {

                        toggleDialogueBox(false,false);

                        discardCards(playerHand);

                        if(playerTurn) {

                            // Update and display phase guide
                            guideInstruction = 'Discarding Cards...<br> <small>A new hand will be drawn</small>';
                            updatePhaseGuide(guideInstruction,currentPhase);

                        } else if(!playerTurn) {

                            // Update and display phase guide
                            guideInstruction = 'Discarding Cards...';
                            updatePhaseGuide(guideInstruction,currentPhase);

                        }

                    }

                },2000);

            }

            // Dismiss invalid Draw Notice
            function dismissInvalidDrawNotice() {

                invalidDrawNotice = false;

                discardCards(playerHand);

                if(playerTurn) {

                    // Update and display phase guide
                    guideInstruction = 'Discarding Cards...<br> <small>A new hand will be drawn</small>';
                    updatePhaseGuide(guideInstruction,currentPhase);

                } else if(!playerTurn) {

                    // Update and display phase guide
                    guideInstruction = 'Discarding Cards...';
                    updatePhaseGuide(guideInstruction,currentPhase);

                }

            }

            // Confirm or discard hand
            function handConfirmation(playerHand) {

                dialogueBoxContent =    `<div class="confirm-hand">
                                            Confirm Draw
                                            <div class="confirm-options">
                                                <div class="btn btn-confirm focus" data-confirm="true">Accept Hand</div>
                                                <div class="btn btn-confirm" data-confirm="false">Discard Hand</div>
                                                <div class="btn btn-confirm" data-confirm="deferred">Browse Hand</div>
                                            </div>
                                        </div>`;

                if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                    jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                }

                // call dialogue box
                toggleDialogueBox(true,false);

                handConfirmationPhase = true; // allow key selection
                formerPhase = 'drawPhase'
                currentPhase = 'handConfirmationPhase';

                // Update phase indicator
                updatePhaseIndicator();

                // Dismiss current phase guide
                dismissPhaseGuide();

            }

            // Determine player confirmation
            function determineHandConfirmation(playerHand,handPermanence) {

                // continue based on condition returned
                if(handPermanence == 'true') { // player accepts hand

                    // end hand confirmation phase, proceed to next phase (caster select phase or resource pool phase)
                    toggleDialogueBox(false,false);

                    handConfirmationPhase = false; // end hand confirmation phase

                    // determine if caster needs to be selected or is already present
                    let casterInPlay = jQuery('.in-play').find('.activeCaster').length;

                    if(casterInPlay == 0) { // no caster in play
                        casterSelectionPhase = true; // start caster selection phase and allow UI key navigation
                        formerPhase = 'handConfirmationPhase';
                        currentPhase = 'casterSelectionPhase';

                        // Update phase indicator
                        updatePhaseIndicator();

                        // Update and display phase guide
                        guideInstruction = 'Place a valid caster card in play';
                        updatePhaseGuide(guideInstruction,currentPhase);

                        // Unmark valid selection options
                        unmarkValidSelections();

                        // Mark valid selection options
                        markValidSelections('caster-card-type');

                        // Nerf ranking higher than neophyte (proficient 1/2, adept 1/3, elite 1/4, peerless 1/5)
                        setTimeout(function(){
                            forceNerf();
                        },500);

                    } else {
                        resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                        formerPhase = 'handConfirmationPhase';
                        currentPhase = 'resourcePoolingPhase';

                        // Update phase indicator
                        updatePhaseIndicator();

                        // Update and display phase guide
                        guideInstruction = 'Allocate a valid caster card for resource pooling';
                        updatePhaseGuide(guideInstruction,currentPhase);

                        // Unmark valid selection options
                        unmarkValidSelections();

                        // Mark valid selection options
                        markValidSelections('caster-card-type');

                        // Display resource value tags
                        displayResourceValueTags();

                    }

                } else if(handPermanence == 'false') { // player rejects hand

                    toggleDialogueBox(false,false); // dismiss the dialogue box

                    handConfirmationPhase = false; // end hand confirmation phase
                    drawPhase = true;
                    formerPhase = 'handConfirmationPhase';
                    currentPhase = 'drawPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                    // discard current hand
                    discardCards(playerHand);

                    if(playerTurn) {

                        // Update and display phase guide
                        guideInstruction = 'Discarding Cards...<br> <small>A new hand will be drawn</small>';
                        updatePhaseGuide(guideInstruction,currentPhase);

                    } else if(!playerTurn) {

                        // Update and display phase guide
                        guideInstruction = 'Discarding Cards...';
                        updatePhaseGuide(guideInstruction,currentPhase);

                    }

                } else if(handPermanence == 'deferred') { // player browses hand

                    // minimize dialogue box
                    toggleDockDialogueBox();

                }

            }

            // discard hand
            function discardCards(playerHand) {

                iterationDelay = 200;

                // get co-ordinates and dimensions of the dead pile
                var deadPile = jQuery(playerHand).find('.dead-pile');
                    deadPileOffset = jQuery(deadPile).offset(),
                    deadPileTop = deadPileOffset.top,
                    deadPileLeft = deadPileOffset.left,
                    deadPileWidth = jQuery(deadPile).outerHeight(),
                    deadPileHeight = jQuery(deadPile).outerWidth();

                // Discard cards
                jQuery(playerHand).find('.card-aperture.closed').each(function(i){

                    let current_aperture = jQuery(this);

                    setTimeout(function(){

                        if(jQuery(current_aperture).hasClass('closed')){

                            let current_discardingCard = jQuery(current_aperture).find('.card'), // store to variable
                                current_clonedCard;

                            // Open card slot
                            jQuery(current_aperture).removeClass('closed').addClass('open');

                            // Epheremal state handler
                            jQuery(current_aperture).addClass('placingCard');

                            // Retrieve co-ordinates and dimensions of card aperture
                            var cardApertureOffset = jQuery(current_aperture).offset(),
                                cardApertureTop = cardApertureOffset.top,
                                cardApertureLeft = cardApertureOffset.left;

                            // Set relative co-ordinates
                            var relativeTop = deadPileTop - cardApertureTop,
                                relativeLeft = deadPileLeft - cardApertureLeft;

                            // Discarding card
                            jQuery(current_discardingCard).addClass('idleCard scaleSmall speedX2').removeClass('activeCard');
                            jQuery(current_discardingCard).removeClass(function (index, className) { // remove the clone iteration reference
                                return (className.match (/(^|\s)clone-iteration-\S+/g) || []).join(' ');
                            });
                            jQuery(current_discardingCard).css({'top':relativeTop,'left':relativeLeft,'width':deadPileWidth,'height':deadPileHeight}); // in motion
                            jQuery(current_discardingCard).clone().appendTo(deadPile).removeClass('speedX2').addClass('ghostCard discard-iteration-'+i); // clone the modifeid card and add to dead pile
                            current_clonedCard = jQuery('.discard-iteration-'+i);

                            setTimeout(function(){

                                jQuery(current_discardingCard).remove();
                                jQuery(current_clonedCard).css({'top':'0','left':'0'}); // lock in position
                                jQuery(current_clonedCard).removeClass('ghostCard');
                                jQuery(current_aperture).removeClass('placingCard');

                            }, 200);

                            // Redraw if hand is cleared
                            remainingIterations = jQuery(playerHand).find('.card-aperture.closed').length;

                            if(remainingIterations <= 0) { // allow delay for final card to clear hand

                                setTimeout(function(){ // ...then draw new hand

                                    cardsInStandbyDeck = checkForRemainingCardsInDeck(playerHand,player_standbyDeck);

                                    if(cardsInStandbyDeck) {

                                        // draw a new hand
                                        drawCards(playerHand);

                                    } else { 
                                        // empty standby deck
                                        console.log('no cards detected in standby deck'); 
                                    }

                                }, 500);

                            }

                        }

                    }, iterationDelay);

                    iterationDelay += 200;

                });

            }

            // draw hand
            function drawCards(playerHand) {

                cardsInStandbyDeck = checkForRemainingCardsInDeck(playerHand,player_standbyDeck);;

                var idleCard = '<div class="card idleCard">'+cardBack+'</div>',
                    stackCount = player_standbyDeck.length;

                if(cardsInStandbyDeck) {

                    if(playerTurn) {

                        // Update and display phase guide
                        guideInstruction = 'Drawing Cards...<br> <small>Accept, reject or browse hand drawn.</small>';
                        updatePhaseGuide(guideInstruction,currentPhase);

                    } else if(!playerTurn) {

                        // Update and display phase guide
                        guideInstruction = 'Drawing Cards...';
                        updatePhaseGuide(guideInstruction,currentPhase);

                    }

                    if(jQuery(playerHand).find('.standby-pile .idleCard').length <= 0) {
                        jQuery(playerHand).find('.standby-pile').prepend(idleCard);
                    }

                    // Set stack counter
                    jQuery(playerHand).find('.stack-counter span').text(stackCount);

                    var cardsInStandbyDeckCard_offset = jQuery(playerHand).find('.standby-pile .card').offset(),
                        cardsInStandbyDeckCard_top = cardsInStandbyDeckCard_offset.top,
                        cardsInStandbyDeckCard_left = cardsInStandbyDeckCard_offset.left,
                        cardsInStandbyDeckCard_width = jQuery(playerHand).find('.standby-pile .card').outerWidth(),
                        cardsInStandbyDeckCard_height = jQuery(playerHand).find('.standby-pile .card').outerHeight();

                    jQuery(playerHand).find('.standby-pile .card').css('position','absolute');

                    iterationDelay = 200;
                    
                    // Retrieve co-ordinates and dimensions of card aperture
                    var cardApertureOffset,
                        cardApertureTop,
                        cardApertureLeft,
                        cardApertureWidth,
                        cardApertureHeight;

                    // Draw cards
                    jQuery(playerHand).find('.card-aperture.open').each(function(i){

                        let current_aperture = jQuery(this);

                        setTimeout(function(){

                            if(jQuery(current_aperture).hasClass('open')) {

                                // Retrieve co-ordinates and dimensions of open card aperture
                                cardApertureOffset = jQuery(current_aperture).offset();
                                cardApertureTop = cardApertureOffset.top;
                                cardApertureLeft = cardApertureOffset.left;
                                cardApertureWidth = jQuery(current_aperture).outerWidth();
                                cardApertureHeight = jQuery(current_aperture).outerHeight();

                                // Set relative co-ordinates
                                var relativeTop = cardsInStandbyDeckCard_top - cardApertureTop,
                                    relativeLeft = cardsInStandbyDeckCard_left - cardApertureLeft;

                                // Check for remaining cards in standby deck
                                if(cardsInStandbyDeck){

                                    // Draw the last card in the deck array
                                    let cardDetails = player_standbyDeck.pop(), // remove the last value from array (top card of standby deck)
                                        current_activeCard,
                                        current_clonedCard,
                                        playerActiveHand = jQuery(playerHand).find('.player-hand');

                                    // Draw Preparation
                                    jQuery(playerHand).find('.standby-pile .idleCard').clone().appendTo(playerActiveHand).addClass('drawing-iteration-'+i).attr('data-iteration',i); // assign active state to standby card

                                    current_activeCard = jQuery('.drawing-iteration-'+i); // store to variable

                                    jQuery(current_activeCard).css({'top': cardsInStandbyDeckCard_top, 
                                                                    'left': cardsInStandbyDeckCard_left, 
                                                                    'height': cardsInStandbyDeckCard_width,
                                                                    'width': cardsInStandbyDeckCard_height,
                                                                    'z-index': '9'
                                                                    }); // position standby card

                                    // Update stack counter
                                    stackCount = player_standbyDeck.length;
                                    jQuery(playerHand).find('.stack-counter span').text(stackCount);

                                    // Check remaining standby card count
                                    if(stackCount <= 10) {
                                        jQuery(playerHand).find('.stack-counter').addClass('stack-count-low');
                                    }

                                    // Drawing card
                                    setTimeout(function(){ // allow for a small delay for standby positioning to establish

                                        jQuery(current_activeCard).removeClass('idleCard').addClass('activeCard').css({ 'top': cardApertureTop,
                                                                                                                        'left': cardApertureLeft,
                                                                                                                        'width':cardApertureWidth,
                                                                                                                        'height':cardApertureHeight
                                                                                                                        }); // in motion
                                        jQuery(current_activeCard).clone().appendTo(current_aperture).removeClass('activeCard drawing-iteration-'+i).addClass('ghostCard clone-iteration-'+i); // clone the modifeid card and add to open aperture
                                        current_clonedCard = jQuery('.clone-iteration-'+i);
                                        jQuery(current_clonedCard).css({'top':'0','left':'0'}); // lock in position

                                        // Reveal drawn card
                                        revealDrawnCard(current_activeCard, current_clonedCard, cardDetails);

                                    },100);

                                    // Close card slot
                                    jQuery(current_aperture).removeClass('open').addClass('closed');

                                    // Check if it was the last card
                                    checkForRemainingCardsInDeck(playerHand,player_standbyDeck);

                                } else { 
                                    // Empty standby deck
                                    console.log('no cards detected in standby deck'); 
                                }

                            }

                            // Prompt hand confirmation
                            if(jQuery(playerHand).find('.card-aperture.open').length <= 0 && stackCount >= 1) {

                                setTimeout(function(){

                                    // Check for valid caster type cards
                                    if(jQuery(playerHand).find('.card-aperture .caster-card-type').length > 0) { // valid caster type found

                                        setTimeout(function(){

                                            drawPhase = false; // end draw phase

                                            // Confirm hand or discard all to draw again
                                            handConfirmation(playerHand);

                                        }, 200);

                                    // Validate hand after draw
                                    } else { // no valid caster type found

                                        setTimeout(function(){

                                            drawPhase = false; // end draw phase

                                            // Notify player beforing discarding hand and redrawing
                                            invalidDraw(playerHand);

                                        }, 200);

                                    }

                                }, 1000);                                

                            } else if(stackCount <= 0) {

                                setTimeout(function(){

                                    // Check for valid caster type cards
                                    if(jQuery(playerHand).find('.card-aperture .caster-card-type').length > 0) { // valid caster type found

                                        drawPhase = false; // end draw phase
                                        casterSelectionPhase = true; // start caster selection phase and allow UI key navigation
                                        formerPhase = 'drawPhase';
                                        currentPhase = 'casterSelectionPhase';

                                        // Update phase indicator
                                        updatePhaseIndicator();

                                        // Update and display phase guide
                                        guideInstruction = 'Place a valid caster card in play';
                                        updatePhaseGuide(guideInstruction,currentPhase);

                                        // Unmark valid selection options
                                        unmarkValidSelections();

                                        // Mark valid selection options
                                        markValidSelections('caster-card-type');

                                        // Nerf ranking higher than neophyte (proficient 1/2, adept 1/3, elite 1/4, peerless 1/5)
                                        setTimeout(function(){
                                            forceNerf();
                                        },500);

                                    // Validate hand after draw
                                    } else { // no valid caster type found

                                        // TODO : player loses game if no valid caster card is found and there are no more cards to draw
                                        console.log('game loss');

                                    }

                                }, 1000); 

                            }

                        }, iterationDelay);

                        iterationDelay += 200;

                    });

                } else {

                    jQuery(playerHand).find('.standby-pile').empty();

                }

            }

            /*
            **
            ** Turn Selection Phase
            **
            */
            // Start turn selection phase
            if (turnSelectionPhase) {

                var elArray = ['terra','aero','hydro','pyro'],
                    elArrayDesignated = [],
                    autoSelection = elArray[Math.floor(Math.random() * elArray.length)], // retrieve random value from array
                    playerSelection,
                    selectedTurn,
                    playerTurn,
                    autoDesignation;

                turnSelect(elArray);

                // imitiate key navigation phase (will remain active and adjust behaviour according to given active states)
                keyNavigation(); 

            }

            // End turn selection phase
            function endTurnSelectPhase() {

                // Hide, then remove from DOM
                jQuery('.turnCard-component').fadeOut(function(){
                    jQuery('.turnCard-component').remove();
                });

                turnSelectionPhase = false; // end turn phase
                drawPhase = true; // start draw phase 
                formerPhase = 'turnSelectionPhase';
                currentPhase = 'drawPhase';

                // Update phase indicator
                updatePhaseIndicator();

                beginDrawPhase();

            } 

            function turnSelect(elArray) {

                // Randomly selected turn matching card
                jQuery('<div></div>').addClass('turnCard turnCard-hidden').attr('data-element',autoSelection).appendTo('.turnCard-match');

                // Append the turn card back
                jQuery('.turnCard-match .turnCard').append('<div class="card facedownCard">'+cardBack+'</div>');

                switch(autoSelection) {

                    case 'terra':
                        jQuery('.turnCard .card').append('<div class="cardFront ghostCard"><div class="card"><i class="fas fa-leaf"></i></div></div>');
                    break;

                    case 'aero':
                        jQuery('.turnCard .card').append('<div class="cardFront ghostCard"><div class="card"><i class="fas fa-cloud"></i></div></div>');
                    break;

                    case 'hydro':
                        jQuery('.turnCard .card').append('<div class="cardFront ghostCard"><div class="card"><i class="fas fa-tint"></i></div></div>');
                    break;

                    case 'pyro':
                        jQuery('.turnCard .card').append('<div class="cardFront ghostCard"><div class="card"><i class="fas fa-burn"></i></div></div>');
                    break;

                }

                // Draw the turn card match
                setTimeout(function(){

                    jQuery('.turnCard-match .turnCard').removeClass('turnCard-hidden').addClass('turnCard-drawn');

                },300);

                // Randomly designate turn selection cards
                iterationDelay = 0;
                iterationCount = 0;
                for(var i=0; i <= 3; i++) {

                    autoDesignation = elArray[Math.floor(Math.random() * elArray.length)]
                    elArrayDesignated.push(autoDesignation);
                    elArray.splice( elArray.indexOf(autoDesignation), 1 );

                    // Build the turn card wrapper
                    jQuery('<div></div>').addClass('turnCard turnCard-hidden').attr({'data-element':autoDesignation,'data-designation':i}).prependTo('.turnCard-selection');

                    // Append the turn card back
                    jQuery('.turnCard[data-designation="'+i+'"]').append('<div class="card facedownCard">'+cardBack+'</div>');

                    switch(autoDesignation) {

                        case 'terra':
                            jQuery('.turnCard[data-designation="'+i+'"] .card').append('<div class="cardFront"><i class="fas fa-leaf"></i></div>');
                        break;

                        case 'aero':
                            jQuery('.turnCard[data-designation="'+i+'"] .card').append('<div class="cardFront"><i class="fas fa-cloud"></i</div>');
                        break;

                        case 'hydro':
                            jQuery('.turnCard[data-designation="'+i+'"] .card').append('<div class="cardFront"><i class="fas fa-tint"></i></div>');
                        break;

                        case 'pyro':
                            jQuery('.turnCard[data-designation="'+i+'"] .card').append('<div class="cardFront"><i class="fas fa-burn"></i></div>');
                        break;

                    }

                    jQuery('.turnCard[data-designation="'+i+'"] .cardFront').addClass('ghostCard');

                    // Draw and reveal turn card
                    iterationDelay += 300;
                    iterationCount += 1;
                    drawTurnCard(i, iterationDelay, iterationCount);

                }

            }

            // Draw turn card selection options
            function drawTurnCard(i, iterationDelay, iterationCount) {

                setTimeout(function(){

                    setTimeout(function(){

                        jQuery('.turnCard[data-designation="'+i+'"]').removeClass('turnCard-hidden').addClass('turnCard-drawn');

                        revealTurnCard(i);

                        if(iterationCount >= 4) { // allow delay for final card to reveal

                            setTimeout(function(){ // ...then apply to first card in set
                
                                if(!jQuery('.turnCard-selection .turnCard').hasClass('focus')) { // ...if this class doesn't alreaddy exist on a card

                                    jQuery('.turnCard-selection').find('.turnCard').first().addClass('focus');

                                }

                                // Update and display phase guide
                                guideInstruction = 'Choose a card. You draw first if it matches the face-down card';
                                updatePhaseGuide(guideInstruction,currentPhase);

                            }, 1000);

                        }

                    },300);

                }, iterationDelay);

            }

            // Reveal turn card selection options
            function revealTurnCard(i) {

                var drawnTurnCard = jQuery('.turnCard[data-designation="'+i+'"] .card');

                setTimeout(function(){

                    jQuery(drawnTurnCard).removeClass('facedownCard').addClass('flippedCard');

                    setTimeout(function(){

                        jQuery(drawnTurnCard).removeClass('flippedCard');
                        jQuery(drawnTurnCard).find('.cardFront').removeClass('ghostCard');
                        jQuery(drawnTurnCard).find('.cardBack').remove();

                    },150);

                },500);

            }

            // Select with mouse
            jQuery('.turnCard-component .turnCard-selection').on('click','.turnCard',function() {

                if(!jQuery(this).hasClass('focus')) {
                    jQuery('.turnCard').removeClass('focus');
                    jQuery(this).addClass('focus');
                }

                playerSelection = jQuery(this).attr('data-element');

                determineTurnOutcome();

            });
            jQuery('.turnCard-component .turnCard-selection').on('mouseover','.turnCard',function() {

                jQuery('.turnCard').removeClass('focus');
                jQuery(this).addClass('focus');

            });

            // Select with keys
            function keyTurnSelect(){

                playerSelection = jQuery('.turnCard.focus').attr('data-element');

                determineTurnOutcome();

            }

            // Is the player going first or is the AI going first?
            function determineTurnOutcome(){

                if(playerSelection == autoSelection) {
                    selectedTurn = 'first';
                    playerTurn = true;
                    // Set turn indicator
                    jQuery('[data-field="player-field"] .turn-indicator').addClass('activeTurn');
                } else {
                    selectedTurn = 'second';
                    playerTurn = false;
                    // Set turn indicator
                    jQuery('[data-field="ai-field"] .turn-indicator').addClass('activeTurn');
                }

                // determine player turn and generate dialogue box content
                if (playerTurn) {
                    dialogueBoxContent =    `<div class="turn-result">
                                                1<sup>st</sup> Turn
                                                <div class="turn-order">You draw first</div>
                                            </div>`;
                } else {
                    dialogueBoxContent =    `<div class="turn-result">
                                                2<sup>nd</sup> Turn
                                                <div class="turn-order">You draw second</div>
                                            </div>`;
                }
                if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                    jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                }

                // Reveal turn card match
                setTimeout(function(){

                    var drawnTurnCardMatch = jQuery('.turnCard-match .turnCard');

                    jQuery(drawnTurnCardMatch).removeClass('facedownCard').addClass('flippedCard');

                    setTimeout(function(){

                        jQuery(drawnTurnCardMatch).removeClass('flippedCard');
                        jQuery(drawnTurnCardMatch).find('.cardFront').removeClass('ghostCard');
                        jQuery(drawnTurnCardMatch).find('.cardBack').remove();

                        setTimeout(function(){

                            // call dialogue box
                            toggleDialogueBox(false,true);

                            setTimeout(function(){ // auto dismiss after delay

                                // is the turn selection phase still active?
                                if (turnSelectionPhase) {
                                    toggleDialogueBox(false,false);
                                }

                            },2000);

                        },300);

                    },150);

                },500);

            }

            /*
            **
            ** Selection Phases
            **
            */
            var casterSelection,
                resourceSelection,
                supportSelection,
                playerField,
                cardAperture;

            // Mark valid selections
            function markValidSelections(validType) {

                playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                jQuery('[data-field="'+playerField+'"] .card-aperture').each(function(){

                    if(jQuery(this).find('.cardFront').hasClass(validType)) {

                        jQuery(this).addClass('valid-for-selection emphasize-selection');

                    } else {

                        jQuery(this).addClass('invalid-for-selection');

                    }

                });

                setTimeout(function(){
                	jQuery('.valid-for-selection').removeClass('emphasize-selection');
                },300);

            }

            // Unmark valid selections
            function unmarkValidSelections() {

                playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                jQuery('[data-field="'+playerField+'"] .card-aperture').each(function(){

                    jQuery(this).removeClass('valid-for-selection invalid-for-selection');

                });

            }

            // Select with mouse
            jQuery('.player-hand').on('click','.valid-for-selection',function() {

                if(jQuery('.preview-pane-component.inView').length) { // if the preview selection pane is still in view...

                    // Dismiss preview pane
                    jQuery('.preview-pane-component').removeClass('inView').addClass('preview-pane-delay');

                    // Remove delay
                    setTimeout(function(){
                        jQuery('.preview-pane-component').removeClass('preview-pane-delay')
                    },1000);

                }

                if(jQuery('.minimized-dialogueBox').length) { // if dialogue box is docked, clear in preparation for next dialogue box...
                    toggleDialogueBox();
                }

                if(casterSelectionPhase || previewSelectionPhase || levellingPhase) {

                    if(!jQuery(this).hasClass('focus')) {
                        jQuery('.card-aperture').removeClass('focus');
                        jQuery(this).addClass('focus');
                    }

                    cardAperture = jQuery(this);
                    jQuery(cardAperture).find('.card').addClass('casterSelection');

                    casterSelection = jQuery('.casterSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    confirmCasterSelection(casterSelection, playerField, cardAperture);

                }

                if(resourcePoolingPhase) {

                    if(!jQuery(this).hasClass('focus')) {
                        jQuery('.card-aperture').removeClass('focus');
                        jQuery(this).addClass('focus');
                    }

                    cardAperture = jQuery(this);
                    jQuery(cardAperture).find('.card').addClass('resourceSelection');

                    resourceSelection = jQuery('.resourceSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    confirmResourceSelection(resourceSelection, playerField, cardAperture);

                }

            });
            jQuery('.player-hand').on('mouseover','.card-aperture',function() {

                jQuery('.card-aperture').removeClass('focus');
                jQuery(this).addClass('focus');

            });

            // Nerf ranking higher than neophyte (proficient 1/2, adept 1/3, elite 1/4, peerless 1/5)
            function forceNerf() {

                var checkRank = jQuery(playerHand).find('.valid-for-selection'),
                    nerfHalf = '&#189;',
                    nerfThird = '&#8531;',
                    nerfFourth = '&#188;',
                    nerfFifth = '&#8533;',
                    naturalForce,
                    nerfedForce,
                    adjustedForce;

                // Nerf force by ranking
                jQuery(checkRank).each(function(i){

                    if(jQuery(this).find('.cardFront').hasClass('proficient-ranking')) {

                    	jQuery(this).addClass('caster-nerfed');

                        nerfedForce = Number(jQuery(this).find('.card-force').text());

                        nerfedForce = Math.ceil(nerfedForce / 2);
                        naturalForce = jQuery(this).find('.card-force').text();
                        adjustedForce = '<div class="card-force-nerf ghostEl"><strike>'+naturalForce+'</strike><span>'+nerfedForce+'<i class="fas fa-level-down-alt"></i></span></div>';

                        // Adjust card force
                        jQuery(this).find('.card-force').addClass('card-force-nerfed').empty().prepend(adjustedForce);
                        jQuery(this).find('.card-force-indicator svg').clone().prependTo(jQuery(this).find('.card-force-indicator')).addClass('natural-force');
                        jQuery(this).find('.card-force-indicator svg:not(.natural-force) circle').css('stroke-dasharray',nerfedForce+' 100');

                        // Display nerf fraction
                        jQuery(this).find('.card-marker').prepend('<div class="card-force-fraction-deduction ghostEl"><i class="fas fa-arrow-down"></i><span>'+nerfHalf+'</span></div>');

                    } else if(jQuery(this).find('.cardFront').hasClass('adept-ranking')) {

                    	jQuery(this).addClass('caster-nerfed');

                        nerfedForce = Number(jQuery(this).find('.card-force').text());

                        nerfedForce = Math.ceil(nerfedForce / 3);
                        naturalForce = jQuery(this).find('.card-force').text();
                        adjustedForce = '<div class="card-force-nerf ghostEl"><strike>'+naturalForce+'</strike><span>'+nerfedForce+'<i class="fas fa-level-down-alt"></i></span></div>';

                        // Adjust card force
                        jQuery(this).find('.card-force').addClass('card-force-nerfed').empty().prepend(adjustedForce);
                        jQuery(this).find('.card-force-indicator svg').clone().prependTo(jQuery(this).find('.card-force-indicator')).addClass('natural-force');
                        jQuery(this).find('.card-force-indicator svg:not(.natural-force) circle').css('stroke-dasharray',nerfedForce+' 100');

                        // Display nerf fraction
                        jQuery(this).find('.card-marker').prepend('<div class="card-force-fraction-deduction ghostEl"><i class="fas fa-arrow-down"></i><span>'+nerfThird+'</span></div>');

                    } else if(jQuery(this).find('.cardFront').hasClass('elite-ranking')) {

                    	jQuery(this).addClass('caster-nerfed');

                        nerfedForce = Number(jQuery(this).find('.card-force').text());

                        nerfedForce = Math.ceil(nerfedForce / 4);
                        naturalForce = jQuery(this).find('.card-force').text();
                        adjustedForce = '<div class="card-force-nerf ghostEl"><strike>'+naturalForce+'</strike><span>'+nerfedForce+'<i class="fas fa-level-down-alt"></i></span></div>';

                        // Adjust card force
                        jQuery(this).find('.card-force').addClass('card-force-nerfed').empty().prepend(adjustedForce);
                        jQuery(this).find('.card-force-indicator svg').clone().prependTo(jQuery(this).find('.card-force-indicator')).addClass('natural-force');
                        jQuery(this).find('.card-force-indicator svg:not(.natural-force) circle').css('stroke-dasharray',nerfedForce+' 100');

                        // Display nerf fraction
                        jQuery(this).find('.card-marker').prepend('<div class="card-force-fraction-deduction ghostEl"><i class="fas fa-arrow-down"></i><span>'+nerfFourth+'</span></div>');

                    } else if(jQuery(this).find('.cardFront').hasClass('peerless-ranking')) {

                    	jQuery(this).addClass('caster-nerfed');

                        nerfedForce = Number(jQuery(this).find('.card-force').text());

                        nerfedForce = Math.ceil(nerfedForce / 5);
                        naturalForce = jQuery(this).find('.card-force').text();
                        adjustedForce = '<div class="card-force-nerf ghostEl"><strike>'+naturalForce+'</strike><span>'+nerfedForce+'<i class="fas fa-level-down-alt"></i></span></div>';

                        // Adjust card force
                        jQuery(this).find('.card-force').addClass('card-force-nerfed').empty().prepend(adjustedForce);
                        jQuery(this).find('.card-force-indicator svg').clone().prependTo(jQuery(this).find('.card-force-indicator')).addClass('natural-force');
                        jQuery(this).find('.card-force-indicator svg:not(.natural-force) circle').css('stroke-dasharray',nerfedForce+' 100');

                        // Display nerf fraction
                        jQuery(this).find('.card-marker').prepend('<div class="card-force-fraction-deduction ghostEl"><i class="fas fa-arrow-down"></i><span>'+nerfFifth+'</span></div>');

                    }

                });

				setTimeout(function(){
					jQuery(checkRank).find('.ghostEl').removeClass('ghostEl');
				},100);

            }

            // Remove force nerfs
            function restoreForce() {

            	var nerfedCard = jQuery(playerHand).find('.player-hand .caster-nerfed'),
            		nerfedCardCount = jQuery(nerfedCard).length,
            		restoreForce;

            	iterationDelay = 200;

            	jQuery(nerfedCard).each(function(i,el){
            		i++

            		setTimeout(function(){

            			// Remove fraction deduction
            			jQuery(el).find('.card-force-fraction-deduction').fadeOut(100,function(){
            				jQuery(el).find('.card-force-fraction-deduction').remove();
            			});

	                	// Restore force indicator
	                    restoreForce = jQuery(el).find('.card-force-nerfed strike').text();
	                    jQuery(el).find('.card-force-indicator svg:not(.natural-force) circle').css('stroke-dasharray',restoreForce+', 100');

	                    // Restore natural force
	                    jQuery(el).find('.card-force-nerfed span').fadeOut(100,function(){
	                    	jQuery(el).find('.card-force-nerfed span').text(restoreForce).prependTo(jQuery(el).find('.card-force-nerfed'));
	                    	jQuery(el).find('.card-force-nerf').remove();
	                    });
	                    jQuery(el).find('.card-force strike, .card-force .fas').fadeOut(100).remove();

	                    if(i == nerfedCardCount) {
	                    	setTimeout(function(){
			                    jQuery(nerfedCard).find('.card-force').removeClass('card-force-nerfed').children().fadeIn();
		                    	jQuery(nerfedCard).find('.card-force-indicator .natural-force').remove();
								jQuery(nerfedCard).removeClass('caster-nerfed');
							},200);
	                	}

	                },iterationDelay);

	                iterationDelay += 200;

                });

            }

            /*
            **
            ** Caster Selection Phase
            **
            */

            // Select with keys
            function keySelectCaster() {

                if(casterSelectionPhase || previewSelectionPhase || levellingPhase) {

                    if(!jQuery('.valid-for-selection').length) { // if no valid cards have been marked yet...

                        // Unmark valid selection options
                        unmarkValidSelections();

                        // Mark valid selection options
                        markValidSelections('caster-card-type');

                    }

                    if(jQuery('.preview-pane-component.inView').length) { // if the preview selection pane is still in view...

                        // Dismiss preview pane
                        jQuery('.preview-pane-component').removeClass('inView').addClass('preview-pane-delay');

                        // Remove delay
                        setTimeout(function(){
                            jQuery('.preview-pane-component').removeClass('preview-pane-delay')
                        },1000);

                    }

                    if(jQuery('.minimized-dialogueBox').length) { // if dialogue box is docked, clear in preparation for next dialogue box...
                        toggleDialogueBox();
                    }

                    cardAperture = jQuery('.valid-for-selection.focus');
                    jQuery(cardAperture).find('.card').addClass('casterSelection');

                    casterSelection = jQuery('.casterSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    confirmCasterSelection(casterSelection, playerField, cardAperture);

                }

            }

            // Prompt player to confirm selection
            function confirmCasterSelection(casterSelection, playerField, cardAperture) {

                // Move to in-play field
                placeInPlay(casterSelection, playerField, cardAperture);
                jQuery(cardAperture).removeClass('focus closed valid-for-selection').addClass('open');

                setTimeout(function(){

                    dialogueBoxContent =    `<div class="confirm-hand">
                                                Confirm Selection
                                                <div class="confirm-options">
                                                    <div class="btn btn-confirm focus" data-confirm="true">Accept Caster</div>
                                                    <div class="btn btn-confirm" data-confirm="false">Reject Caster</div>
                                                </div>
                                            </div>`;

                    if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                        jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                    }

                    // call dialogue box
                    toggleDialogueBox(false,true);
                
                },500);

                // Dismiss the current phase guide
                dismissPhaseGuide();

                if(casterSelectionPhase) {

	                casterSelectionPhase = false; // disallow UI key navigation
	                formerPhase = 'casterSelectionPhase';

	            } else if(previewSelectionPhase) {

	                previewSelectionPhase = false; // disallow UI key navigation
	            	formerPhase = 'previewSelectionPhase';

	            } else if(levellingPhase) {

	                levellingPhase = false; // disallow UI key navigation
	            	formerPhase = 'levellingPhase';

	            }
                casterConfirmationPhase = true; // allow key selection
                currentPhase = 'casterConfirmationPhase';

                // Update phase indicator
                updatePhaseIndicator();

            }

            function HPcharge(charge,limit) {

                playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                iterationDelay = 100;

                if(charge == 'up') {

                    jQuery('[data-battle-field="'+playerField+'"] .hitpoint-component').find('.hitpoint-percentile').addClass('activePercentile');

                    // Interval loop variables
                    var hitpointComponent = jQuery('[data-battle-field="'+playerField+'"] .hitpoint-component'),
                    	hitpointPercentile = jQuery(hitpointComponent).find('.activePercentile').length ? Number(jQuery(hitpointComponent).find('.activePercentile').text()) : 0;
                        hitpointPercentileIteration = 0;

                    // Timed loop: add x10 hitpoint percentiles for the limit defined
                    var intervalID = setInterval(function(){

                       if(hitpointPercentileIteration === limit){ // clear interval when iteration limit is reached
                          clearInterval(intervalID);
                       }

                       var timeoutID = setTimeout(function(){ 

                            jQuery('.activePercentile').text(hitpointPercentile);
                            hitpointPercentile+=10;

                       }, 100);

                       hitpointPercentileIteration++;

                    }, 100);

                    // HP charge up
                    jQuery(jQuery('[data-battle-field="'+playerField+'"] .hitpoint-meter div').get().reverse()).each(function(){

                    	if(hitpointPercentileIteration === limit){ return; } // break out of loop if limit is met
                    
                        let HPmeter = jQuery(this);

                        setTimeout(function(){

                            jQuery(HPmeter).addClass('activeIndicator');

                        }, iterationDelay);

                        iterationDelay += 100;

                    });

                } else if(charge == 'down') {

                    // Interval loop variables
                    var hitpointComponent = jQuery('[data-battle-field="'+playerField+'"] .hitpoint-component'),
                    	hitpointPercentile = jQuery(hitpointComponent).find('.activePercentile').length ? Number(jQuery(hitpointComponent).find('.activePercentile').text()) : 100;
                        hitpointPercentileIteration = 0;

                    // Determine if 

                    // Timed loop: deduct x10 hitpoint percentiles for the limit defined
                    var intervalID = setInterval(function(){

                       if(hitpointPercentileIteration === limit){ // clear interval when iteration limit is reached
                          clearInterval(intervalID);

                        	if(limit === 10) { // remove hitpoint counter after deduction

	                          setTimeout(function(){ 
	                            jQuery(hitpointComponent).find('.hitpoint-percentile').empty().removeClass('activePercentile'); // remove active class and empty node
	                          },100);

	                        }

                       }

                       var timeoutID = setTimeout(function(){ 

                            jQuery('.activePercentile').text(hitpointPercentile);
                            hitpointPercentile-=10;

                       }, 50);

                       hitpointPercentileIteration++;

                    }, 50);

                    // HP charge down
                    jQuery(hitpointComponent).find('.hitpoint-meter div').each(function(){

                    	if(hitpointPercentileIteration === limit){ return; } // break out of loop if limit is met
                    
                        let HPmeter = jQuery(this);

                        setTimeout(function(){

                            jQuery(HPmeter).removeClass('activeIndicator');

                        }, iterationDelay);

                        iterationDelay += 50;

                    });

                }

            }

            // Determine caster confirmation
            function determineCasterConfirmation(confirmCaster) {

                // continue based on condition returned
                if(confirmCaster == 'true') { // player accepts caster

                    toggleDialogueBox(false,true);

                    //Remove force nerfs
                    restoreForce();

                    // Remove card tether reference
                    jQuery('.card-aperture').removeClass('tetherCard'); 

                    // Reset hitpoint reversal reference
                    jQuery('[data-battle-field="'+playerField+'"]').find('.hitpoint-percentile').attr('data-revert-hitpoints','0');

                	// Remove the activeCaster class on any caster cards lower down the stacking order (essential for Levelling Phases)
                	if(jQuery('[data-battle-field="'+playerHand+'"] .in-play').find('.activeCaster').length > 1) {
	                	jQuery('[data-battle-field="'+playerHand+'"] .in-play').find('.activeCaster').not(':last').removeClass('activeCaster');
	                }

                    setTimeout(function(){

	                    if(formerPhase == 'casterSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 0 || 
	                    	formerPhase == 'previewSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 0) {

		                    casterConfirmationPhase = false; // disallow UI key navigation
		                    resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
		                    formerPhase = 'casterConfirmationPhase';
		                    currentPhase = 'resourcePoolingPhase';

		                    // Update phase indicator
		                    updatePhaseIndicator();

		                    // Update and display phase guide
		                    guideInstruction = 'Allocate a valid caster card for resource pooling';
		                    updatePhaseGuide(guideInstruction,currentPhase);

		                    // Unmark valid selection options
		                    unmarkValidSelections();

		                    // Mark valid selection options
		                    markValidSelections('caster-card-type');

		                    // Display resource value tags
		                    displayResourceValueTags();

		                } else if(formerPhase == 'levellingPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 1 || 
	                    	formerPhase == 'previewSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 1) {

		                	resourceTransaction();

		                    casterConfirmationPhase = false; // disallow UI key navigation
		                    /*resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
		                    formerPhase = 'casterConfirmationPhase';
		                    currentPhase = 'resourcePoolingPhase';

		                    // Update phase indicator
		                    updatePhaseIndicator();

		                    // Update and display phase guide
		                    guideInstruction = 'Allocate a valid caster card for resource pooling';
		                    updatePhaseGuide(guideInstruction,currentPhase);

		                    // Unmark valid selection options
		                    unmarkValidSelections();

		                    // Mark valid selection options
		                    markValidSelections('caster-card-type');

		                    // Display resource value tags
		                    displayResourceValueTags();*/

		                }

		            },500);

                } else if(confirmCaster == 'false') { // player rejects caster

                    toggleDialogueBox(false,true);

                    cardAperture = jQuery('.tetherCard');
                    casterSelection = jQuery('.in-play').find('.activeCaster').last().addClass('returnSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    removeFromPlay(casterSelection, playerField, cardAperture);

                    setTimeout(function(){

	                    if(formerPhase == 'casterSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length <= 0 || 
	                    	formerPhase == 'previewSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length <= 0) {

		                    casterConfirmationPhase = false; // disallow UI key navigation
		                    casterSelectionPhase = true; // start caster selection phase and allow UI key navigation
		                    formerPhase = 'casterConfirmationPhase';
		                    currentPhase = 'casterSelectionPhase';

		                    // Update phase indicator
		                    updatePhaseIndicator();

		                    // Update and display phase guide
		                    guideInstruction = 'Place a valid caster card in play';
		                    updatePhaseGuide(guideInstruction,currentPhase);

		                    // Unmark valid selection options
		                    unmarkValidSelections();

		                    // Mark valid selection options
		                    markValidSelections('caster-card-type');

		                } else if(formerPhase == 'levellingPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 0 || 
	                    	formerPhase == 'previewSelectionPhase' && jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 0) {

		                    casterConfirmationPhase = false; // disallow UI key navigation
		                    levellingPhase = true; // start levelling phase and allow UI key navigation
		                    formerPhase = 'casterConfirmationPhase';
		                    currentPhase = 'levellingPhase';

		                    // Update phase indicator
		                    updatePhaseIndicator();

		                    // Update and display phase guide
		                    guideInstruction = 'Select a valid caster card to promote to';
		                    updatePhaseGuide(guideInstruction,currentPhase);

		                    // Unmark valid selection options
		                    unmarkValidSelections();

		                    // Mark valid selection options
		                    promoteRankPossibility();

		                }

		            },500);

                }

            }

            // Move seleted caster into field of play
            function placeInPlay(casterSelection, playerField, cardAperture) {

                // Epheremal state handler
                jQuery(cardAperture).addClass('placingCard');

                // Retrieve co-ordinates and dimensions of in-play placeholder
                var placeholder = jQuery('[data-battle-field="'+playerField+'"]').find('.in-play'),
                    placeholderOffset = jQuery(placeholder).offset(),
                    placeholderTop = placeholderOffset.top,
                    placeholderLeft = placeholderOffset.left,
                    placeholderWidth = jQuery(placeholder).outerWidth(),
                    placeholderHeight = jQuery(placeholder).outerHeight();

                // Retrieve co-ordinates and dimensions of card aperture
                var cardApertureOffset = jQuery(cardAperture).offset(),
                    cardApertureTop = cardApertureOffset.top,
                    cardApertureLeft = cardApertureOffset.left;

                // Set relative co-ordinates
                var relativeTop = placeholderTop - cardApertureTop,
                    relativeLeft = placeholderLeft - cardApertureLeft;

                // Placing card
                jQuery(casterSelection).addClass('activeCard speedX2');
                jQuery(casterSelection).css({'top':relativeTop,'left':relativeLeft,'width':placeholderWidth,'height':placeholderHeight}); // in motion
                jQuery(casterSelection).clone().appendTo(placeholder).removeClass('casterSelection activeCard speedX2').addClass('activeCaster ghostCard'); // clone the modifeid card and add to in-play placeholder

                setTimeout(function(){

                    jQuery(casterSelection).remove();
                    jQuery('.activeCaster').css({'top':'0','left':'0'}); // lock in position
                    jQuery('.activeCaster').removeClass('ghostCard');
                    jQuery(cardAperture).removeClass('placingCard');
                    jQuery(cardAperture).addClass('tetherCard'); // tether card to aperture for return reference if necessary

                    if(levellingPhase) {
                    	jQuery(cardAperture).removeClass('emphasize-promotion');
                    }

                }, 200);

                // Determine charge limit
                var chargeLimit,
                	currentHP;

                if(jQuery('[data-battle-field="'+playerField+'"]').find('.activePercentile').length) { // there is already an active percentile to reference...

                	// Reference current HP for reversals
                	currentHP = Number(jQuery('[data-battle-field="'+playerField+'"]').find('.activePercentile').text());
                	jQuery('[data-battle-field="'+playerField+'"]').find('.hitpoint-percentile').attr('data-revert-hitpoints',currentHP);

                	chargeLimit = 10 - ( currentHP / 10 );

                } else { // ... no active percentile to reference, define default

                	// Reference current HP for reversals
                	currentHP = 100;
                	jQuery('[data-battle-field="'+playerField+'"]').find('.hitpoint-percentile').attr('data-revert-hitpoints',currentHP);

                	chargeLimit = 10;

                }

                HPcharge('up',chargeLimit);

            }

            // Remove seleted caster from field of play
            function removeFromPlay(casterSelection, playerField, cardAperture) {

                var inPlayAperture = jQuery('[data-battle-field="'+playerField+'"]').find('.in-play');

                // Epheremal state handler
                jQuery(inPlayAperture).addClass('placingCard');

                // Retrieve co-ordinates and dimensions of in-play placeholder
                var placeholder = jQuery('[data-battle-field="'+playerField+'"]').find('.in-play'),
                    placeholderOffset = jQuery(placeholder).offset(),
                    placeholderTop = placeholderOffset.top,
                    placeholderLeft = placeholderOffset.left;

                // Retrieve co-ordinates and dimensions of card aperture
                var cardApertureOffset = jQuery(cardAperture).offset(),
                    cardApertureTop = cardApertureOffset.top,
                    cardApertureLeft = cardApertureOffset.left
                    cardApertureWidth = jQuery(cardAperture).outerWidth(),
                    cardApertureHeight = jQuery(cardAperture).outerHeight();

                // Set relative co-ordinates
                var relativeTop = cardApertureTop - placeholderTop,
                    relativeLeft = cardApertureLeft - placeholderLeft;

                // Placing card
                jQuery(casterSelection).removeClass('activeCaster activeCard').addClass('speedX2');
                jQuery(casterSelection).css({'top':relativeTop,'left':relativeLeft,'width':cardApertureWidth,'height':cardApertureHeight}); // in motion
                jQuery(casterSelection).clone().appendTo(cardAperture).removeClass('speedX2 returnSelection').addClass('inactiveCaster ghostCard'); // clone the modifeid card and add to in-play placeholder

                setTimeout(function(){

                    jQuery(casterSelection).remove();
                    jQuery('.inactiveCaster').css({'top':'0','left':'0'}); // lock in position
                    jQuery('.inactiveCaster').removeClass('inactiveCaster ghostCard');
                    jQuery(cardAperture).removeClass('tetherCard open');
                    jQuery(inPlayAperture).removeClass('placingCard');
                    jQuery(cardAperture).addClass('closed valid-for-selection'); // restore former aperture classes

                    if(levellingPhase) {
                    	jQuery(cardAperture).addClass('emphasize-promotion');
                    }

                }, 200);

                // Determine charge limit
                var chargeLimit,
                	revertToHP;

                if(jQuery('[data-battle-field="'+playerField+'"]').find('.activePercentile').length) { // there is already an active percentile to reference...

                	revertToHP = Number(jQuery('[data-battle-field="'+playerField+'"]').find('.activePercentile').attr('data-revert-hitpoints'));

                	chargeLimit = 10 - ( revertToHP / 10 );

                	if(chargeLimit == 0) { // the calculated difference as a result of a maxed HP percentile

                		if(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card').length > 1) { // card/s remaining after removal, revert HP

                			chargeLimit = 0;

                		} else { // no other cards remaining after removal, reset HP

                			chargeLimit = 10;

                		}
                	}

                }

                HPcharge('down',chargeLimit);

            }

            /*
            **
            ** Resource Pool Phase
            **
            */
            var resourceMotiv,
                resourceCurrency,
                resourceCurrentCount,
                resourceUpdatedCount,
                resourceTagReference;

            // Select with keys
            function keySelectResource() {

                if(resourcePoolingPhase) {

                    cardAperture = jQuery('.valid-for-selection.focus');
                    jQuery(cardAperture).find('.card').addClass('resourceSelection');

                    resourceSelection = jQuery('.resourceSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    confirmResourceSelection(resourceSelection, playerField, cardAperture);

                }

            }

            // Prompt player to confirm selection
            function confirmResourceSelection(resourceSelection, playerField, cardAperture) {

                // Move to resource pool
                placeInPool(resourceSelection, playerField, cardAperture);
                jQuery(cardAperture).removeClass('focus closed valid-for-selection').addClass('open');

                dialogueBoxContent =    `<div class="confirm-hand">
                                            Confirm Selection
                                            <div class="confirm-options">
                                                <div class="btn btn-confirm focus" data-confirm="true">Confirm</div>
                                                <div class="btn btn-confirm" data-confirm="false">Reject</div>
                                            </div>
                                        </div>`;

                if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                    jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                }

                // call dialogue box
                toggleDialogueBox(false,true);

                if(previewSelectionPhase) {

	                previewSelectionPhase = false; // disallow UI key navigation
	            	formerPhase = 'previewSelectionPhase';

	            } else if(resourcePoolingPhase) {

	                resourcePoolingPhase = false; // disallow UI key navigation
	            	formerPhase = 'resourcePoolingPhase';

	            }
                resourceConfirmationPhase = true; // allow key selection
                currentPhase = 'resourceConfirmationPhase';

                // Update phase indicator
                updatePhaseIndicator();

            }

            // Determine resource confirmation
            function determineResourceConfirmation(confirmResource) {

                // continue based on condition returned
                if(confirmResource == 'true') { // player confirms resource

                    toggleDialogueBox(false,true);

                    jQuery('.card-aperture').removeClass('tetherCard'); // remove card tether reference
                    jQuery('.resource').removeClass('poolingResource'); // remove resource pool reference
                    jQuery('.resource-aperture').removeClass('activeResource'); // remove aperture reference

                    // Remove resource value tags
                    removeResourceValueTags();

                    resourceConfirmationPhase = false; // disallow UI key navigation

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // Determine if ranking is possible
                    if(supportLevellingPossibility()) { // check for support leveling cards

                    	// TODO : call dialogue box to prompt player to proceed or skip, proceed to Levelling Phase if skipped

	                    supportLevellingPhase = true; // start resource pooling phase and allow UI key navigation
	                    formerPhase = 'resourceConfirmationPhase';
	                    currentPhase = 'supportLevellingPhase';

	                    // Update phase indicator
	                    updatePhaseIndicator();

	                    // Update and display phase guide
	                    guideInstruction = 'Select a valid support levelling card to place in play';
	                    updatePhaseGuide(guideInstruction,currentPhase);

                        // Mark valid selection options
                        markValidSelections('levelling-card-type');

                    } else if(promoteRankPossibility()) { // check for standard levelling requirements

	                    levellingPhase = true; // start resource pooling phase and allow UI key navigation
	                    formerPhase = 'resourceConfirmationPhase';
	                    currentPhase = 'levellingPhase';

	                    // Update phase indicator
	                    updatePhaseIndicator();

	                    // Update and display phase guide
	                    guideInstruction = 'Select a valid caster card to promote to';
	                    updatePhaseGuide(guideInstruction,currentPhase);

	                } else { // rank promotion not possible, proceed to Support Phase

	                    supportSelectionPhase = true; // start resource pooling phase and allow UI key navigation
	                    formerPhase = 'resourceConfirmationPhase';
	                    currentPhase = 'supportSelectionPhase';

	                    // Update phase indicator
	                    updatePhaseIndicator();

	                    // Update and display phase guide
	                    guideInstruction = 'Allocate a valid support card for battle phase assist';
	                    updatePhaseGuide(guideInstruction,currentPhase);

	                    // Mark valid selection options
	                    markValidSelections('support-card-type');

	                    // Unmark valid selection options
	                    unmarkValidSelections();

	                }

                } else if(confirmResource == 'false') { // player rescinds resource

                    toggleDialogueBox(false,true);

                    cardAperture = jQuery('.tetherCard');
                    resourceSelection = jQuery('.resource').find('.activeResource');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    removeFromPool(resourceSelection, playerField, cardAperture);

                    resourceConfirmationPhase = false; // disallow UI key navigation
                    resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                    formerPhase = 'resourceConfirmationPhase';
                    currentPhase = 'resourcePoolingPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                    // Update and display phase guide
                    guideInstruction = 'Allocate a valid caster card for resource pooling';
                    updatePhaseGuide(guideInstruction,currentPhase);

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // Mark valid selection options
                    markValidSelections('caster-card-type');

                }

            }

            // Move seletedresource into applicable pool
            function placeInPool(resourceSelection, playerField, cardAperture) {

                // Epheremal state handler
                jQuery(cardAperture).addClass('placingCard');

                if (jQuery(resourceSelection).find('.cardFront').hasClass('terra-motiv')) {
                    resourceMotiv = '.resource-terra .resource-aperture';
                } else if (jQuery(resourceSelection).find('.cardFront').hasClass('aero-motiv')) {
                    resourceMotiv = '.resource-aero .resource-aperture';
                } else if (jQuery(resourceSelection).find('.cardFront').hasClass('hydro-motiv')) {
                    resourceMotiv = '.resource-hydro .resource-aperture';
                } else if (jQuery(resourceSelection).find('.cardFront').hasClass('pyro-motiv')) {
                    resourceMotiv = '.resource-pyro .resource-aperture';
                }

                jQuery(resourceMotiv).parent('.resource').addClass('poolingResource');

                // Retrieve co-ordinates and dimensions of resource placeholder
                var placeholder = jQuery('[data-resource-field="'+playerField+'"]').find(resourceMotiv),
                    placeholderOffset = jQuery(placeholder).offset(),
                    placeholderTop = placeholderOffset.top,
                    placeholderLeft = placeholderOffset.left,
                    placeholderWidth = jQuery(placeholder).outerWidth(),
                    placeholderHeight = jQuery(placeholder).outerHeight();

                // Retrieve co-ordinates and dimensions of card aperture
                var cardApertureOffset = jQuery(cardAperture).offset(),
                    cardApertureTop = cardApertureOffset.top,
                    cardApertureLeft = cardApertureOffset.left;

                // Set relative co-ordinates
                var relativeTop = placeholderTop - cardApertureTop,
                    relativeLeft = placeholderLeft - cardApertureLeft;

                // Placing card
                jQuery(resourceSelection).addClass('activeCard activeResource speedX2');
                jQuery(resourceSelection).css({'top':relativeTop,'left':relativeLeft,'width':placeholderHeight,'height':placeholderWidth}); // in motion
                jQuery(resourceSelection).clone().appendTo(placeholder).removeClass('resourceSelection activeCard speedX2').addClass('activeResource ghostCard'); // clone the modifeid card and add to in-play placeholder

                // Remove resource tag
                resourceTagReference = jQuery(resourceSelection).attr('data-iteration');
                jQuery('.display-resource-value[data-tag-iteration="'+resourceTagReference+'"]').removeClass('activeResourceTag');

                // Calculate resource pool wealth
                resourceCurrentCount = Number(jQuery(placeholder).parent('.resource').find('.resource-counter').attr('data-pool-wealth'));
                resourceCurrency = jQuery(resourceSelection).attr('data-resource-currency');
                resourceUpdatedCount = resourceCurrentCount += resourceCurrency;

                setTimeout(function(){

                    jQuery(resourceSelection).remove();
                    jQuery('.activeResource').css({'top':'0','left':'0'}); // lock in position
                    jQuery('.activeResource').removeClass('ghostCard');
                    jQuery(cardAperture).removeClass('placingCard');
                    jQuery(cardAperture).addClass('tetherCard'); // tether card to aperture for return reference if necessary

                    // Update resource pool wealth
                    jQuery(placeholder).parent('.resource').find('.resource-counter').text(resourceUpdatedCount);
                    jQuery(placeholder).parent('.resource').find('.resource-counter').attr('data-pool-wealth',resourceUpdatedCount);

                    // Display added resource value
                    jQuery(placeholder).parent('.resource').find('.resource-added-value').text(resourceCurrency).toggleClass('activeAddedValue');
                    setTimeout(function(){
                        jQuery(placeholder).parent('.resource').find('.resource-added-value').empty().toggleClass('activeAddedValue');
                    },1000);


                    // Indicate active pool
                    if(!jQuery(placeholder).parent('.resource').hasClass('activePool')) {
                        jQuery(placeholder).parent('.resource').addClass('activePool');
                    }

                }, 200);

            }

            // Remove seleted resource from pool
            function removeFromPool(resourceSelection, playerField, cardAperture) {

                var resourceAperture = jQuery('[data-resource-field="'+playerField+'"]').find('.poolingResource .resource-aperture');

                // Epheremal state handler
                jQuery(resourceAperture).addClass('placingCard');

                // Retrieve co-ordinates and dimensions of resource placeholder
                var placeholder = jQuery('[data-resource-field="'+playerField+'"]').find(resourceAperture),
                    placeholderOffset = jQuery(placeholder).offset(),
                    placeholderTop = placeholderOffset.top,
                    placeholderLeft = placeholderOffset.left;

                // Retrieve co-ordinates and dimensions of card aperture
                var cardApertureOffset = jQuery(cardAperture).offset(),
                    cardApertureTop = cardApertureOffset.top,
                    cardApertureLeft = cardApertureOffset.left,
                    cardApertureWidth = jQuery(cardAperture).outerWidth(),
                    cardApertureHeight = jQuery(cardAperture).outerHeight();

                // Set relative co-ordinates
                var relativeTop = cardApertureTop - placeholderTop,
                    relativeLeft = cardApertureLeft - placeholderLeft;

                // Placing card
                jQuery(resourceSelection).removeClass('activeResource activeCard').addClass('inactiveResource speedX2');
                jQuery(resourceSelection).css({'top':relativeTop,'left':relativeLeft,'width':cardApertureWidth,'height':cardApertureHeight}); // in motion
                jQuery(resourceSelection).clone().appendTo(cardAperture).removeClass('speedX2').addClass('ghostCard'); // clone the modifeid card and add to in-play placeholder

                // Reset resource pool wealth
                resourceUpdatedCount = resourceCurrentCount -= resourceCurrency;

                setTimeout(function(){

                    jQuery(resourceSelection).remove();
                    jQuery('.inactiveResource').css({'top':'0','left':'0'}); // lock in position
                    jQuery('.inactiveResource').removeClass('inactiveResource ghostCard');
                    jQuery(cardAperture).removeClass('tetherCard open');
                    jQuery(cardAperture).addClass('closed valid-for-selection'); // restore former aperture classes
                    jQuery(resourceAperture).removeClass('placingCard poolingResource');

                    // Restore resource tag
                    resourceTagReference = jQuery(resourceSelection).attr('data-iteration');
                    jQuery('.display-resource-value[data-tag-iteration="'+resourceTagReference+'"]').addClass('activeResourceTag');

                    // Reset resource pool wealth
                    jQuery(resourceAperture).parent('.resource').find('.resource-counter').text(resourceUpdatedCount);
                    jQuery(resourceAperture).parent('.resource').find('.resource-counter').attr('data-pool-wealth',resourceUpdatedCount);

                    // Indicate inactive pool
                    if(jQuery(resourceAperture).parent('.resource').hasClass('activePool') && jQuery(resourceAperture).children().length <= 0) {
                        jQuery(resourceAperture).parent('.resource').removeClass('activePool');
                    }

                }, 200);

            }

            // Display resource value tags
            function displayResourceValueTags() {

                var resourceValue,
                    resourceDiscipline,
                    resourceDisciplineTag,
                    resourceTagIteration,
                    resourceValueTag = '<div class="display-resource-value"></div>';

                jQuery('[data-field="'+playerField+'"] .player-hand .valid-for-selection').each(function(i){

                    // Retrieve co-ordinates of card aperture
                    var cardApertureOffset = jQuery(this).offset(),
                        cardApertureWidth = jQuery(cardAperture).outerWidth() - 5,
                        cardApertureTop = cardApertureOffset.top - 5,
                        cardApertureLeft = cardApertureOffset.left + cardApertureWidth;

                    resourceValue = jQuery(this).find('.card-resource-currency').children().length;
                    resourceDiscipline = jQuery(this).find('.card-discipline').text();
                    resourceTagIteration = jQuery(this).find('.card').attr('data-iteration');

                    switch(resourceDiscipline) {
                        case 'aero':
                            resourceDisciplineTag = 'aero-tag';
                        break;
                        case 'terra':
                            resourceDisciplineTag = 'terra-tag';
                        break;
                        case 'hydro':
                            resourceDisciplineTag = 'hydro-tag';
                        break;
                        case 'pyro':
                            resourceDisciplineTag = 'pyro-tag';
                        break;
                    }

                    jQuery('[data-field="'+playerField+'"]').append(
                        jQuery(resourceValueTag).text(resourceValue)
                        .css({'left':cardApertureLeft,'top':cardApertureTop})
                        .addClass(resourceDisciplineTag)
                        .attr('data-tag-iteration',resourceTagIteration)
                    );

                });

                jQuery('.display-resource-value').addClass('activeResourceTag');

            }

            // Adjust tag positionings on window resize
            jQuery(window).on('resize',function(){

                jQuery('.display-resource-value').each(function(){

                    resourceTagReference = jQuery(this).attr('data-tag-iteration');

                    // Retrieve co-ordinates of card aperture
                    var cardApertureReference = jQuery('.card[data-iteration="'+resourceTagReference+'"]').parent('.valid-for-selection');
                        cardApertureOffset = jQuery(cardApertureReference).offset(),
                        cardApertureWidth = jQuery(cardAperture).outerWidth() - 5,
                        cardApertureTop = cardApertureOffset.top - 5,
                        cardApertureLeft = cardApertureOffset.left + cardApertureWidth;

                    jQuery(this).css({'left':cardApertureLeft,'top':cardApertureTop});

                });

            });

            // Remove resource value tags
            function removeResourceValueTags() {

                jQuery('.display-resource-value').removeClass('activeResourceTag');

                setTimeout(function(){
                    jQuery('.display-resource-value').remove();
                },500);

            }

            /*
            **
            ** Levelling Phase
            **
            */
            var rankPromotion = false;

            // Expedite levelling phase with support card
            // Return: Boolean
            function supportLevellingPossibility() {

                // Determine if levelling support card is available to play
                if(jQuery(playerHand).find('.player-hand .levelling-card-type').length) {
                	// TODO : enter support levelling phase and allow the opportunity to play the support card (even if it's ineffective, player still has opportunity to 'discard' the card in this way)
                	return true;

                } else {

                	return false;

                } 

            }

            // Determine rank promotion possibility
            // Return: Boolean
            function promoteRankPossibility() {

            	var checkCaster,
            		casterRank,
            		casterDiscipline,
            		levellingCost,
            		resourcePoolValue,
            		nextTier;

            	playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

            	checkCaster = jQuery('[data-battle-field="'+playerField+'"] .in-play').find('.cardFront');

            	// Determine rank of card in play
            	if(jQuery(checkCaster).hasClass('neophyte-ranking')) {

            		casterRank = 'neophyte';

            	} else if(jQuery(checkCaster).hasClass('proficient-ranking')) {

            		casterRank = 'proficient';

            	} else if(jQuery(checkCaster).hasClass('adept-ranking')) {

            		casterRank = 'adept';

            	} else if(jQuery(checkCaster).hasClass('elite-ranking')) {

            		casterRank = 'elite';

            	}

            	// Determine discipline of card in play
            	if(jQuery(checkCaster).hasClass('terra-motiv')) {

            		casterDiscipline = 'terra-motiv';

            	} else if(jQuery(checkCaster).hasClass('aero-motiv')) {

            		casterDiscipline = 'aero-motiv';

            	} else if(jQuery(checkCaster).hasClass('hydro-motiv')) {

            		casterDiscipline = 'hydro-motiv';

            	} else if(jQuery(checkCaster).hasClass('pyro-motiv')) {

            		casterDiscipline = 'pyro-motiv';

            	}

            	// Determine if valid higher tier is present and is of identical discipline
            	switch(casterRank) {

            		case 'neophyte':

            			nextTier = '.proficient-ranking';

            			if(	jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).length && 						// determine if a valid higher tier is present
            				jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).hasClass(casterDiscipline)) { 	// determine if same discipline is shared

            				// Determine if rank promotion is affordable
            				rankCostAffordability(nextTier,casterDiscipline);
            				if(rankPromotion) {
            					return true;
            				} else {
            					return false;
            				}

            			}

            		break;

            		case 'proficient':

            			nextTier = '.adept-ranking';

            			if(	jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).length && 						// determine if a valid higher tier is present
            				jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).hasClass(casterDiscipline)) { 	// determine if same discipline is shared

            				// Determine if rank promotion is affordable
            				rankCostAffordability(nextTier,casterDiscipline);
            				if(rankPromotion) {
            					return true;
            				} else {
            					return false;
            				}

            			}

            		break;

            		case 'adept':

            			nextTier = '.elite-ranking';

            			if(	jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).length && 						// determine if a valid higher tier is present
            				jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).hasClass(casterDiscipline)) { 	// determine if same discipline is shared

            				// Determine if rank promotion is affordable
            				rankCostAffordability(nextTier,casterDiscipline);
            				if(rankPromotion) {
            					return true;
            				} else {
            					return false;
            				}

            			}

            		break;

            		case 'elite':

            			nextTier = '.peerless-ranking';

            			if(	jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).length && 						// determine if a valid higher tier is present
            				jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).hasClass(casterDiscipline)) { 	// determine if same discipline is shared

            				// Determine if rank promotion is affordable
            				rankCostAffordability(nextTier,casterDiscipline);
            				if(rankPromotion) {
            					return true;
            				} else {
            					return false;
            				}

            			}

            		break;

            	}

            	// Determine if rank promotion is affordable
            	function rankCostAffordability(nextTier,rankingDiscipline) {

            		var resourceDiscipline;

            		switch(rankingDiscipline) {
            			case 'terra-motiv' :
            				resourceDiscipline = '.resource-terra';
            			break;
            			case 'aero-motiv' :
            				resourceDiscipline = '.resource-aero';
            			break;
            			case 'hydro-motiv' :
            				resourceDiscipline = '.resource-hydro';
            			break;
            			case 'pyro-motiv' :
            				resourceDiscipline = '.resource-pyro';
            			break;
            		}

            		// Iterate through all possible options
    				jQuery('[data-field="'+playerField+'"] .player-hand').find(nextTier).each(function(){

    					if(jQuery(this).hasClass(rankingDiscipline)) {

	    					// Retrieve valid higher tier levelling cost
	    					levellingCost = Number(jQuery(this).find('.levelling-cost').attr('data-levelling-cost'));

	    					// Retrieve resource pool value
	    					resourcePoolValue = Number(jQuery('[data-resource-field="'+playerField+'"] '+resourceDiscipline+' .resource-counter').attr('data-pool-wealth'));

	    					// Determine if resource pool value is greater than levelling cost
	    					if(resourcePoolValue >= levellingCost) {

	    						// Mark valid selection options
	    						jQuery(this).closest('.card-aperture').addClass('valid-for-selection emphasize-selection emphasize-promotion');

	    						// Possible to promote rank
	    						rankPromotion = true;

	    					}

	    				}

    				});

	                setTimeout(function(){
	                	jQuery('.valid-for-selection').removeClass('emphasize-selection');
	                },300);

            	}

            }

            /*
            **
            ** Support Phase
            **
            */

            function keySelectSupport() {

                if(supportSelectionPhase || supportLevellingPhase) {

                    cardAperture = jQuery('.valid-for-selection.focus');
                    jQuery(cardAperture).find('.card').addClass('supportSelection');

                    supportSelection = jQuery('.supportSelection');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    confirmSupportSelection(supportSelection, playerField, cardAperture);

                }

            }

            // Prompt player to confirm selection
            function confirmSupportSelection(resourceSelection, playerField, cardAperture) {

                // Move to resource pool
                placeInSupport(supportSelection, playerField, cardAperture);
                jQuery(cardAperture).removeClass('focus closed valid-for-selection').addClass('open');

                dialogueBoxContent =    `<div class="confirm-hand">
                                            Confirm Selection
                                            <div class="confirm-options">
                                                <div class="btn btn-confirm focus" data-confirm="true">Confirm</div>
                                                <div class="btn btn-confirm" data-confirm="false">Reject</div>
                                            </div>
                                        </div>`;

                if(jQuery('.dialogueBox .dialogueBox-body').children().length === 0) { // prevent additional prepending by excessive user input
                    jQuery('.dialogueBox .dialogueBox-body').prepend(dialogueBoxContent);
                }

                // call dialogue box
                toggleDialogueBox(false,true);

                if(previewSelectionPhase) {

	                previewSelectionPhase = false; // disallow UI key navigation
	            	formerPhase = 'previewSelectionPhase';

	            } else if(supportSelectionPhase) {

	                supportSelectionPhase = false; // disallow UI key navigation
	            	formerPhase = 'supportSelectionPhase';

	            } else if(supportLevellingPhase) {

	                supportLevellingPhase = false; // disallow UI key navigation
	            	formerPhase = 'supportLevellingPhase';

	            }
                supportConfirmationPhase = true; // allow key selection
                currentPhase = 'supportConfirmationPhase';

                // Update phase indicator
                updatePhaseIndicator();

            }

            // Determine resource confirmation
            function determineSupportConfirmation(confirmResource) {

                // continue based on condition returned
                if(confirmResource == 'true') { // player confirms resource

                    toggleDialogueBox(false,true);

                    jQuery('.card-aperture').removeClass('tetherCard'); // remove card tether reference
                    jQuery('.resource').removeClass('poolingResource'); // remove resource pool reference
                    jQuery('.resource-aperture').removeClass('activeResource'); // remove aperture reference

                    // Remove resource value tags
                    removeResourceValueTags();

                    supportConfirmationPhase = false; // disallow UI key navigation

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // TODO : invoke support card effect, determine if support card is effective
                    // Levelling: discard support card immediately after use (failure or success) if levelling support
                    // Battle: discard support card after battle phase is over and hitpoint recalculations have resolved

                } else if(confirmResource == 'false') { // player rescinds resource

                    toggleDialogueBox(false,true);

                    cardAperture = jQuery('.tetherCard');
                    resourceSelection = jQuery('.resource').find('.activeResource');
                    playerField = jQuery('.activeTurn').closest('.field').attr('data-field');

                    removeFromPool(resourceSelection, playerField, cardAperture);

                    supportConfirmationPhase = false; // disallow UI key navigation

                    // TODO : determine phase to revert to (support or levelling support)

                    resourcePoolingPhase = true; // start resource pooling phase and allow UI key navigation
                    formerPhase = 'resourceConfirmationPhase';
                    currentPhase = 'resourcePoolingPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                    // Update and display phase guide
                    guideInstruction = 'Select a valid support levelling card to place in play';
                    updatePhaseGuide(guideInstruction,currentPhase);

                    // Unmark valid selection options
                    unmarkValidSelections();

                    // Mark valid selection options
                    markValidSelections('caster-card-type');

                }

            }

            /*
            **
            ** Resource transactions
            **
            */
            var cardCost,							// cost of support or levelling action
            	cardCurrency,						// card resource currency determined by discipline type
            	cardResource,						// card resource value
            	cardResourceAdjusted, 				// adjusted resource of the card, used to determine remaining resource after deductions
            	resourcePoolTotal,					// total pool wealth 
            	resourcePoolAdjusted,				// adjusted resource pool total
            	resourcePoolArray,					// array of all pool totals, used when no specific currency is required
            	resourcePoolMax,					// maximum total extracted from resource pool array, used to find the resource pool with the highest balance to debit from
            	resourceAdjustmentIteration = 0;	// iteration counter for visual adjustments to pool totals

            // Calculate and debit resource transactions for support and levelling costs
            function resourceTransaction() {

            	if(levellingPhase) {

            		// Determine cardCurrency by discipline type of caster card
	            	if(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .cardFront').hasClass('areo-motiv')) {

	            		cardCurrency = '.resource-aero';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .cardFront').hasClass('terra-motiv')) {

	            		cardCurrency = '.resource-terra';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .cardFront').hasClass('hydro-motiv')) {

	            		cardCurrency = '.resource-hydro';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .cardFront').hasClass('pyro-motiv')) {

	            		cardCurrency = '.resource-pyro';

	            	}

	            	cardCost = Number(jQuery('[data-battle-field="'+playerField+'"]').find('.in-play .card .levelling-cost').attr('data-levelling-cost'));

	            } else if(supportLevellingPhase || supportSelectionPhase) {

	            	// Determine cardCurrency by discipline type of support card if applicable
	            	if(jQuery('[data-battle-field="'+playerField+'"]').find('.support-card-component .cardFront').hasClass('areo-motiv')) {

	            		cardCurrency = '.resource-aero';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.support-card-component .cardFront').hasClass('terra-motiv')) {

	            		cardCurrency = '.resource-terra';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.support-card-component .cardFront').hasClass('hydro-motiv')) {

	            		cardCurrency = '.resource-hydro';

	            	} else if(jQuery('[data-battle-field="'+playerField+'"]').find('.support-card-component .cardFront').hasClass('pyro-motiv')) {

	            		cardCurrency = '.resource-pyro';

	            	} else {

	            		cardCurrency = false;
					
					}

	            	cardCost = Number(jQuery('[data-battle-field="'+playerField+'"]').find('.support-card-component .card .resource-cost').attr('data-resource-cost'));

	            }

	            if(!cardCurrency) {

            		resourcePoolTotal = Number(jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').attr('data-pool-wealth'));

            		resourcePoolAdjusted = resourcePoolTotal - cardCost;

            		// Update resource reserves
            		jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').attr('data-pool-wealth',resourcePoolAdjusted);

            		// Visually adjust the resource counter
            		// Timed loop: deduct x1 resource point for the limit defined
                    var intervalID = setInterval(function(){

                       if(resourceAdjustmentIteration === cardCost) { // clear interval when iteration limit is reached
                          
                          clearInterval(intervalID);

                          // Manage active resource pools
                          manageResourcePools(cardCurrency,cardCost,resourcePoolTotal);

                       }

                       var timeoutID = setTimeout(function(){ 

                            jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').text(resourcePoolTotal);
                            resourcePoolTotal-=1;

                       }, 100);

                       resourceAdjustmentIteration++;

                    }, 100);

            	} else { // cardCurrency is false, find the resource pool with the largest sum of wealth for debit

            		deductFromHighestResource();

            		// Visually adjust the resource counter
            		// Timed loop: deduct x1 resource point for the limit defined
                    var intervalID = setInterval(function(){

                       if(resourceAdjustmentIteration === cardCost || resourceAdjustmentIteration === resourcePoolTotal) { // clear interval when iteration limit is reached
                          
	                      clearInterval(intervalID);

	                      // Manage active resource pools
	                      manageResourcePools(cardCurrency,cardCost,resourcePoolTotal);

	                      // Determine if balance still needs to be settled
	                      if(cardCost > 0) {

	                      	// Proceed to next resource pool
	                      	deductFromHighestResource();

	                      }

                       }

                       var timeoutID = setTimeout(function(){ 

                            jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').text(resourcePoolTotal);
                            resourcePoolTotal-=1;

                       }, 100);

                       resourceAdjustmentIteration++;

                    }, 100);

            	}

            	// Manage active resource pools
        		function manageResourcePools(currency,cost,poolTotal) {

        			// Discard spent card/resource
        			jQuery('[data-resource-field="'+playerField+'"] '+currency+' .card').each(function(){

        				if(cost > 0) { // continue until total cost has been deducted

        					// Determine if resource has already been reduced
        					if(jQuery(this).is('[data-resource-remaining]')) {
        						cardResource = jQuery(this).attr('data-resource-remaining');
        					} else {
        						cardResource = jQuery(this).attr('data-resource-currency');
        					}

        					// Check cards in pool
	        				if(cardResource <= cost || poolTotal == cost) { // determine if card resource is less than cost or if the remaining pool total equals cost

	        					jQuery(this).addClass('discardCard');

	        					console.log('card should be discarded');

	        					// Discard card
	        					discardCard();

	        					// Update remaining cost for following iteration
	        					cost -= cardResource;

	        				} else if(cardResource > cost) { // resource is greater than remaining cost, reference remaining resource for future deductions

	        					cardResourceAdjusted = cardResource - cost;

	        					// Account for remaining resource after cost deduction
	        					jQuery(this).attr('data-resource-remaining',cardResourceAdjusted);

	        				}

	        			} else {
        					return;
        				}

        			});

        			// Manage active resource pools
        			jQuery('[data-resource-field="'+playerField+'"]').find('.activeResource').each(function(){

        				// Remove active class if resource pool is empty
            			if(jQuery(this).children().length <= 0 && jQuery(this).find('.resource-counter').attr('data-pool-wealth') <= 0) {

            				jQuery(this).removeClass('activeResource');

            			}

        			});

        		}

        		// Find resource pool with highest value for cost deductions
        		function deductFromHighestResource() {

            		resourcePoolTotal = [];

            		// Push all values from active resource pools to array
            		jQuery('[data-resource-field="'+playerField+'"] .activePool').each(function(){

            			resourcePoolArray.push(Number(jQuery(this).find('.resource-counter').attr('data-pool-wealth')));

            			console.log(resourcePoolArray);

            		});

            		Array.max = function( array ){
					    return Math.max.apply( Math, array );
					};

					// Retrieve the highest value from array
					resourcePoolMax = Array.max(resourcePoolArray);

					// Retrieve resource pool with matching max value from array and start from there
            		jQuery('[data-resource-field="'+playerField+'"] .activePool').each(function(){

            			if(jQuery(this).find('.resource-counter').attr('data-pool-wealth') == resourcePoolMax) {

		            		// Determine cardCurrency by currency of resource card
			            	if(jQuery(this).hasClass('areo-motiv')) {

			            		cardCurrency = '.resource-aero';

			            	} else if(jQuery(this).hasClass('terra-motiv')) {

			            		cardCurrency = '.resource-terra';

			            	} else if(jQuery(this).hasClass('hydro-motiv')) {

			            		cardCurrency = '.resource-hydro';

			            	} else if(jQuery(this).hasClass('pyro-motiv')) {

			            		cardCurrency = '.resource-pyro';

			            	}

            			}

            		});

            		resourcePoolTotal = Number(jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').attr('data-pool-wealth'));

            		resourcePoolAdjusted = resourcePoolTotal - cardCost;

            		if(resourcePoolAdjusted < 0) {

            			// Adjust cardCost to account for resource deduction
            			cardCost *= resourcePoolAdjusted; // expecting negative value for resourcePoolAdjusted
            			resourcePoolAdjusted = 0;

            		}
            					
            		// Update resource reserves
            		jQuery('[data-resource-field="'+playerField+'"] '+cardCurrency).find('.resource-counter').attr('data-pool-wealth',resourcePoolAdjusted);

            	}

            	// TODO : calculate and debit resource transactions for support and levelling costs

            }

            /*
            **
            ** Browse & Preview Phase
            **
            */
            var browsingSelection,
                playerHandSource,
                previewPane,
                previewForce,
                previewNerf,
                previewDiscipline,
                previewDescription,
                previewAppellation,
                previewResourceCurrency,
                previewResourceCurrencyHTML,
                previewResourceCost,
                previewResourceCostHTML,
                previewLevellingCost,
                previewLevellingCostHTML,
                previewSupport,
                previewRank;

            function browseAndPreview() {

                jQuery('.preview-pane-component').removeClass('inView');
                jQuery('.preview-pane-component .preview-pane-card').children('.card-aperture').remove();

                playerHandSource = jQuery('.player-hand .focus').parents('.field').attr('data-field'),
                previewPane = jQuery('.field[data-field="'+playerHandSource+'"]').find('.preview-pane-component');

                if (currentPhase != 'previewSelectionPhase') {

                	if(handBrowsingPhase) {

	                    handBrowsingPhase = false;
	                    formerPhase = 'handBrowsingPhase';

	                } else if(casterSelectionPhase) {

	                    casterSelectionPhase = false;
	                    formerPhase = 'casterSelectionPhase';

	                } else if(supportLevellingPhase) {

	                    supportLevellingPhase = false;
	                    formerPhase = 'supportLevellingPhase';

	                } else if(levellingPhase) {

	                    levellingPhase = false;
	                    formerPhase = 'levellingPhase';

	                } else if(supportSelectionPhase) {

	                    supportSelectionPhase = false;
	                    formerPhase = 'supportSelectionPhase';

	                }
                    previewSelectionPhase = true;
                    currentPhase = 'previewSelectionPhase';

                    // Update phase indicator
                    updatePhaseIndicator();

                }

                // Display preview pane
                if(!jQuery(previewPane).hasClass('inView')) {
                    jQuery(previewPane).addClass('inView');
                }

                // Append card to preview pane
                browsingSelection = jQuery('.field[data-field="'+playerHandSource+'"]').find('.focus.closed').clone().removeClass('focus closed').appendTo('.inView .preview-pane-card');

                // Reset preview stats
                jQuery('.preview-pane-stats').children().remove();
                jQuery('.preview-pane-stats').removeClass(function (index, className) {
                    return (className.match (/(^|\s)stat-discipline-\S+/g) || []).join(' ');
                });

                // Prepare preview stats
                previewRank = jQuery(browsingSelection).find('.card-ranking').children().length;
                previewDiscipline = jQuery(browsingSelection).find('.card-discipline').text();

                if(jQuery(browsingSelection).find('.cardFront').hasClass('caster-card-type')) {

                    if(jQuery(browsingSelection).find('.card-force-nerfed').length) {
                        previewForce = jQuery(browsingSelection).find('.card-force span').text();
                        previewNerf = jQuery(browsingSelection).find('.card-marker span').text();
                        previewForce = '<span>'+previewForce+' (-'+previewNerf+')<i class="fas fa-asterisk"></i></span><br><small><i class="fas fa-asterisk"></i>Summoning Malady</small>';
                    } else {
                        previewForce = jQuery(browsingSelection).find('.card-force').text();
                    }

                    previewResourceCurrency = jQuery(browsingSelection).find('.card-resource-currency').children().length;
                    previewResourceCurrencyHTML = jQuery(browsingSelection).find('.card-resource-currency').html();

                    if(!jQuery(browsingSelection).find('.cardFront').hasClass('neophyte-ranking')) {
	                    previewLevellingCost = jQuery(browsingSelection).find('.levelling-cost').attr('data-levelling-cost');
	                    previewLevellingCostHTML = jQuery(browsingSelection).find('.levelling-cost').html();
	                }

                }

                if(jQuery(browsingSelection).find('.cardFront').hasClass('support-card-type')) {

                    previewAppellation = jQuery(browsingSelection).find('.support-title').text();
                    previewDescription = jQuery(browsingSelection).find('.support-description').html();
                    previewResourceCost = jQuery(browsingSelection).find('.resource-cost').attr('data-resource-cost');
                    previewResourceCostHTML = jQuery(browsingSelection).find('.resource-cost').html();

                }

                // Set preview stats
                if(jQuery(browsingSelection).find('.cardFront').hasClass('caster-card-type')) {

                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-force">
                                                                <div class="stat-title">Force:</div>
                                                                <div class="stat-value">${previewForce}</div>
                                                            </div>`);

                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-resource-currency">
                                                                <div class="stat-title">Reource Value:</div>
                                                                <div class="stat-value">+${previewResourceCurrency}${previewResourceCurrencyHTML}</div>
                                                            </div>`);

                    if(!jQuery(browsingSelection).find('.cardFront').hasClass('neophyte-ranking')) {

	                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-resource-cost">
	                                                                <div class="stat-title">Levelling Cost:</div>
	                                                                <div class="stat-value">${previewLevellingCost}${previewLevellingCostHTML}</div>
	                                                            </div>`);
	                    
	                }

                } else if(jQuery(browsingSelection).find('.cardFront').hasClass('support-card-type')) {

                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-description">
                                                                <div class="stat-title">Description:</div>
                                                                <div class="stat-value">${previewDescription}</div>
                                                            </div>`);

                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-appellation">
                                                                <div class="stat-title">Title:</div>
                                                                <div class="stat-value">${previewAppellation}</div>
                                                            </div>`);

                    jQuery('.preview-pane-stats').prepend(  `<div class="stat-resource-cost">
                                                                <div class="stat-title">Resource Cost:</div>
                                                                <div class="stat-value">${previewResourceCost}${previewResourceCostHTML}</div>
                                                            </div>`);

                }

                switch(previewDiscipline) {

                    case 'aero' :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-discipline">
                                                                    <div class="stat-title">Discipline:</div>
                                                                    <div class="stat-value"><i class="fas fa-cloud"></i> Aerolurgy</div>
                                                                </div>`);

                        // Handle classes
                        jQuery('.preview-pane-stats').removeClass(function (index, className) {
                            return (className.match (/(^|\s)stat-discipline-\S+/g) || []).join(' ');
                        });
                        jQuery('.preview-pane-stats').addClass('stat-discipline-aero');
                    break;

                    case 'terra' :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-discipline">
                                                                    <div class="stat-title">Discipline:</div>
                                                                    <div class="stat-value"><i class="fas fa-leaf"></i> Terralurgy</div>
                                                                </div>`);

                        // Handle classes
                        jQuery('.preview-pane-stats').removeClass(function (index, className) {
                            return (className.match (/(^|\s)stat-discipline-\S+/g) || []).join(' ');
                        });
                        jQuery('.preview-pane-stats').addClass('stat-discipline-terra');
                    break;

                    case 'pyro' :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-discipline">
                                                                    <div class="stat-title">Discipline:</div>
                                                                    <div class="stat-value"><i class="fas fa-burn"></i> Pyrolurgy</div>
                                                                </div>`);

                        // Handle classes
                        jQuery('.preview-pane-stats').removeClass(function (index, className) {
                            return (className.match (/(^|\s)stat-discipline-\S+/g) || []).join(' ');
                        });
                        jQuery('.preview-pane-stats').addClass('stat-discipline-pyro');
                    break;

                    case 'hydro' :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-discipline">
                                                                    <div class="stat-title">Discipline:</div>
                                                                    <div class="stat-value"><i class="fas fa-tint"></i> Hydrolurgy</div>
                                                                </div>`);

                        // Handle classes
                        jQuery('.preview-pane-stats').removeClass(function (index, className) {
                            return (className.match (/(^|\s)stat-discipline-\S+/g) || []).join(' ');
                        });
                        jQuery('.preview-pane-stats').addClass('stat-discipline-hydro');
                    break;

                }

                switch(previewRank) {

                    case 0 :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-rank">
                                                                    <div class="stat-title">Ranking:</div>
                                                                    <div class="stat-value">Neophyte</div>
                                                                </div>`);
                    break;

                    case 1 :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-rank">
                                                                    <div class="stat-title">Ranking:</div>
                                                                    <div class="stat-value">Proficient</div>
                                                                </div>`);
                    break;

                    case 2 :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-rank">
                                                                    <div class="stat-title">Ranking:</div>
                                                                    <div class="stat-value">Adept</div>
                                                                </div>`);
                    break;

                    case 3 :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-rank">
                                                                    <div class="stat-title">Ranking:</div>
                                                                    <div class="stat-value">Elite</div>
                                                                </div>`);
                    break;

                    case 4 :
                        jQuery('.preview-pane-stats').prepend(  `<div class="stat-rank">
                                                                    <div class="stat-title">Ranking:</div>
                                                                    <div class="stat-value">Peerless</div>
                                                                </div>`);
                    break;

                }

            }

            /*
            **
            ** Browse Hand Phase
            **
            */

            // Select with mouse
            jQuery('.player-hand').on('mouseover','.focus.closed',function() {

                if(!jQuery('.preview-pane-component').hasClass('preview-pane-delay') && 
                	handBrowsingPhase || 
                	previewSelectionPhase || 
                	casterSelectionPhase || 
                	levellingPhase || 
                	supportLevellingPhase || 
                	supportSelectionPhase) {

                    browseAndPreview();

                }

            });

            // Select with mouse
            jQuery('.player-hand').on('click','.focus.closed',function() {

                if(!jQuery('.preview-pane-component').hasClass('preview-pane-delay') && handBrowsingPhase) {

                    browseAndPreview();

                } else if(previewSelectionPhase || casterSelectionPhase) {

                    keySelectCaster();

                } else if(previewSelectionPhase || supportLevellingPhase) {

                    keySelectSupport();

                } else if(previewSelectionPhase || levellingPhase) {

                    keySelectCaster();

                } else if(previewSelectionPhase || supportSelectionPhase) {

                    keySelectSupport();

                }

            });

            // Select with keys
            function keyViewSelection() {

                if(!jQuery('.preview-pane-component').hasClass('preview-pane-delay') && 
                	handBrowsingPhase || 
                	previewSelectionPhase || 
                	casterSelectionPhase|| 
                	levellingPhase || 
                	supportLevellingPhase || 
                	supportSelectionPhase) {

                    browseAndPreview();

                }

            }

            /*
            **
            ** Preview Selection Phase
            **
            */

            // Dismiss with mouse
            jQuery('.field').on('click','.preview-pane-dismiss',function() {

                previewSelectionPhase = false;
                if(jQuery('.minimized-dialogueBox').length) { // if dialogue box is still docked, player has not officially accepted hand

                    handBrowsingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'handBrowsingPhase';
                    
                    // Maximize docked dialogue box
                    jQuery('.minimized-dialogueBox .dialogueBox-maximize').trigger('click');

                } else if(formerPhase == 'casterSelectionPhase') { 
                	// ...else player has implicitly accepted hand by previous attempt at placing card into play

                    casterSelectionPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'casterSelectionPhase';

                } else if(formerPhase == 'supportLevellingPhase') { 

                    supportLevellingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'supportLevellingPhase';

                } else if(formerPhase == 'levellingPhase') { 

                    levellingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'levellingPhase';

                } else if(formerPhase == 'supportSelectionPhase') { 

                    supportSelectionPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'supportSelectionPhase';

                }

                // Update phase indicator
                updatePhaseIndicator();

                // Dismiss preview pane
                jQuery('.preview-pane-component').removeClass('inView').addClass('preview-pane-delay');

                // Remove delay
                setTimeout(function(){
                    jQuery('.preview-pane-component').removeClass('preview-pane-delay')
                },1000);

            });

            // Dismiss with keys
            function keyDismissPreview() {

                previewSelectionPhase = false;
                if(jQuery('.minimized-dialogueBox').length) { 
                	// if dialogue box is still docked, player has not officially accepted hand...

                    handBrowsingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'handBrowsingPhase';

                    // Maximize docked dialogue box
                    jQuery('.minimized-dialogueBox .dialogueBox-maximize').trigger('click');

                } else if(formerPhase == 'casterSelectionPhase') { 
                	// ...else player has implicitly accepted hand by previous attempt at placing card into play

                    casterSelectionPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'casterSelectionPhase';

                } else if(formerPhase == 'supportLevellingPhase') { 

                    supportLevellingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'supportLevellingPhase';

                } else if(formerPhase == 'levellingPhase') { 

                    levellingPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'levellingPhase';

                } else if(formerPhase == 'supportSelectionPhase') { 

                    supportSelectionPhase = true;
                    formerPhase = 'previewSelectionPhase';
                    currentPhase = 'supportSelectionPhase';

                }

                // Update phase indicator
                updatePhaseIndicator();

                // Dismiss preview pane
                jQuery('.preview-pane-component').removeClass('inView').addClass('preview-pane-delay');

                // Remove delay
                setTimeout(function(){
                    jQuery('.preview-pane-component').removeClass('preview-pane-delay')
                },1000);

            }

            /*
            **
            ** Ignore Key Input
            **
            */
            function keyVoid() {
                return
            }

            /*
            **
            ** Navigating Elements
            **
            */
            var keyReleased = false,
                keyPressed = true;

            function keyNavigation() {

                jQuery(document).on('keyup',function(e) {

                    keyReleased = true;

                });

                jQuery(document).on('keydown',function(e) {

                    if(keyReleased) {
                        keyPressed = true;
                    }

                    if(keyPressed) {

                        keyPressed = false;

                        var key = e.key;

                        if (turnSelectionPhase) {

                            var elClass             = '.turnCard',
                                parentEl            = '.turnCard-selection',
                                callbackFunction    = keyTurnSelect,
                                returnFunction      = keyVoid,
                                applicableEl        = '.turnCard',
                                notApplicableEl     = '';

                        } else if (casterSelectionPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectCaster,
                                returnFunction      = keyVoid,
                                applicableEl        = '.valid-for-selection',
                                notApplicableEl     = '.invalid-for-selection, .open';

                        } else if (resourcePoolingPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectResource,
                                returnFunction      = keyVoid,
                                applicableEl        = '.valid-for-selection',
                                notApplicableEl     = '.invalid-for-selection, .open';

                        } else if (supportLevellingPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectSupport,
                                returnFunction      = keyVoid,
                                applicableEl        = '.valid-for-selection',
                                notApplicableEl     = '.invalid-for-selection, .open';

                        } else if (levellingPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectCaster,
                                returnFunction      = keyVoid,
                                applicableEl        = '.valid-for-selection',
                                notApplicableEl     = '.invalid-for-selection, .open';

                        } else if (supportSelectionPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectSupport,
                                returnFunction      = keyVoid,
                                applicableEl        = '.valid-for-selection',
                                notApplicableEl     = '.invalid-for-selection, .open';

                        } else if (handConfirmationPhase) {

                            var elClass             = '.btn',
                                parentEl            = '.confirm-options',
                                callbackFunction    = keyConfirmation,
                                returnFunction      = toggleDockDialogueBox,
                                applicableEl        = '.btn-confirm',
                                notApplicableEl     = '';

                        } else if (handBrowsingPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectCaster,
                                returnFunction      = toggleDockDialogueBox,
                                applicableEl        = '.closed',
                                notApplicableEl     = '.open';

                        } else if (previewSelectionPhase) {

                            var elClass             = '.card-aperture',
                                parentEl            = '.player-hand',
                                callbackFunction    = keySelectCaster,
                                returnFunction      = keyDismissPreview,
                                applicableEl        = '.closed',
                                notApplicableEl     = '.open';

                        } else if (casterConfirmationPhase) {

                            var elClass             = '.btn',
                                parentEl            = '.confirm-options',
                                callbackFunction    = keyConfirmation,
                                returnFunction      = toggleDialogueBox,
                                applicableEl        = '.btn-confirm',
                                notApplicableEl     = '';

                        } else if (resourceConfirmationPhase) {

                            var elClass             = '.btn',
                                parentEl            = '.confirm-options',
                                callbackFunction    = keyConfirmation,
                                returnFunction      = toggleDialogueBox,
                                applicableEl        = '.btn-confirm',
                                notApplicableEl     = '';

                        }

                        if(jQuery(parentEl).find(applicableEl).hasClass('focus')) {

                            agentFocus(key,elClass,parentEl,callbackFunction,returnFunction,applicableEl,notApplicableEl);

                        } else {

                            agentFocus(key,elClass,parentEl,callbackFunction,returnFunction,applicableEl,notApplicableEl);

                        }

                    }

                });

            }

            /*
            **
            ** Key Input Navigation
            **
            */
            function agentFocus(key,el,parent,callbackFunction,returnFunction,applicable,notApplicable) {

                var focusEl = jQuery(el+'.focus');

                function arrowRightUp() {

                    // are there more than one element in the set that can be focussed on?
                    if (jQuery(applicable).length > 1) {

                        if (
                            // is there an element following the current element?
                            jQuery(focusEl).next().length 
                            // and is it one that can be focussed on?
                            &&  jQuery(focusEl).next().is(applicable) 
                            || // OR
                            // is there an element following the current element?
                            jQuery(focusEl).next().length 
                            // and is it one that cannot be focussed on?
                            &&  jQuery(focusEl).next().is(notApplicable)
                            // and is it not the last element in the set? 
                            &&  jQuery(focusEl).next().is(':not(:last-child)')
                            ) {

                            // determine if there are any applicable elements following the current focussed element
                            if (jQuery(focusEl).nextAll(applicable).length) {
                                jQuery(focusEl).removeClass('focus').nextAll(applicable).first().addClass('focus'); // check all and apply class to first applicable element
                            } else {
                                jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                                jQuery(parent).children(applicable).first().addClass('focus'); // reset focus on first applicable element of the containing element
                            }

                        } else if (
                            // is there an element following the current element?
                            jQuery(focusEl).next().length 
                            // and is it one that cannot be focussed on?
                            &&  jQuery(focusEl).next().is(notApplicable) 
                             // and is it the last element in the set? 
                            &&  jQuery(focusEl).next().is(':last-child')
                            ) {

                            jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                            jQuery(applicable).first().addClass('focus'); // reset focus on the first element that can be focussed on (the first applicable element)

                        } else {

                            // otherwise just reset the focus
                            jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                            jQuery(parent).children(applicable).first().addClass('focus'); // reset focus on first applicable element of the containing element

                        }

                    } else { // is it the only applicable element left in the set that can be focussed on?

                        // is the last applicable element left not already focussed on?
                        if (!jQuery(parent).children(applicable).first().hasClass('focus')) {
                            jQuery(parent).children(applicable).first().addClass('focus');
                        }

                    }
                    
                }

                function arrowLeftDown() {

                    // are there more than one element in the set that can be focussed on?
                    if (jQuery(applicable).length > 1) {

                        if(
                            // is there an element preceding the current element?
                            jQuery(focusEl).prev().length 
                            // and is it one that can be focussed on?
                            &&  jQuery(focusEl).prev().is(applicable) 
                            || // OR
                            // is there an element preceding the current element?
                            jQuery(focusEl).prev().length 
                            // and is it one that cannot be focussed on?
                            &&  jQuery(focusEl).prev().is(notApplicable)
                            // and is it not the first element in the set? 
                            &&  jQuery(focusEl).prev().is(':not(:first-child)')
                            ) {

                            // determine if there are any applicable elements preceding the current focussed element
                            if(jQuery(focusEl).prevAll(applicable).length) {
                                jQuery(focusEl).removeClass('focus').prevAll(applicable).first().addClass('focus'); // check all and apply class to first applicable element
                            } else {
                                jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                                jQuery(parent).children(applicable).last().addClass('focus'); // reset focus on last applicable element of the containing element
                            }

                        } else if (
                            // is there an element preceding the current element?
                            jQuery(focusEl).prev().length 
                            // and is it one that cannot be focussed on?
                            &&  jQuery(focusEl).prev().is(notApplicable) 
                             // and is it the first element in the set? 
                            &&  jQuery(focusEl).prev().is(':first-child')
                            ) {

                            jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                            jQuery(applicable).last().addClass('focus'); // reset focus on the last element that can be focussed on (the last applicable element)

                        } else {

                            // otherwise just reset the focus
                            jQuery(focusEl).removeClass('focus'); // remove class from current focus element
                            jQuery(parent).children(applicable).last().addClass('focus'); // reset focus on last applicable element of the containing element

                        }

                    } else { // is it the only applicable element left in the set that can be focussed on?

                        // is the last applicable element left not already focussed on?
                        if (!jQuery(parent).children(applicable).first().hasClass('focus')) {
                            jQuery(parent).children(applicable).first().addClass('focus');
                        }

                    }
                    
                }

                function switchHands(key) {

                    var current_field = jQuery('.focus').parents('.field').attr('data-field');
                    jQuery(applicable).removeClass('focus');

                    if(key == 'ArrowUp') {

                        if(jQuery('.field[data-field!="'+current_field+'"]').find(applicable).length) {    
                            jQuery('.field[data-field!="'+current_field+'"]').find(applicable).first().addClass('focus');
                        } else {
                            arrowRightUp();
                        }


                    } else if(key == 'ArrowDown') {

                        if(jQuery('.field[data-field!="'+current_field+'"]').find(applicable).length) { 
                            jQuery('.field[data-field!="'+current_field+'"]').find(applicable).last().addClass('focus');
                        } else {
                            arrowLeftDown();
                        }

                    }

                }

                switch(key) {

                    case 'ArrowRight':
                        arrowRightUp();

                        // Display preview selection
                        if(handBrowsingPhase || previewSelectionPhase || casterSelectionPhase || levellingPhase || supportLevellingPhase || supportSelectionPhase) {
                            keyViewSelection();
                        }

                    break;

                    case 'ArrowLeft':
                        arrowLeftDown();

                        // Display preview selection
                        if(handBrowsingPhase || previewSelectionPhase || casterSelectionPhase || levellingPhase || supportLevellingPhase || supportSelectionPhase) {
                            keyViewSelection();
                        }

                    break;

                    case 'ArrowUp':
                        if(handBrowsingPhase || previewSelectionPhase || casterSelectionPhase || levellingPhase || supportLevellingPhase || supportSelectionPhase) {
                            switchHands(key);

                            // Display preview selection
                            keyViewSelection();

                        } else {
                            arrowRightUp();
                        }
                    break;

                    case 'ArrowDown':
                        if(handBrowsingPhase || previewSelectionPhase || casterSelectionPhase || levellingPhase || supportLevellingPhase || supportSelectionPhase) {
                            switchHands(key);

                            // Display preview selection
                            keyViewSelection();

                        } else {
                            arrowLeftDown();
                        }
                    break;

                    case 'Enter':
                        callbackFunction();
                    break;

                    case 'Escape':
                        returnFunction();
                    break;

                }

            };
        </script>
        <style>
            * {
                box-sizing: border-box;
                font-family: arial;
            }
            body {
                margin: auto;
            }
            hr {
                color: #404040;
                border-style: solid;
            }
            .wrapper {
                background: #504f4f;
            }
            /* || States */
            .idleCard {
                transform: rotate(90deg) translateY(-20px) translateX(-20px) scaleX(1);
                top: 0;
                left: 0;
            }
            .activeCard {
                position: absolute;
                transform: rotate(0deg) translateY(0px) translateX(0px) scaleX(1);
                z-index: 2;
            }
            .ghostCard {
                display: none;
            }
            .facedownCard {
                transform: rotate(0deg) translateY(0px) translateX(0px) scaleX(1);
            }
            .flippedCard {
                transform: rotate(0deg) translateY(0px) translateX(0px) scaleX(-1);
            }
            .placingCard.open,
            .placingCard.closed,
            .placingCard.in-play {
                z-index: 9;
            }
            .ghostEl {
            	opacity: 0;
            }
            /* || Cards */
            .card {
                background: #504f4f;
                transition: .5s;
                z-index: 1;
                position: absolute;
            }
            .card-force,
            .card-support {
                position: absolute;
                display: block;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                font-size: 30px;
                margin: auto;
                border-radius: 100%;
                background: #404040;
                text-align: center;
                line-height: 90px;
                color: #b3b3b3;
            }
            .card-force {
                width: 90px;
                height: 90px;
            }
            .card-force strike {
                font-size: 20px;
                display: block;
                position: absolute;
                text-align: center;
                left: 0;
                right: 0;
                bottom: 25px;
                opacity: .5;
                text-decoration: none;
                width: 30px;
                margin: auto;
            }
            .card-force-nerfed,
            .card-force-nerf,
            .card-force-fraction-deduction {
                transition: .2s;
            }
            .card-force-nerf:not(.ghostEl),
            .card-force-fraction-deduction:not(.ghostEl) {
                opacity: 1;
            }
            .card-force-nerfed strike:before {
                position: absolute;
                content: "";
                left: 0;
                top: 50%;
                right: 0;
                border-top: 1px solid;
                border-color: inherit;
                -webkit-transform:rotate(-5deg);
                -moz-transform:rotate(-5deg);
                -ms-transform:rotate(-5deg);
                -o-transform:rotate(-5deg);
                transform: rotate(-30deg);
            }
            .card-force-nerfed span .fas {
                position: absolute;
                line-height: 90px;
            }
            .card-support {
                width: 102px;
                height: 102px;
            }
            .card-force-indicator {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                margin: auto;
                width: 102px;
                height: 102px;
                border: 1px solid #404040;
                border-radius: 100%;
            }
            .card-force-indicator div {
                position: absolute;
                width: 1px;
                height: 10px;
            }
            .elite-force-indicator {
                background: gold;
                transform: rotate(140deg);
                top: 5px;
                left: 20px;
            }
            .adept-force-indicator {
                background: silver;
                transform: rotate(110deg);
                top: 30px;
                left: 2px;
            }
            .proficient-force-indicator {
                background: #cd7f32;
                transform: rotate(70deg);
                bottom: 30px;
                left: 2px;
            }
            .card-force-indicator circle {
                fill: #504f4f;
                stroke-width: 32;
                transition: .5s;
            }
            .aero-motiv .card-force-indicator circle {
                stroke: #f1c40f;
            }
            .terra-motiv .card-force-indicator circle {
                stroke: #27ae60;
            }
            .pyro-motiv .card-force-indicator circle {
                stroke: #c0392b;
            }
            .hydro-motiv .card-force-indicator circle {
                stroke: #3498db;
            }
            .card-force-indicator svg {
                width: 100px;
                height: 100px;
                transform: rotate(-90deg);
                background: #504f4f;
                border-radius: 50%;
            }
            .card-force-indicator svg:after {
                content: "";
                width: 2px;
                height: 10px;
                background: black;
                position: absolute;
                display: block;
            }
            .card-force-indicator svg.natural-force {
			    position: absolute;
			}
			.card-force-indicator svg.natural-force circle {
			    stroke: #787878;
			}
			.card-force-indicator svg.natural-force + svg {
			    background: transparent;
			}
			.card-force-indicator svg.natural-force + svg circle {
			    fill: transparent;
			}
            .card-type {
                color: #404040;
                position: absolute;
                bottom: 5px;
                left: 0;
                right: 0;
                text-transform: uppercase;
                font-size: 12px;
            }
            .support-title,
            .support-description, 
            .support-efficacy {
                display: none;
            }
            .support-type {
                text-transform: uppercase;
                font-size: 15px;
                position: absolute;
                left: 0;
                right: 0;
                text-align: center;
                top: 0;
                bottom: 0;
                height: 0;
                margin: auto;
            }
            .card-support-motiv .fas:nth-child(2) {
                position: absolute;
                font-size: 20px;
                top: 0;
                bottom: 0;
                right: 25px;
                height: 50px;
                margin: auto;
                display: block;
            }
            .card-support-motiv .fas:nth-child(1) {
                color: #7d7d7d;
                font-size: 40px;
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                height: 40px;
                margin: auto;
            }
            .support-levelling-effect .fas:nth-child(2) {
			    font-size: 40px;
			    right: -15px;
			    left: 0;
			    top: 3px;
			}
			.support-levelling-effect .fas:nth-child(1) {
			    transform: scaleX(-1);
			    left: -15px;
			    right: 0;
			    bottom: 3px;
			}
            .card-support-motiv {
                position: relative;
                text-align: center;
                height: 100%;
            }
            .cardBack {
                border: 3px solid #404040;
                position: absolute;
                top: 0;
                bottom: 0;
                right: 0;
                left: 0;
                border-radius: 5px;
            }
            .cardBack div {
                transition: .5s;
            }
            .cardFront {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                border: 3px solid #404040;
                border-radius: 5px;
                overflow: hidden;
            }
            .cardFront div {
                transition: .5s;
            }
            .in-play .cardFront .card-number,
            .activeCard .cardFront .card-number {
                top: 20px;
                left: 20px;
                transform: scale(2);
            }
            .in-play .cardFront .card-discipline,
            .activeCard .cardFront .card-discipline {
                top: 15px;
                right: 20px;
                transform: scale(2);
            }
            .in-play .cardFront .card-resource-currency,
            .activeCard .cardFront .card-resource-currency {
                right: 5px;
                top: 35px;
                width: 15px;
            }
            .in-play .cardFront .card-resource-currency .fas,
            .activeCard .cardFront .card-resource-currency .fas {
                font-size: 10px;
                line-height: 15px;
            }
            .in-play .cardFront,
            .activeCard .cardFront {
                border-width: 10px;
                border-radius: 10px;
            }
            .in-play .cardFront .card-elemental-motif, 
            .in-play .cardFront .card-force,
            .in-play .cardFront .card-ranking,
            .in-play .cardFront .card-type,
            .in-play .cardFront .card-force-indicator,
            .activeCard .cardFront .card-elemental-motif, 
            .activeCard .cardFront .card-force, 
            .activeCard .cardFront .card-ranking,
            .activeCard .cardFront .card-type,
            .activeCard .cardFront .card-force-indicator {
                transform: scale(2.3);
            }
            .in-play .cardFront .card-type, 
            .activeCard .cardFront .card-type {
                bottom: 20px;
                font-size: 10px;
            }
            .in-play .cardFront .card-ranking,
            .activeCard .cardFront .card-ranking {
                bottom: 90px;
            }
            .activeCaster .card-levelling-cost, 
            .activeCard .card-levelling-cost {
			    bottom: 50px;
			    transform: scale(1.8);
			}
            .card-number {
                position: absolute;
                display: block;
                top: 3px;
                left: 3px;
                width: 25px;
                height: 25px;
                font-size: 15px;
                margin: auto;
                border-radius: 100%;
                border-top-left-radius: 0;
                background: #404040;
                text-align: center;
                line-height: 25px;
                color: #b3b3b3;
            }
            .card-discipline {
                position: absolute;
                right: 3px;
                top: 3px;
                color: #b3b3b3;
                font-size: 10px;
                text-transform: uppercase;
            }
            .card-support-duration {
			    position: absolute;
			    right: 5px;
			    top: 18px;
			}
			.card-discipline:empty + .card-support-duration {
			    top: 5px;
			}
			.cardFront .card-support-duration .fas {
			    color: #404040;
			}
            .card-resource-currency {
                position: absolute;
                right: 3px;
                top: 17px;
                width: 8px;
            }
            .card-resource-currency .fas {
                font-size: 5px;
                display: block;
                line-height: 8px;
            }
            .card-logo {
                position: absolute;
                bottom: 10px;
                left: 0;
                right: 0;
                text-align: center;
                margin: auto;
                display: block;
                height: 20px;
                line-height: 20px;
                font-size: 8px;
                letter-spacing: 2px;
                text-transform: uppercase;
                color: #b3b3b3;
                background: #404040;
            }
            .card-motivs {
                color: #404040;
                position: absolute;
                top: 10px;
                left: 0;
                right: 0;
                width: 58px;
                height: 58px;
                border-radius: 100%;
                border: 1px solid #404040;
                margin: auto;
            }
            .card-motivs .fas {
                position: absolute;
                margin: auto;
                display: block;
                height: 20px;
                text-align: center;
                font-size: 17px;
                color: #404040;
            }
            .card-motivs .fas:nth-child(1) {
                top: -7px;
                bottom: auto;
                left: 0;
                right: 0;
            }
            .card-motivs .fas:nth-child(2) {
                top: 0;
                bottom: 0;
                left: auto;
                right: -5px;
            }
            .card-motivs .fas:nth-child(3) {
                top: auto;
                bottom: -7px;
                left: 0;
                right: 0;
            }
            .card-motivs .fas:nth-child(4) {
                top: 0;
                bottom: 0;
                left: -5px;
                right: auto;
            }
            .activeCard .card-logo {
                height: 35px;
                line-height: 35px;
                font-size: 1em;
                letter-spacing: 3px;
            }
            .activeCard .card-motivs {
                width: 120px;
                height: 120px;
            }
            .activeCard .card-motivs .fas {
                font-size: 25px;
            }
            .activeCard .card-motivs .fas:nth-child(1) {
                width: 25px;
                top: -10px;
            }
            .activeCard .card-motivs .fas:nth-child(3) {
                width: 25px;
                bottom: -10px;
            }
            .activeCard .card-motivs .fas:nth-child(2) {
                height: 25px;
                right: -10px;
            }
            .activeCard .card-motivs .fas:nth-child(4) {
                height: 25px;
                left: -10px;
            }
            .elite-ranking {
                border-color: gold;
                border-bottom-color: rgba(255, 215, 0, 0.7);
                border-right-color: rgba(255, 215, 0, 0.7);
            }
            .adept-ranking {
                border-color: silver;
                border-bottom-color: rgba(192, 192, 192, 0.7);
                border-right-color: rgba(192, 192, 192, 0.7);
            }
            .proficient-ranking {
                border-color: #cd7f32;
                border-bottom-color: rgba(205, 127, 50, 0.7);
                border-right-color: rgba(205, 127, 50, 0.7);
            }
            .peerless-ranking {
                background: #2b2b2b;
                border-color: #1d1d1d;
            }
            .peerless-ranking .card-number {
                background: #1d1d1d;
                color: white;
                border: 1px solid #b3b3b3;
            }
            .peerless-ranking .card-discipline {
                color: white;
            }
            .peerless-ranking .card-force,
            .peerless-ranking .card-support {
                background: #2b2b2b;
                color: white;
                border: 3px solid #131313;
            }
            .peerless-ranking .card-type {
                color: #b3b3b3;
            }
            .peerless-ranking .card-support-duration .fas {
			    color: #b3b3b3;
			}
            .card-ranking {
                position: absolute;
                text-align: center;
                bottom: 50px;
                left: 0;
                right: 0;
                font-size: 10px;
                letter-spacing: 2px;
            }
            .peerless-ranking .card-ranking .far {
                color: white;
            }
            .elite-ranking .card-ranking .fas {
                color: gold;
            }
            .adept-ranking .card-ranking .fas {
                color: silver;
            }
            .proficient-ranking .card-ranking .fas {
                color: #cd7f32;
            }
            .card-resource-cost,
            .card-levelling-cost {
                position: absolute;
                text-align: center;
                bottom: 30px;
                left: 0;
                right: 0;
                font-size: 10px;
                letter-spacing: 2px;
            }
            .card-resource-cost .fas,
            .card-resource-cost .far,
            .card-levelling-cost .fas,
            .card-levelling-cost .far {
                color: #404040;
            }
            .resource-cost,
            .levelling-cost {
                letter-spacing: 0px;
            }
            .card-elemental-motif {
                position: absolute;
                left: 0;
                right: 0;
                font-size: 30px;
                text-align: center;
                top: 0;
                bottom: 0;
                height: 155px;
                margin: auto;
            }
            .aero-motiv .fas {
                color: #f1c40f;
            }
            .terra-motiv .fas {
                color: #27ae60;
            }
            .pyro-motiv .fas {
                color: #c0392b;
            }
            .hydro-motiv .fas {
                color: #3498db;
            }
            .scaleSmall .cardFront div {
                transform: scale(.7);
            }
            .scaleSmall .card-support, 
            .scaleSmall .card-force {
                width: 63px;
                height: 63px;
                font-size: 25px;
                line-height: 63px;
                bottom: 10px;    
                left: -3px;
            }
            .scaleSmall .card-force-indicator, 
            .scaleSmall .card-force-indicator svg {
                width: 70px;
                height: 70px;
                position: absolute;
                overflow: hidden;
                margin: auto;
            }
            .scaleSmall .card-force-indicator {
                top: 0;
                left: -5px;
                right: 0;
                bottom: 10px;
            }
            .scaleSmall .card-force-indicator svg {
                bottom: 0;
                top: 0;
                left: 0;
                right: 0;
            }
            .scaleSmall .card-elemental-motif {
                font-size: 15px;
                height: 108px;
            }
            .scaleSmall .card-type {
                bottom: 2px;
            }
            .scaleSmall .card-ranking {
                bottom: 25px;
            }
            .scaleSmall .card-number {
                left: 0;
                top: 0;
                font-size: 10px;
                width: 20px;
                height: 20px;
                line-height: 20px;
            }
            .scaleSmall .card-discipline {
                right: 0;
                top: 0;
            }
            .scaleSmall .card-resource-currency {
                top: 7px;
                right: 2px;
            }
            .scaleSmall .card-resource-currency .fas {
                font-size: 3px;
                line-height: 5px;
            }
            .scaleSmall .card-resource-cost,
            .scaleSmall .card-levelling-cost {
                bottom: 15px;
            }
            .scaleSmall .support-type {
                font-size: 12px;
            }
            .scaleSmall .card-support-motiv .fas:nth-child(2) {
                right: 5px;
            }
			.scaleSmall .support-levelling-effect .fas {
			    font-size: 30px;
			}
			.scaleSmall .support-levelling-effect .fas:nth-child(1) {
			    left: -15px;
			}
            .scaleSmall .support-levelling-effect .fas:nth-child(2) {
			    right: -15px;
			}
            .card-marker {
                color: white;
                position: absolute;
                text-transform: uppercase;
                top: 3px;
                left: 3px;
                padding: 0;
                background: #404040;
                text-align: right;
                border-radius: 10px;
                border-top-left-radius: 0;
                border-bottom-right-radius: 0;
                overflow: hidden;
                z-index: 1;
                height: 25px;
                width: 0;
            }
            .emphasize-selection .card {
                transform: scale(1.05);
            }
            .emphasize-promotion .cardFront:after {
				animation: shine 5s ease-in-out infinite;
				animation-fill-mode: forwards;  
				content: "";
				position: absolute;
				top: -150%;
				left: -200%;
				width: 340%;
				height: 180%;
				opacity: 0;
				transform: rotate(50deg);
				background: rgba(255, 255, 255, 0.13);
				background: linear-gradient(
					to right, 
					rgba(255, 255, 255, 0.13) 0%,
					rgba(255, 255, 255, 0.13) 77%,
					rgba(255, 255, 255, 0.5) 92%,
					rgba(255, 255, 255, 0.0) 100%
				);
			}
            .valid-for-selection .card-marker {
                width: 95px;
                padding: 5px 10px;
                transition: .3s;
            }
            .valid-for-selection .card-marker * {
                float: left;
            }
            .activeResource {
                transform: rotate(90deg) translateY(-7px) translateX(-8px) scaleX(1);
            }
            .activeResource .cardFront {
                border-width: 3px;
            }
            .activeResource .cardFront .card-force {
                transform: scale(.3);
                left: -28px;
            }
            .activeResource .cardFront .card-force-indicator {
                transform: scale(.3);
                left: -34px;
            }
            .activeResource .cardFront div.card-number,
            .activeResource .cardFront div.card-ranking, 
            .activeResource .cardFront div.card-levelling-cost,
            .activeResource .cardFront div.card-type,
            .activeResource .cardFront div.card-discipline,
            .activeResource .cardFront div.card-resource-currency,
            .activeResource .cardFront div.card-force-indicator div {
                display: none;
            }
            .inactiveResource .cardFront div.card-number,
            .inactiveResource .cardFront div.card-ranking,
            .inactiveResource .cardFront div.card-type,
            .inactiveResource .cardFront div.card-discipline,
            .inactiveResource .cardFront div.card-resource-currency,
            .inactiveResource .cardFront div.card-force-indicator div {
                display: none;
            }
            .activeResource .cardFront .card-elemental-motif {
                transform: scale(.3);
                height: 170px;
            }
            /* || UI */
            .btn {
                background: #404040;
                display: inline-block;
                min-width: 100px;
                text-align: center;
                padding: 5px 15px;
                transition: .5s;
                cursor: pointer;
            }
            .btn:hover {
                background: #353535;
            }
            .overview-component {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 99;
                background: #404040;
                color: #b3b3b3;
                padding: 5px 10px;
                font-size: 15px;
                display: flex;
                justify-content: space-between;
            }
            .overview-component > div {
                display: inline-block;
            }
            .overview-component > div:first-child, 
            .overview-component > div:last-child {
                min-width: 250px;
            }
            .overview-component > div:first-child {
                text-align: left;
            }
            .overview-component > div:last-child {
                text-align: right;
            }
            .overview-win-indicator > div {
                display: inline-block;
                position: relative;
            }
            .overview-win-indicator > div:first-child {
                padding-right: 10px;
            }
            .overview-win-indicator > div:last-child {
                padding-left: 10px;
            }
            .overview-phase-indicator {
                position: relative;
            }
            .overview-current-phase {
                text-transform: capitalize;
                transition: .5s;
                position: absolute;
            }
            .overview-display-phase {
                right: 0;
            }
            .overview-former-phase, 
            .overview-conceal-phase {
                right: -1000px;
            }
            .overview-player-win:before {
                content: "Player";
            }
            .npc-player-win:before {
                content: "NPC";
            }
            .overview-win-indicator > div:before {
                font-size: 10px;
                position: absolute;
                line-height: 18px;
                text-transform: uppercase;
            }
            .overview-win-indicator > div:last-child:before {
                left: 100%;
                margin-left: 10px;
            }
            .overview-win-indicator > div:first-child:before {
                right: 100%;
                margin-right: 10px;
            }
            .overview-win-indicator > div:first-child:after {
                content: "";
                width: 1px;
                top: 0;
                bottom: 0;
                right: -3px;
                background: #504f4f;
                position: absolute;
            }
            .phaseGuide {
                position: fixed;
                bottom: 20px;
                background: rgba(64, 64, 64, 0.9);
                border: 2px solid #404040;
                z-index: 9;
                padding: 10px;
                border-top-right-radius: 15px;
                border-bottom-left-radius: 15px;
                color: #b3b3b3;
                transition: .2s;
                overflow: hidden;
            }
            .inactive-phaseGuide {
                left: -500px;
            }
            .active-phaseGuide {
                left: 20px;
            }
            .phaseGuide-current-phase {
                font-size: 30px;
                text-transform: capitalize;
                margin-bottom: 15px;
            }
            .turnCard-component {
                position: fixed;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                background: #504f4f;
                z-index: 9;
                padding: 15px;
            }
            .turnCard {
                width: 80px;
                height: 120px;
                border-radius: 5px;
                display: inline-block;
                margin: auto 5px;
                text-align: center;
                transition: .5s;
                cursor: pointer;
            }
            .turnCard .card {
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
            }
            .turnCard-hidden {
                position: absolute;
            }
            .turnCard-drawn {
                position: relative;
            }
            .turnCard-selection .turnCard-hidden {
                left: -1000px;
            }
            .turnCard-selection .turnCard-drawn {
                left: 0;
            }
            .turnCard-match .turnCard-hidden {
                top: -1000px;
            }
            .turnCard-match .turnCard-drawn {
                top: 0;
            }
            .turnCard-selection {
                text-align: center;
                display: flex;
                justify-content: center;
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                margin: auto;
            }
            .turnCard .cardFront .fas {
                position: absolute;
                top: 0;
                bottom: 0;
                right: 0;
                left: 0;
                font-size: 25px;
                height: 25px;
                margin: auto;
            }
            .turnCard[data-element="aero"] .cardFront .fas {
                color: #f1c40f;
            }
            .turnCard[data-element="hydro"] .cardFront .fas {
                color: #3498db;
            }
            .turnCard[data-element="terra"] .cardFront .fas {
                color: #27ae60;
            }
            .turnCard[data-element="pyro"] .cardFront .fas {
                color: #c0392b;
            }
            .turnCard.focus .card, 
            .turnCard .card:hover {
                background: #545454;
            }
            .turnCard-bg-lines div {
                height: 3px;
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                top: 0;
                background: #404040;
                margin: auto;
                max-width: 245px;
            }
            .turnCard-bg-lines div:before,
            .turnCard-bg-lines div:after {
                content: "";
                background: #404040;
                height: 3px;
                width: 150px;
                display: block;
                position: absolute;
                transform: rotate(50deg);
            }
            .turnCard-bg-lines div:before {
                left: 89%;
                top: 57px;
            }
            .turnCard-bg-lines div:after {
                right: 89%;
                bottom: 57px;
            }
            .turnCard-bg-lines div div:before, 
            .turnCard-bg-lines div div:after {
                content: "";
                background: #404040;
                height: 3px;
                width: 1000px;
                display: block;
                position: absolute;
                transform: rotate(0deg);
            }
            .turnCard-bg-lines div div:before {
                bottom: 114px;
                right: 139%;
                left: auto;
                top: auto;
            }
            .turnCard-bg-lines div div:after {
                top: 114px;
                left: 139%;
                right: auto;
                bottom: auto;
            }
            .turnCard-bg-lines {
                position: absolute;
                height: 232px;
                margin: auto;
                display: block;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
            }
            .turnCard-match {
                text-align: center;
                position: absolute;
                left: 0;
                right: 0;
                margin: auto;
                bottom: 0;
                top: 0;
                display: block;
                height: 450px;
            }
            .turnCard-match .turnCard {
                position: relative;
            }
            .turn {
                color: red;
            }
            .turn.active {
                color: green;
            }
            .deck-component {
                display: flex;
                vertical-align: top;
                justify-content: center;
                text-align: center;
            }
            .field[data-field="player-field"] .deck-component {
                flex-direction: row-reverse;
            }
            .field[data-field="ai-field"] .deck-component {
                flex-direction: row;
            }
            .dorment {
                display: inline-block;
                display: flex;
                flex-direction: column;
                position: relative;
            }
            .field[data-field="player-field"] .dorment {
                margin-right: 5px;
                justify-content: flex-start;
                align-items: flex-end;
            }
            .field[data-field="ai-field"] .dorment {
                margin-left: 5px;
                justify-content: flex-end;
                align-items: flex-start;
                margin-bottom: 5px;
            }
            .stack-counter {
                border: 1px solid #404040;
                border-radius: 5px;
                color: #b3b3b3;
                font-size: 20px;
                width: 40px;
                height: 55px;
                line-height: 50px;
                position: relative;
            }
            .stack-count-low {
                color: #c0392b;
            }
            .stack-counter span {
                background: #404040;
                border-radius: 100%;
                width: 30px;
                height: 30px;
                display: inline-block;
                line-height: 30px;
                vertical-align: middle;
                font-size: 15px;
            }
            .field[data-field="player-field"] .stack-counter span {
                border-top-left-radius: 0;
            }
            .field[data-field="ai-field"] .stack-counter span {
                border-bottom-right-radius: 0;
            }
            .stack-circuit {
                position: absolute;
                width: 35px;
                height: 35px;
            }
            .field[data-field="player-field"] .stack-circuit {
                right: 100%;
                top: -5px;
                border-left: 1px solid #404040;
                border-bottom: 1px solid #404040;
            }
            .field[data-field="ai-field"] .stack-circuit {
                left: 100%;
                bottom: -5px;
                border-right: 1px solid #404040;
                border-top: 1px solid #404040;
            }
            .stack-circuit:before,
            .stack-circuit:after {
                content: "";
                position: absolute;
            }
            .field[data-field="player-field"] .stack-circuit:before {
                left: -1px;
                bottom: -1px;
                border-left: 25px solid #404040;
                border-top: 25px solid transparent;
            }
            .field[data-field="ai-field"] .stack-circuit:before {
                right: -1px;
                top: -1px;
                border-right: 25px solid #404040;
                border-bottom: 25px solid transparent;
            }
            .field[data-field="player-field"] .stack-circuit:after {
                left: -1px;
                bottom: -1px;
                border-left: 23px solid #504f4f;
                border-top: 23px solid transparent;
            }
            .field[data-field="ai-field"] .stack-circuit:after {
                right: -1px;
                top: -1px;
                border-right: 23px solid #504f4f;
                border-bottom: 23px solid transparent;
            }
            .player-hand {
                display: inline-block;
            }
            .dorment > div:not(:last-child) {
                margin-bottom: 5px;
            }
            .field[data-field="ai-field"] .victory-indicator {
                margin-right: 20px;
            }
            .field[data-field="player-field"] .victory-indicator {
                margin-left: 20px;
            }
            .victory-indicator {
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            .victory-aperture {
                border-radius: 5px;
                border: 1px solid #404040;
                height: 75px;
                width: 55px;
                margin-bottom: 5px;
                position: relative;
                transition: .5s;
            }
            .victory-aperture:after {
                content: "";
                position: absolute;
                width: 20px;
                height: 1px;
                background: #404040;
                top: 0;
                bottom: 0;
                margin: auto;
            }
            .field[data-field="ai-field"] .victory-aperture:after {
                left: 100%;
            }
            .field[data-field="player-field"] .victory-aperture:after {
                right: 100%;
            }
            .victory-aperture.victorious {
                background: #0a800f;
                box-shadow: inset 0px 0px 0px 5px rgba(34, 101, 0, 0.7);
            }
            .turn-indicator {
                height: 35px;
                width: 35px;
                border-radius: 100%;
                position: absolute;
                background: transparent;
                box-shadow: inset 0px 0px 0px 0px transparent;
                transition: .5s;
                border: 1px solid #404040;
                z-index: 1;
            }
            .activeTurn {
                background: #0a800f;
                box-shadow: inset 0px 0px 0px 5px rgba(34, 101, 0, 0.7);
            }
            [data-field="player-field"] .turn-indicator {
                left: 0;
                bottom: 0;
                border-top-right-radius: 0;
            }
            [data-field="ai-field"] .turn-indicator {
                right: 0;
                top: 0;
                border-bottom-left-radius: 0;
            }
            .turn-indicator:after {
                content: "Turn";
                position: absolute;
                transition: .5s;
                opacity: 0;
                color: #b3b3b3;
                text-transform: uppercase;
                font-size: 12px;
            }
            .turn-indicator.activeTurn:after {
                opacity: 1;
            }
            [data-field="player-field"] .turn-indicator:after {
                left: 110%;
            }
            [data-field="ai-field"] .turn-indicator:after {
                right: 110%;
            }
            .field-component {
                position: relative;
                z-index: 1;
                background: #504f4f;
                padding-top: 30px;
            }
            .field {
                padding: 15px;
            }
            .preview-pane-component {
                position: fixed;
                z-index: 9;
                left: 0;
                right: 0;
                margin: auto;
                text-align: center;
                max-width: 550px;
                display: flex;
                justify-content: center;
                transition: .5s;
            }
            .field[data-field="player-field"] .preview-pane-component {
                top: -1000px;
            }
            .field[data-field="player-field"] .inView.preview-pane-component {
                top: 50px;
            }
            .field[data-field="ai-field"] .preview-pane-component {
                bottom: -1000px;
            }
            .field[data-field="ai-field"] .inView.preview-pane-component {
                bottom: 50px;
            }
            .preview-pane-dismiss {
                cursor: pointer;
                color: #404040;
                position: absolute;
                right: 100%;
                width: 25px;
                height: 25px;
                line-height: 25px;
                transition: .5s;
            }
            .preview-pane-dismiss:hover {
                color: #b3b3b3;
            }
            .preview-pane-aperture {
                width: 250px;
                height: 400px;
                background: rgba(80, 79, 79, 0.8);
                border: 1px solid #404040;
                margin: 0;
                position: relative;
                display: inline-block;
                vertical-align: top;
            }
            .preview-pane-aperture:last-child {
                border-top-right-radius: 10px;
                border-bottom-right-radius: 10px;
                border-left: 0;
            }
            .preview-pane-aperture:first-child {
                border-top-left-radius: 10px;
                border-bottom-left-radius: 10px;
                border-right: 0;
            }
            .preview-pane-card {
                height: 375px;
                width: 225px;
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                margin: auto;
            }
            .preview-pane-card .card-aperture {
                transform: scale(1.5);
                transform-origin: 2px 2px;
                left: 0;
                position: absolute;
            }
            .preview-pane-stats > div {
                padding: 5px 0;
                display: block;
                display: flex;
                justify-content: space-between;
            }
            .preview-pane-stats {
                padding: 15px 15px 15px 0;
                color: #b3b3b3;
                text-align: left;
            }
            .preview-pane-stats > div > div {
                display: inline-block;
            }
            .preview-pane-stats > div > div:last-child {
                text-align: right;
            }
            .preview-pane-stats > div:not(:last-child) {
                border-bottom: 1px solid #404040;
            }
            .preview-pane-stats .stat-title {
                text-transform: uppercase;
                font-size: 13px;
            }
            .preview-pane-stats .stat-description {
                display: block;
            }
            .preview-pane-stats .stat-description > div:last-child {
                text-align: left;
            }
            .preview-pane-stats .stat-description .stat-title {
                margin-bottom: 10px;
            }
            .preview-pane-stats .stat-value .fa-asterisk {
                font-size: 8px;
                vertical-align: top;
            }
            .preview-pane-stats .stat-resource-currency .fas {
                width: 17px;
                text-align: right;
            }
            .preview-pane-stats .stat-resource-cost .fa-circle,
            .preview-pane-stats .stat-resource-currency .fa-circle {
                font-size: 12px;
            }
            .preview-pane-stats.stat-discipline-aero .stat-resource-cost .fas,
            .preview-pane-stats.stat-discipline-aero .stat-resource-currency .fas {
                color: #f1c40f;
            }
            .preview-pane-stats.stat-discipline-terra .stat-resource-cost .fas,
            .preview-pane-stats.stat-discipline-terra .stat-resource-currency .fas {
                color: #27ae60;
            }
            .preview-pane-stats.stat-discipline-pyro .stat-resource-cost .fas,
            .preview-pane-stats.stat-discipline-pyro .stat-resource-currency .fas {
                color: #c0392b;
            }
            .preview-pane-stats.stat-discipline-hydro .stat-resource-cost .fas,
            .preview-pane-stats.stat-discipline-hydro .stat-resource-currency .fas {
                color: #3498db;
            }
            .preview-pane-stats.stat-discipline-aero .stat-discipline .fas {
                color: #f1c40f;
            }
            .preview-pane-stats.stat-discipline-terra .stat-discipline .fas {
                color: #27ae60;
            }
            .preview-pane-stats.stat-discipline-pyro .stat-discipline .fas {
                color: #c0392b;
            }
            .preview-pane-stats.stat-discipline-hydro .stat-discipline .fas {
                color: #3498db;
            }
            .battle-field-component {
                padding: 5px 15px;
                text-align: center;
                display: flex;
                justify-content: center;
                position: relative;
            }
            .battle-field {
                display: inline-block;
                display: flex;
                margin: auto 10px;
                position: relative;
            }
            .battle-field-background {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                justify-content: space-around;
            }
            .background-panel {
                position: absolute;
                top: -7px;
                bottom: -7px;
                width: 50%;
                flex-basis: 50%;
                color: #404040;
            }
            .background-panel-left {
                left: 0;
                border-bottom: 3px solid;
            }
            .background-panel-right {
                right: 0;
                border-top: 3px solid;
            }
            .background-panel-left .panel-corner:first-child {
                border-left: 80px solid #404040;
                border-top: 50px solid transparent;
                bottom: 0;
                left: 0;
            }
            .background-panel .panel-corner {
                position: absolute;
            }
            .background-panel-left .panel-corner:first-child:before {
                border-left: 80px solid #504f4f;
                border-top: 50px solid transparent;
                bottom: -3px;
                left: -82px;
            }
            .background-panel .panel-corner:before {
                content: "";
                position: absolute;
            }
            .background-panel-left .panel-corner:last-child {
                border-right: 50px solid #404040;
                border-top: 50px solid transparent;
                bottom: 0;
                right: 0;
            }
            .background-panel-left .panel-corner:last-child:before {
                border-right: 50px solid #504f4f;
                border-top: 50px solid transparent;
                bottom: -3px;
                right: -52px;
            }
            .background-panel-right .panel-corner:last-child:before {
                border-left: 50px solid #504f4f;
                border-bottom: 50px solid transparent;
                top: -3px;
                left: -52px;
            }
            .background-panel-right .panel-corner:last-child {
                border-left: 50px solid #404040;
                border-bottom: 50px solid transparent;
                top: 0;
                left: 0;
            }
            .background-panel-right .panel-corner:first-child:before {
                border-right: 80px solid #504f4f;
                border-bottom: 50px solid transparent;
                top: -3px;
                right: -82px;
            }
            .background-panel-right .panel-corner:first-child {
                border-right: 80px solid #404040;
                border-bottom: 50px solid transparent;
                top: 0;
                right: 0;
            }
            .background-panel-left:after {
                content: "";
                position: absolute;
                top: 45px;
                bottom: 48px;
                right: -2px;
                width: 3px;
                background: #404040;
            }
            .background-panel-right:before {
                content: "";
                position: absolute;
                top: 45px;
                bottom: 48px;
                left: -2px;
                width: 3px;
                background: #404040;
            }
            .dead-pile, 
            .dead-pile .card,
            .standby-pile, 
            .standby-pile .card {
                height: 120px;
                width: 80px;
                border-radius: 5px;
            }
            .standby-pile,
            .dead-pile {
                border: 1px solid #404040;
                background: #504f4f;
                width: 120px;
                height: 80px;
                z-index: 2;
                position: relative;
            }
            .standby-pile:before,
            .dead-pile:before {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                color: #404040;
                text-transform: uppercase;
                margin: auto;
                height: 12px;
                font-size: 12px;
            }
            .dead-pile:before {
                content: "Dead Pile";
            }
            .standby-pile:before {
                content: "Standby Pile";
            }
            .standby-pile .idleCard {
                position: relative;
            }
            .card-aperture.focus,
            .turnCard.focus,
            .btn.focus {
                box-shadow: 0px 0px 5px 2px grey;
            }
            .turnCard.focus {
			    transform: translateY(-10px);
			}
			.field[data-field="ai-field"] .card-aperture.closed.focus {
			    transform: translateY(5px);
			}
			.field[data-field="player-field"] .card-aperture.closed.focus {
			    transform: translateY(-5px);
			}
            .card-aperture {
                width: 150px;
                height: 250px;
                border: 1px solid #404040;
                display: inline-block;
                background: #504f4f;
                border-radius: 8px;
                position: relative;
                z-index: 2;
                transition: .5s;
            }
            .card-aperture:before {
                content: "Card";
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                color: #404040;
                text-transform: uppercase;
                margin: auto;
                height: 20px;
                font-size: 20px;
            }
            .card-aperture .cardFront,
            .card-aperture .cardBack,
            .card-aperture .card {
                border-radius: 8px;
            }
            .card-aperture.closed .card {
                cursor: pointer;
            }
            .card-aperture.closed.focus .card,
            .card-aperture.closed .card:hover {
                background: #545454;
            }
            .in-play {
                width: 300px;
                height: 500px;
                border: 1px solid #404040;
                display: inline-block;
                background: #504f4f;
                border-radius: 10px;
                z-index: 1;
                transition: .5s;
            }
            .in-play:before {
                content: "Caster";
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                color: #404040;
                text-transform: uppercase;
                margin: auto;
                height: 30px;
                font-size: 30px;
            }
            .support-card-component {
                width: 150px;
                height: 250px;
                border: 3px solid #404040;
                display: inline-block;
                background: #504f4f;
                border-radius: 10px;
                z-index: 0;
                transition: .5s;
                position: absolute;
            }
            .support-card-component:after {
                content: "Support";
                text-transform: uppercase;
                color: #404040;
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                margin: auto;
                height: 20px;
                font-size: 20px;
                letter-spacing: 2px;
            }
            .battle-field[data-battle-field="player-field"] .support-card-component {
                bottom: 25px;
                left: 0;
            }
            .battle-field[data-battle-field="player-field"] .support-card-component.activeSupport {
                left: -155px;
            }
            .battle-field[data-battle-field="ai-field"] .support-card-component {
                top: 25px;
                right: 0;
            }
            .battle-field[data-battle-field="ai-field"] .support-card-component.activeSupport {
                right: -155px;
            }
            .support-card-circuit {
                position: absolute;
                width: 55px;
                height: 20px;
            }
            .battle-field[data-battle-field="player-field"] .support-card-circuit {
                right: -20px;
                bottom: -20px;
                border-left: 1px solid #404040;
                border-bottom: 1px solid #404040;
            }
            .battle-field[data-battle-field="ai-field"] .support-card-circuit {
                left: -20px;
                top: -20px;
                border-right: 1px solid #404040;
                border-top: 1px solid #404040;
            }
            .support-card-circuit:before,
            .support-card-circuit:after {
                content: "";
                position: absolute;
            }
            .battle-field[data-battle-field="player-field"] .support-card-circuit:before {
                left: -1px;
                bottom: -1px;
                border-left: 20px solid #404040;
                border-top: 20px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .support-card-circuit:before {
                right: -1px;
                top: -1px;
                border-right: 20px solid #404040;
                border-bottom: 20px solid transparent;
            }
            .battle-field[data-battle-field="player-field"] .support-card-circuit:after {
                left: -1px;
                bottom: -1px;
                border-left: 18px solid #504f4f;
                border-top: 18px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .support-card-circuit:after {
                right: -1px;
                top: -1px;
                border-right: 18px solid #504f4f;
                border-bottom: 18px solid transparent;
            }
            .hitpoint-indicator {
                border-radius: 8px;
                border: 1px solid #404040;
                position: absolute;
                height: 150px;
                width: 100px;
                padding: 5px;
                display: flex;
                flex-direction: column;
                justify-content: space-around;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-indicator {
                left: -120px;
                top: 50px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-indicator {
                right: -120px;
                bottom: 50px;
            }
            .hitpoint-circuit {
                position: absolute;
                width: 57px;
                height: 37px;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-circuit {
                right: -43px;
                top: -37px;
                border-left: 1px solid #404040;
                border-top: 1px solid #404040;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-circuit {
                left: -43px;
                bottom: -37px;
                border-right: 1px solid #404040;
                border-bottom: 1px solid #404040;
            }
            .hitpoint-circuit:before {
                content: "";
                position: absolute;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-circuit:before {
                left: -1px;
                top: -1px;
                border-left: 25px solid #404040;
                border-bottom: 25px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-circuit:before {
                right: -1px;
                bottom: -1px;
                border-right: 25px solid #404040;
                border-top: 25px solid transparent;
            }
            .hitpoint-circuit:after {
                content: "";
                position: absolute;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-circuit:after {
                left: -1px;
                top: -1px;
                border-left: 23px solid #504f4f;
                border-bottom: 23px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-circuit:after {
                right: -1px;
                bottom: -1px;
                border-right: 23px solid #504f4f;
                border-top: 23px solid transparent;
            }
            .hitpoint-indicator:before, 
            .hitpoint-indicator:after {
                content: "";
                position: absolute;
                z-index: 2;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-indicator:before {
                left: 0;
                bottom: 0;
                border-left: 30px solid #404040;
                border-top: 35px solid transparent;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-indicator:after {
                left: -1px;
                bottom: -1px;
                border-left: 30px solid #504f4f;
                border-top: 35px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-indicator:before {
                right: 0;
                top: 0;
                border-right: 30px solid #404040;
                border-bottom: 35px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-indicator:after {
                right: -1px;
                top: -1px;
                border-right: 30px solid #504f4f;
                border-bottom: 35px solid transparent;
            }
            .hitpoint-meter {
                display: block;
                border: 1px solid #404040;
                height: 42px;
                margin-bottom: 5px;
                position: relative;
            }
            .hitpoint-meter:nth-child(2) {
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
            }
            .hitpoint-meter:last-child {
                border-bottom-left-radius: 8px;
                border-bottom-right-radius: 8px;
                margin-bottom: 0;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child:before, 
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child:after {
                content: "";
                position: absolute;
                z-index: 1;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2):before, 
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2):after {
                content: "";
                position: absolute;
                z-index: 1;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child:before {
                left: 0;
                bottom: 0;
                border-left: 28px solid #404040;
                border-top: 32px solid transparent;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child:after {
                left: -1px;
                bottom: -1px;
                border-left: 28px solid #504f4f;
                border-top: 32px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2):before {
                right: 0;
                top: 0;
                border-right: 28px solid #404040;
                border-bottom: 32px solid transparent;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2):after {
                right: -1px;
                top: -1px;
                border-right: 28px solid #504f4f;
                border-bottom: 32px solid transparent;
            }
            .hitpoint-meter div {
                display: block;
                height: 33%;
                transition: .5s;
                position: relative;
                background: transparent;
            }
            .hitpoint-meter:nth-child(2) div:first-child {
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
            }
            .hitpoint-meter:last-child div:last-child {
                border-bottom-left-radius: 8px;
                border-bottom-right-radius: 8px;
            }
            .hitpoint-meter.safe div.activeIndicator {
                background: #0a800f;
                box-shadow: inset 0px 0px 0px 2px #1b6d04;
            }
            .hitpoint-meter.caution div.activeIndicator {
                background: #ff6a00;
                box-shadow: inset 0px 0px 0px 2px #b14c05;
            }
            .hitpoint-meter.risk div.activeIndicator {
                background: #c0392b;
                box-shadow: inset 0px 0px 0px 2px #a21102;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child div:before {
                content: "";
                position: absolute;
                transform: rotate(-42deg);
                width: 3px;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child div.activeIndicator:before {
                background: #a21102;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child div:nth-child(1):before {
                height: 7px;
                left: 2px;
                bottom: 0px;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child div:nth-child(2):before {
                height: 15px;
                left: 10px;
                bottom: 0;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-meter:last-child div:nth-child(3):before {
                height: 15px;
                left: 21px;
                bottom: 0px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2) div:before {
                content: "";
                position: absolute;
                transform: rotate(-42deg);
                width: 3px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2) div.activeIndicator:before {
                background: #1b6d04;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2) div:nth-child(1):before {
                height: 15px;
                right: 22px;
                top: 0px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2) div:nth-child(2):before {
                height: 15px;
                right: 10px;
                top: 0;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-meter:nth-child(2) div:nth-child(3):before {
                height: 7px;
                right: 2px;
                top: 0px;
            }
            .hitpoint-percentile {
                position: absolute;
                font-size: 30px;
                color: #b3b3b3;
                transition: .2s;
                opacity: 0;
            }
            .hitpoint-percentile:after {
                content: "%";
            }
            .activePercentile {
                opacity: 1;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-percentile {
                left: -115px;
                top: -10px;
            }
            .battle-field[data-battle-field="player-field"] .hitpoint-percentile.activePercentile {
                top: 10px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-percentile {
                right: -115px;
                bottom: -10px;
            }
            .battle-field[data-battle-field="ai-field"] .hitpoint-percentile.activePercentile {
                bottom: 10px;
            }
            .resource-field-component {
                position: absolute;
                color: #404040;
            }
            .resource-field-component[data-resource-field="player-field"] {
                left: 15px;
                bottom: 50px;
            }
            .resource-field-component[data-resource-field="ai-field"] {
                right: 15px;
                top: 50px;
            }
            .resource-aperture {
                border: 1px solid #404040;
                border-radius: 5px;
                color: #b3b3b3;
                height: 40px;
                width: 55px;
                line-height: 50px;
                position: relative;
                margin: auto 10px;
            }
            .resource-field-component .resource {
                display: flex;
                align-items: center;
                margin-bottom: 10px;
                transition: .5s;
                position: relative;
            }
            .resource-field-component .resource > div {
                display: inline-block;
                vertical-align: middle;
            }
            .resource-field-component .resource .fas {
                width: 35px;
                font-size: 25px;
                text-align: center;
                vertical-align: middle;
                transition: .5s;
            }
            .resource-field-component[data-resource-field="ai-field"] .resource-counter:after {
                content: "\00d7";
            }
            .resource-field-component[data-resource-field="ai-field"] .resource {
                justify-content: flex-end;
                text-align: right;
            }
            .resource-field-component[data-resource-field="player-field"] .resource {
                justify-content: flex-start;
                text-align: left;
            }
            .resource-field-component[data-resource-field="player-field"] .resource-counter:before {
                content: "\00d7";
            }
            .resource-counter {
                font-size: 15px;
                transition: .5s;
                overflow: hidden;
                color: #b3b3b3;
                border-radius: 100%;
                background: #404040;
                height: 0;
                width: 0;
                line-height: 35px;
                text-align: center;
            }
            .resource-counter:before, 
            .resource-counter:after {
                font-weight: 600;
            }
            .activePool .resource-counter {
                height: 35px;
                width: 35px;
            }
            .resource-field-component[data-resource-field="player-field"] .resource-counter {
                border-top-left-radius: 0;
            }
            .resource-field-component[data-resource-field="ai-field"] .resource-counter {
                border-top-right-radius: 0;
            }
            .resource-pyro.activePool .fas {
                color: #c0392b;
            }
            .resource-terra.activePool .fas {
                color: #27ae60;
            }
            .resource-aero.activePool .fas {
                color: #f1c40f;
            }
            .resource-hydro.activePool .fas {
                color: #3498db;
            }
            .display-resource-value:before {
                content: "\00d7";
            }
            .display-resource-value {
                position: absolute;
                display: block;
                width: 0;
                height: 0;
                font-size: 15px;
                margin: auto;
                border-radius: 100%;
                border-bottom-left-radius: 0;
                text-align: center;
                line-height: 25px;
                transition: .5s;
                overflow: hidden;
                z-index: 9;
            }
            .resource-added-value:before {
                content: "+";
            }
            .resource-added-value {
                position: absolute;
                top: 0;
                font-size: 30px;
                color: #b3b3b3;
                transition: .2s;
                height: 0;
                width: 0;
                overflow: hidden;
                opacity: 0;
            }
            .resource-field-component[data-resource-field="ai-field"] .resource-added-value {
                right: 85%;
            }
            .resource-field-component[data-resource-field="player-field"] .resource-added-value {
                left: 85%;
            }
            .activeAddedValue {
                width: 35px;
                height: 35px;
                opacity: 1;
                top: -30px;
            }
            .activeResourceTag {
                width: 25px;
                height: 25px;
            }
            .display-resource-value.aero-tag {
                background: #f1c40f;
                color: #404040;
    			animation: aeroPulse 2s infinite;
    			-webkit-animation: aeroPulse 2s infinite;
    			-moz-animation: aeroPulse 2s infinite;
    			-o-animation: aeroPulse 2s infinite;
            }
            .display-resource-value.terra-tag {
                background: #27ae60;
                color: white;
    			animation: terraPulse 2s infinite;
    			-webkit-animation: terraPulse 2s infinite;
    			-moz-animation: terraPulse 2s infinite;
    			-o-animation: terraPulse 2s infinite;
            }
            .display-resource-value.hydro-tag {
                background: #3498db;
                color: white;
    			animation: hydroPulse 2s infinite;
    			-webkit-animation: hydroPulse 2s infinite;
    			-moz-animation: hydroPulse 2s infinite;
    			-o-animation: hydroPulse 2s infinite;
            }
            .display-resource-value.pyro-tag {
                background: #c0392b;
                color: white;
    			animation: pyroPulse 2s infinite;
    			-webkit-animation: pyroPulse 2s infinite;
    			-moz-animation: pyroPulse 2s infinite;
    			-o-animation: pyroPulse 2s infinite;
            }
            /* || Dialogue Boxes */
            .dialogueBox {
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                display: flex;
                align-items: center;
                transition: .5s;
                overflow: hidden;
                z-index: 99;
            }
            .dialogueBox.minimized-dialogueBox {
                top: calc(100% - 55px);
                bottom: 0;
                left: calc(100% - 300px);
                right: 0;
                width: 300px;
                height: 55px;
            }
            .dialogueBox-backdrop {
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(80, 79, 79, 0.5);
                cursor: pointer;
                transition: .3s;
            }
            .dialogueBox-component {
                background: #504f4f;
                border: 3px solid #404040;
                max-width: 500px;
                max-height: 250px;
                margin: auto;
                display: block;
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                border-radius: 5px;
                z-index: 1;
                color: #b3b3b3;
                overflow: hidden;
                transition: .5s;
            }
            .minimized-dialogueBox .dialogueBox-component {
                width: 100%;
                max-height: 55px;
                top: 0;
                left: 0;
            }
            .minimized-dialogueBox .dialogueBox-backgraound .card-motivs {
                bottom: -500px;
            }
            .dialogueBox-head {
                padding: 15px;
                border-bottom: 1px solid #404040;
                position: relative;
                height: 50px;
                display: block;
                z-index: 1;
            }
            .dialogueBox-dismiss {
                top: 0;
                bottom: 0;
                right: 0;
                border-left: 1px solid #404040;
            }
            .dialogueBox-minimize, 
            .dialogueBox-maximize {
                display: none;
                top: 0;
                bottom: 0;
                left: 0;
                border-right: 1px solid #404040;
            }
            .dialogueBox-control {
                position: absolute;
                color: #404040;
                width: 50px;
                line-height: 50px;
                text-align: center;
                cursor: pointer;
                transition: .5s;
            }
            .dialogueBox-control:hover {
                background: #404040;
                color: #b3b3b3;
            }
            .dialogueBox-body {
                padding: 15px;
                min-height: 150px;
                display: flex;
                align-items: center;
                justify-content: center;
                position: relative;
                z-index: 1;
            }
            .dialogueBox-component .card-motivs {
                top: 0;
                bottom: 0;
                border-color: #4a4a4a;
                width: 100px;
                height: 100px;
            }
            .dialogueBox-component .card-motivs .fas {
                color: #4a4a4a;
                font-size: 25px;
            }
            .card-motivs .fas:nth-child(1) {
                top: -10px;
            }
            .card-motivs .fas:nth-child(2) {
                right: -7px;
            }
            .card-motivs .fas:nth-child(3) {
                bottom: -10px;
            }
            .card-motivs .fas:nth-child(4) {
                left: -7px;
            }
            .inactive-dialogueBox .dialogueBox-component {
                height: 0;
                width: 0;
            }
            .active-dialogueBox .dialogueBox-component {
                width: 100%;
                height: 100%;
            }
            .active-dialogueBox .dialogueBox-backdrop {
                opacity: 1;
            }
            .inactive-dialogueBox .dialogueBox-backdrop {
                opacity: 0;
            }
            .minimized-dialogueBox .dialogueBox-backdrop {
                opacity: 0;
                top: auto;
            }
            .dialogueBox-note {
                height: 0;
                width: 0;
                transition: .2s;
                background: #404040;
                color: white;
                position: fixed;
                margin-left: 25px;
                margin-top: -35px;
                padding: 0;
                overflow: hidden;
                border-radius: 10px;
                border-bottom-left-radius: 0;
                line-height: 20px;
                font-size: 13px;
                z-index: 9;
            }
            .dialogueBox-note-active {
                height: 30px;
                width: 270px;
                padding: 5px 10px;
            }
            .dialogueBox-note .fas {
                position: absolute;
                right: 5px;
                font-size: 20px;
                line-height: 20px;
            }
            .turn-result {
                text-align: center;
                font-size: 50px;
                font-style: italic;
            }
            .turn-result sup {
                text-transform: uppercase;
                font-size: 20px;
            }
            .turn-order {
                font-size: 20px;
            }
            .confirm-hand {
                text-align: center;
                font-size: 20px;
            }
            .confirm-options {
                margin-top: 15px;
            }
            .confirm-options .btn {
                margin: 0 10px;
            }
            .confirm-options .btn:nth-child(3):last-child {
                display: block;
                max-width: 155px;
                margin: auto;
                position: relative;
                top: 20px;
            }
            .invalid-draw-notice {
                text-align: center;
                font-size: 35px;
            }
            .invalid-draw-notice-detail {
                font-size: 20px;
            }
            /* || Transitions */
            .speedX2 {
                transition: .2s;
            }
            .speedX5 {
                transition: .5s;
            }
            .speedX7 {
                transition: .7s;
            }
            /* || Animations */
            @-webkit-keyframes aeroPulse {
			  0% {
			    -webkit-box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.7);
			  }
			  70% {
		      	-webkit-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-webkit-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
			@keyframes aeroPulse {
			  0% {
			    -moz-box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.7);
			    box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.7);
			  }
			  70% {
		      	-moz-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-moz-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
            @-webkit-keyframes terraPulse {
			  0% {
			    -webkit-box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
			  }
			  70% {
		      	-webkit-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-webkit-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
			@keyframes terraPulse {
			  0% {
			    -moz-box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
			    box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.7);
			  }
			  70% {
		      	-moz-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-moz-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
            @-webkit-keyframes hydroPulse {
			  0% {
			    -webkit-box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
			  }
			  70% {
		      	-webkit-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-webkit-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
			@keyframes hydroPulse {
			  0% {
			    -moz-box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
			    box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7);
			  }
			  70% {
		      	-moz-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-moz-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
            @-webkit-keyframes pyroPulse {
			  0% {
			    -webkit-box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.7);
			  }
			  70% {
		      	-webkit-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-webkit-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
			@keyframes pyroPulse {
			  0% {
			    -moz-box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.7);
			    box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.7);
			  }
			  70% {
		      	-moz-box-shadow: 0 0 0 10px rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 10px rgba(204,169,44, 0);
			  }
			  100% {
		      	-moz-box-shadow: 0 0 0 0 rgba(204,169,44, 0);
		      	box-shadow: 0 0 0 0 rgba(204,169,44, 0);
			  }
			}
			@-webkit-keyframes shine {
			  10% {
			    opacity: 1;
			    top: -30%;
			    left: -30%;
			    transition-property: left, top, opacity;
			    transition-duration: 0.7s, 0.7s, 0.15s;
			    transition-timing-function: ease;
			  }
			  100% {
			    opacity: 0;
			    top: -30%;
			    left: -30%;
			    transition-property: left, top, opacity;
			  }
			}
			@keyframes shine {
			  10% {
			    opacity: 1;
			    top: -30%;
			    left: -30%;
			    transition-property: left, top, opacity;
			    transition-duration: 0.7s, 0.7s, 0.15s;
			    transition-timing-function: ease;
			  }
			  100% {
			    opacity: 0;
			    top: -30%;
			    left: -30%;
			    transition-property: left, top, opacity;
			  }
			}
        </style>
    </body>
</html>
